<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Dave Clark">
<meta name="dcterms.date" content="2024-08-17">

<title>MLE - Fall 2024 - Writing the Likelihood</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="site_libs/kePrint/kePrint.js"></script>
<link href="site_libs/lightable/lightable.css" rel="stylesheet">
<link href="site_libs/htmltools-fill/fill.css" rel="stylesheet">
<script src="site_libs/htmlwidgets/htmlwidgets.js"></script>
<script src="site_libs/jquery/jquery.min.js"></script>
<script src="site_libs/proj4js/proj4.js"></script>
<link href="site_libs/highcharts/css/motion.css" rel="stylesheet">
<script src="site_libs/highcharts/highcharts.js"></script>
<script src="site_libs/highcharts/highcharts-3d.js"></script>
<script src="site_libs/highcharts/highcharts-more.js"></script>
<script src="site_libs/highcharts/modules/stock.js"></script>
<script src="site_libs/highcharts/modules/map.js"></script>
<script src="site_libs/highcharts/modules/data.js"></script>
<script src="site_libs/highcharts/modules/exporting.js"></script>
<script src="site_libs/highcharts/modules/offline-exporting.js"></script>
<script src="site_libs/highcharts/modules/drilldown.js"></script>
<script src="site_libs/highcharts/modules/item-series.js"></script>
<script src="site_libs/highcharts/modules/overlapping-datalabels.js"></script>
<script src="site_libs/highcharts/modules/annotations.js"></script>
<script src="site_libs/highcharts/modules/export-data.js"></script>
<script src="site_libs/highcharts/modules/funnel.js"></script>
<script src="site_libs/highcharts/modules/heatmap.js"></script>
<script src="site_libs/highcharts/modules/treemap.js"></script>
<script src="site_libs/highcharts/modules/sankey.js"></script>
<script src="site_libs/highcharts/modules/dependency-wheel.js"></script>
<script src="site_libs/highcharts/modules/organization.js"></script>
<script src="site_libs/highcharts/modules/solid-gauge.js"></script>
<script src="site_libs/highcharts/modules/streamgraph.js"></script>
<script src="site_libs/highcharts/modules/sunburst.js"></script>
<script src="site_libs/highcharts/modules/vector.js"></script>
<script src="site_libs/highcharts/modules/wordcloud.js"></script>
<script src="site_libs/highcharts/modules/xrange.js"></script>
<script src="site_libs/highcharts/modules/tilemap.js"></script>
<script src="site_libs/highcharts/modules/venn.js"></script>
<script src="site_libs/highcharts/modules/gantt.js"></script>
<script src="site_libs/highcharts/modules/timeline.js"></script>
<script src="site_libs/highcharts/modules/parallel-coordinates.js"></script>
<script src="site_libs/highcharts/modules/bullet.js"></script>
<script src="site_libs/highcharts/modules/coloraxis.js"></script>
<script src="site_libs/highcharts/modules/dumbbell.js"></script>
<script src="site_libs/highcharts/modules/lollipop.js"></script>
<script src="site_libs/highcharts/modules/series-label.js"></script>
<script src="site_libs/highcharts/plugins/motion.js"></script>
<script src="site_libs/highcharts/custom/reset.js"></script>
<script src="site_libs/highcharts/modules/boost.js"></script>
<script src="site_libs/highchart-binding/highchart.js"></script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">MLE - Fall 2024</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./slides.html"> 
<span class="menu-text">Slides</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./mlesyllabus24.html"> 
<span class="menu-text">MLE Syllabus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./code.html"> 
<span class="menu-text">Code</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools tools-wide">
    <div class="dropdown">
      <a href="" title="" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label=""><i class="bi bi-github"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://github.com/clavedark/MLEfall24">
            repo
            </a>
          </li>
      </ul>
    </div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Writing the Likelihood</h1>
                      </div>
  </div>
    
  <div class="quarto-title-meta-author">
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-heading">Affiliation</div>
    
      <div class="quarto-title-meta-contents">
      <p class="author">Dave Clark </p>
    </div>
    <div class="quarto-title-meta-contents">
          <p class="affiliation">
              Binghamton University
            </p>
        </div>
    </div>

  <div class="quarto-title-meta">

        
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">August 17, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#goals" id="toc-goals" class="nav-link active" data-scroll-target="#goals">Goals</a>
  <ul class="collapse">
  <li><a href="#motivating-likelihood" id="toc-motivating-likelihood" class="nav-link" data-scroll-target="#motivating-likelihood">Motivating Likelihood</a></li>
  <li><a href="#binary-y-variable" id="toc-binary-y-variable" class="nav-link" data-scroll-target="#binary-y-variable">Binary <span class="math inline">\(y\)</span> variable</a></li>
  <li><a href="#maximizing-the-likelihood" id="toc-maximizing-the-likelihood" class="nav-link" data-scroll-target="#maximizing-the-likelihood">Maximizing the Likelihood</a></li>
  <li><a href="#optimization" id="toc-optimization" class="nav-link" data-scroll-target="#optimization">Optimization</a>
  <ul class="collapse">
  <li><a href="#grid-search" id="toc-grid-search" class="nav-link" data-scroll-target="#grid-search">Grid Search</a></li>
  <li><a href="#newton-raphson" id="toc-newton-raphson" class="nav-link" data-scroll-target="#newton-raphson">Newton-Raphson</a></li>
  <li><a href="#programming-newton-raphson" id="toc-programming-newton-raphson" class="nav-link" data-scroll-target="#programming-newton-raphson">Programming Newton-Raphson</a></li>
  <li><a href="#multiple-predictors" id="toc-multiple-predictors" class="nav-link" data-scroll-target="#multiple-predictors">Multiple Predictors</a></li>
  <li><a href="#logit-using-democratic-peace-data" id="toc-logit-using-democratic-peace-data" class="nav-link" data-scroll-target="#logit-using-democratic-peace-data">Logit using Democratic Peace data</a></li>
  <li><a href="#plot-gradient-over-iterations" id="toc-plot-gradient-over-iterations" class="nav-link" data-scroll-target="#plot-gradient-over-iterations">Plot Gradient over iterations</a></li>
  <li><a href="#plot-log-likelihood-over-iterations" id="toc-plot-log-likelihood-over-iterations" class="nav-link" data-scroll-target="#plot-log-likelihood-over-iterations">Plot Log-Likelihood over iterations</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<!-- rm(list=ls()) -->
<section id="goals" class="level1">
<h1>Goals</h1>
<p>The goal here is to walk through the process of writing a likelihood function based on the data we observe, then programming that likelihood function and optimizing it with respect to the data.</p>
<section id="motivating-likelihood" class="level2">
<h2 class="anchored" data-anchor-id="motivating-likelihood">Motivating Likelihood</h2>
<p>Let’s recall the motivation for turning to ML. The data we have are not suitable for OLS because our observation of the data is limited. For instance, we observe a binary variable <span class="math inline">\([0,1]\)</span> rather than the underlying continuous probability beneath it. If we could observe and measure that probability, we’d do so and perhaps use OLS to estimate a model. But since we only observe <span class="math inline">\([0,1]\)</span>, our observation is limited.</p>
<p>OLS is poorly suited to model this variable especially if one of our goals is to generate predictions of that underlying probability. That is, one of our goals might be to estimate a measure of the <span class="math inline">\(y\)</span> variable we wish we could measure directly.</p>
<p>MLE is better suited to this task - it asks us what the data generating process is that produced the observed data, and to build a model appropriate to the limited observation of that <span class="math inline">\(y\)</span> variable.</p>
<p>To do so, we need to:</p>
<ul>
<li>describe the observed distribution of <span class="math inline">\(y\)</span></li>
<li>consider what we wish we could measure - this points to the key quantities of interest we want to derive from the model.</li>
<li>describe <span class="math inline">\(y\)</span> according to a probability distribution; write that distribution</li>
<li>write a log-likelihood function appropriate to that probability distribution.</li>
<li>parameterize the log-likelihood function such that we have a link distribution to map the linear prediction, <span class="math inline">\(x\beta\)</span>, onto the probability space of <span class="math inline">\(y\)</span>.</li>
</ul>
</section>
<section id="binary-y-variable" class="level2">
<h2 class="anchored" data-anchor-id="binary-y-variable">Binary <span class="math inline">\(y\)</span> variable</h2>
<p>Let’s start with a <span class="math inline">\(y\)</span> variable as follows:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#binary y variable</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">8675309</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n <span class="sc">*</span> <span class="dv">2</span>), <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>true_beta <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="fl">0.5</span>, <span class="sc">-</span><span class="fl">0.5</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="dv">1</span>, X) <span class="sc">%*%</span> true_beta</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>prob <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>z))</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, prob)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># y &lt;- as.factor(y)</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(y)<span class="sc">%&gt;%</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>( <span class="st">"count"</span> <span class="ot">=</span> <span class="st">"Freq"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span> <span class="fu">ifelse</span>(y <span class="sc">==</span> <span class="dv">0</span>, <span class="st">"0"</span>, <span class="st">"1"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="st">"striped"</span>, <span class="at">full_width =</span> F) <span class="sc">%&gt;%</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">1</span>, <span class="at">border_right =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collapse_rows</span>(<span class="at">columns =</span> <span class="dv">1</span>, <span class="at">valign =</span> <span class="st">"top"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<table class="table table-striped table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">y</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; border-right: 1px solid;">0</td>
<td style="text-align: right;">707</td>
</tr>
<tr class="even">
<td style="text-align: left; border-right: 1px solid;">1</td>
<td style="text-align: right;">293</td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
<p>The variable, <span class="math inline">\(y\)</span>, takes on values of zero and one - it appears binomial; let’s write this in terms of the binomial distribution parameter <span class="math inline">\(\pi\)</span>, so it takes on the value of one with probability <span class="math inline">\(\pi\)</span> and zero with probability <span class="math inline">\(1-\pi\)</span>.</p>
<p><span class="math display">\[ y_i = \left\{ \begin{array}{ll}
         1, &amp; \mbox{} \pi_{i}\\
         0, &amp; \mbox{} 1-\pi_{i}
         \end{array}
     \right.\]</span></p>
<p>The likelihood of a single observation is:</p>
<p><span class="math display">\[ L(\pi_i|y) = \pi_{i}^{y_i} (1-\pi_{i})^{1-y_i} \]</span></p>
<p>This is a statement of the likelihood that any particular value of <span class="math inline">\(\pi\)</span> generated an observation. We want the likelihood any value of <span class="math inline">\(\pi\)</span> generated the entire dataset - this is the joint likelihood of all the observations.</p>
<p><span class="math display">\[ L(\pi|y) = \prod_{i=1}^{n} \pi_{i}^{y_i} (1-\pi_{i})^{1-y_i} \]</span> recalling that a joint probability is the product of individual probabilities.</p>
<p>Let’s take the log of this likelihood function - the natural log makes computation easier. Even for computers, this reduces the computational intensity especially with respect to extremely small decimals.</p>
<p><span class="math display">\[ \ln L(\pi|y) = \sum_{i=1}^{n} y_i \ln(\pi_i) + (1-y_i) \ln(1-\pi_i) \]</span></p>
<p>We can take this a step further and <em>parameterize</em> <span class="math inline">\(\pi\)</span> as a function of <span class="math inline">\(X\beta\)</span> where <span class="math inline">\(X\)</span> is the matrix of predictors and <span class="math inline">\(\beta\)</span> is the vector of coefficients such that</p>
<p><span class="math display">\[ \pi_i = F({X_i\beta}) \]</span></p>
<p>So our estimate of the binomial probability is a function of the linear predictor <span class="math inline">\(X\beta\)</span>. We map <span class="math inline">\(X\beta\)</span> onto the probability space <span class="math inline">\(\pi\)</span> using a link function, <span class="math inline">\(F\)</span>. The most common link functions are the logistic (logit model), and the standard normal (probit model). Let’s write the logit link:</p>
<p><span class="math display">\[ \pi_i = \frac{1}{1 + e^{-(X_i\beta)}} \]</span></p>
<p>and now let’s write this all in the log-likelihood function:</p>
<p><span class="math display">\[ \ln L(\beta|y) = \sum_{i=1}^{n} y_i \ln(\frac{1}{1 + e^{-(X_i\beta)}}) + (1-y_i) \ln(1-\frac{1}{1 + e^{-(X_i\beta)}}) \]</span></p>
</section>
<section id="maximizing-the-likelihood" class="level2">
<h2 class="anchored" data-anchor-id="maximizing-the-likelihood">Maximizing the Likelihood</h2>
<p>Let’s start with a simple maximization procedure called</p>
<p>The next step is to write a function that calculates the log-likelihood for a given value of <span class="math inline">\(\pi\)</span> and the observed data <span class="math inline">\(y\)</span>. Do this over and over for different values of <span class="math inline">\(\pi\)</span> and find the value of <span class="math inline">\(\pi\)</span> that maximizes the log-likelihood. First, let’s do this using the <code>maxLik</code> library in R.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(maxLik)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Write the binomial log-likelihood function</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>log_likelihood <span class="ot">&lt;-</span> <span class="cf">function</span>(pi, y) {</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(y <span class="sc">*</span> <span class="fu">log</span>(pi) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> y) <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> pi))</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co">#maximize the function using maxLik</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>m1m <span class="ot">&lt;-</span> <span class="fu">maxLik</span>(<span class="at">y=</span>y, log_likelihood, <span class="at">start =</span> <span class="fu">c</span>(<span class="fl">0.5</span>), <span class="at">method =</span> <span class="st">"NR"</span>) <span class="co">#Newton-Raphson method, starting value of 0.5</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>--------------------------------------------
Maximum Likelihood estimation
Newton-Raphson maximisation, 3 iterations
Return code 2: successive function values within tolerance limit (tol)
Log-Likelihood: -604.816 
1  free parameters
Estimates:
     Estimate Std. error t value Pr(&gt; t)    
[1,]  0.29300    0.01441   20.34  &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
--------------------------------------------</code></pre>
</div>
</div>
<p>Notice the value of <span class="math inline">\(\pi\)</span> that maximizes the log-likelihood is the same as the sample mean of <span class="math inline">\(y\)</span>, which is 0.293. The function recovers the true value of <span class="math inline">\(\pi\)</span> in this case.</p>
</section>
<section id="optimization" class="level2">
<h2 class="anchored" data-anchor-id="optimization">Optimization</h2>
<p>Numerical optimization is a field aimed at finding “best” outcomes or answers depending on some set of criteria - often, the “best” is the maximum or minimum of some function - that’s the case in maximum likelihood.</p>
<section id="grid-search" class="level3">
<h3 class="anchored" data-anchor-id="grid-search">Grid Search</h3>
<p>One way to accomplish this is to use a grid search, where we calculate the log-likelihood for a range of values of <span class="math inline">\(\pi\)</span> and find the value that maximizes the log-likelihood. We can repeat this to the desired level of specificity, progressively narrowing the grid. In this example, we’ll just do one search out to 3 decimal places. The steps are these:</p>
<ul>
<li>generate the range of candidate values of our parameter <span class="math inline">\(\pi\)</span> to plug into the log-likelihood function.</li>
<li>plug each value into the log-likelihood function to compute the log-likelihood for that value.</li>
<li>identify which value of <span class="math inline">\(\pi\)</span> maximizes the log-likelihood.</li>
</ul>
<p>Here’s code to do this:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate a vector of values of pi </span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>pi_trials <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.001</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate log-likelihood for each pi value</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>ll_values <span class="ot">&lt;-</span> <span class="fu">sapply</span>(pi_trials, log_likelihood, <span class="at">y =</span> y)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the pi value that maximizes the log-likelihood</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>pi_hat <span class="ot">&lt;-</span> pi_trials[<span class="fu">which.max</span>(ll_values)]</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pi_hat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.293</code></pre>
</div>
</div>
<p>You’ll note we recover the sample mean just as we did above using the <code>maxlik</code> function. Let’s plot the log-likelihood against the values of <span class="math inline">\(\pi\)</span> to visualize the maximum.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot log-likelihood against pi</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>bucolors<span class="ot">&lt;-</span><span class="fu">list</span>(<span class="st">"#005A43"</span>,<span class="st">"#6CC24A"</span>, <span class="st">"#A7DA92"</span>, <span class="st">"#BDBEBD"</span>, <span class="st">"#000000"</span> )</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>highcharter<span class="sc">::</span><span class="fu">highchart</span>() <span class="sc">%&gt;%</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_add_series</span>(<span class="fu">data.frame</span>(<span class="at">pi =</span> pi_trials, <span class="at">ll =</span> ll_values), <span class="st">"line"</span>, <span class="fu">hcaes</span>(<span class="at">x =</span> pi, <span class="at">y =</span> ll)) <span class="sc">%&gt;%</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_title</span>(<span class="at">text =</span> <span class="st">"What value of Pi maximizes the log-likelihood?"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_xAxis</span>(<span class="at">title =</span> <span class="fu">list</span>(<span class="at">text =</span> <span class="st">"Pi"</span>), </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">plotLines =</span> <span class="fu">list</span>(</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(<span class="at">color =</span><span class="st">"red"</span>, <span class="at">value =</span> pi_hat ))) <span class="sc">%&gt;%</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_yAxis</span>(<span class="at">title =</span> <span class="fu">list</span>(<span class="at">text =</span> <span class="st">"Log-Likelihood"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_legend</span>(<span class="at">enabled =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_colors</span>(bucolors)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="highchart html-widget html-fill-item" id="htmlwidget-ad4c6beb61c98091f17f" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-ad4c6beb61c98091f17f">{"x":{"hc_opts":{"chart":{"reflow":true},"title":{"text":"What value of Pi maximizes the log-likelihood?"},"yAxis":{"title":{"text":"Log-Likelihood"}},"credits":{"enabled":false},"exporting":{"enabled":false},"boost":{"enabled":false},"plotOptions":{"series":{"label":{"enabled":false},"turboThreshold":0},"treemap":{"layoutAlgorithm":"squarified"}},"series":[{"group":"group","data":[{"pi":0,"ll":null,"x":0,"y":null},{"pi":0.001,"ll":-2024.679650477581,"x":0.001,"y":-2024.679650477581},{"pi":0.002,"ll":-1822.295588725864,"x":0.002,"y":-1822.295588725864},{"pi":0.003,"ll":-1704.203084039354,"x":0.003,"y":-1704.203084039354},{"pi":0.004,"ll":-1620.62172006171,"x":0.004,"y":-1620.62172006171},{"pi":0.005,"ll":-1555.950855467836,"x":0.005,"y":-1555.950855467836},{"pi":0.006,"ll":-1503.241549392121,"x":0.006,"y":-1503.241549392121},{"pi":0.007,"ll":-1458.787025828976,"x":0.007,"y":-1458.787025828976},{"pi":0.008,"ll":-1420.374670419544,"x":0.008,"y":-1420.374670419544},{"pi":0.009000000000000001,"ll":-1386.577302051302,"x":0.009000000000000001,"y":-1386.577302051302},{"pi":0.01,"ll":-1356.420451942943,"x":0.01,"y":-1356.420451942943},{"pi":0.011,"ll":-1329.209071594963,"x":0.011,"y":-1329.209071594963},{"pi":0.012,"ll":-1304.429963286502,"x":0.012,"y":-1304.429963286502},{"pi":0.013,"ll":-1281.69339936644,"x":0.013,"y":-1281.69339936644},{"pi":0.014,"ll":-1260.696438700817,"x":0.014,"y":-1260.696438700817},{"pi":0.015,"ll":-1241.198929750534,"x":0.015,"y":-1241.198929750534},{"pi":0.016,"ll":-1223.00727414994,"x":0.016,"y":-1223.00727414994},{"pi":0.017,"ll":-1205.963121229628,"x":0.017,"y":-1205.963121229628},{"pi":0.018,"ll":-1189.935298911972,"x":0.018,"y":-1189.935298911972},{"pi":0.019,"ll":-1174.813929173646,"x":0.019,"y":-1174.813929173646},{"pi":0.02,"ll":-1160.506054663935,"x":0.02,"y":-1160.506054663935},{"pi":0.021,"ll":-1146.932333460104,"x":0.021,"y":-1146.932333460104},{"pi":0.022,"ll":-1134.02450343352,"x":0.022,"y":-1134.02450343352},{"pi":0.023,"ll":-1121.723410720661,"x":0.023,"y":-1121.723410720661},{"pi":0.024,"ll":-1109.977458096124,"x":0.024,"y":-1109.977458096124},{"pi":0.025,"ll":-1098.741370300262,"x":0.025,"y":-1098.741370300262},{"pi":0.026,"ll":-1087.975201666571,"x":0.026,"y":-1087.975201666571},{"pi":0.027,"ll":-1077.64353113737,"x":0.027,"y":-1077.64353113737},{"pi":0.028,"ll":-1067.714803747278,"x":0.028,"y":-1067.714803747278},{"pi":0.029,"ll":-1058.160787714122,"x":0.029,"y":-1058.160787714122},{"pi":0.03,"ll":-1048.956123606434,"x":0.03,"y":-1048.956123606434},{"pi":0.031,"ll":-1040.077947461215,"x":0.031,"y":-1040.077947461215},{"pi":0.032,"ll":-1031.505573757269,"x":0.032,"y":-1031.505573757269},{"pi":0.033,"ll":-1023.220227186985,"x":0.033,"y":-1023.220227186985},{"pi":0.034,"ll":-1015.204814481341,"x":0.034,"y":-1015.204814481341},{"pi":0.035,"ll":-1007.443729319076,"x":0.035,"y":-1007.443729319076},{"pi":0.036,"ll":-999.9226847248267,"x":0.036,"y":-999.9226847248267},{"pi":0.037,"ll":-992.6285684360926,"x":0.037,"y":-992.6285684360926},{"pi":0.038,"ll":-985.549317561664,"x":0.038,"y":-985.549317561664},{"pi":0.039,"ll":-978.6738095241641,"x":0.039,"y":-978.6738095241641},{"pi":0.04,"ll":-971.9917668121849,"x":0.04,"y":-971.9917668121849},{"pi":0.041,"ll":-965.4936734951933,"x":0.041,"y":-965.4936734951933},{"pi":0.042,"ll":-959.1707017997194,"x":0.042,"y":-959.1707017997194},{"pi":0.043,"ll":-953.0146473266717,"x":0.043,"y":-953.0146473266717},{"pi":0.044,"ll":-947.0178717167402,"x":0.044,"y":-947.0178717167402},{"pi":0.045,"ll":-941.1732517595502,"x":0.045,"y":-941.1732517595502},{"pi":0.046,"ll":-935.4741340968928,"x":0.046,"y":-935.4741340968928},{"pi":0.047,"ll":-929.9142947975926,"x":0.047,"y":-929.9142947975926},{"pi":0.048,"ll":-924.487903188626,"x":0.048,"y":-924.487903188626},{"pi":0.049,"ll":-919.189489416153,"x":0.049,"y":-919.189489416153},{"pi":0.05,"ll":-914.0139152833123,"x":0.05,"y":-914.0139152833123},{"pi":0.051,"ll":-908.9563479766823,"x":0.051,"y":-908.9563479766823},{"pi":0.052,"ll":-904.0122363434861,"x":0.052,"y":-904.0122363434861},{"pi":0.053,"ll":-899.1772894288258,"x":0.053,"y":-899.1772894288258},{"pi":0.054,"ll":-894.4474570191111,"x":0.054,"y":-894.4474570191111},{"pi":0.055,"ll":-889.8189119709485,"x":0.055,"y":-889.8189119709485},{"pi":0.056,"ll":-885.2880341318653,"x":0.056,"y":-885.2880341318653},{"pi":0.057,"ll":-880.8513956847637,"x":0.057,"y":-880.8513956847637},{"pi":0.058,"ll":-876.5057477665665,"x":0.058,"y":-876.5057477665665},{"pi":0.059,"ll":-872.2480082308849,"x":0.059,"y":-872.2480082308849},{"pi":0.06,"ll":-868.0752504393772,"x":0.06,"y":-868.0752504393772},{"pi":0.061,"ll":-863.9846929791048,"x":0.061,"y":-863.9846929791048},{"pi":0.062,"ll":-859.9736902165058,"x":0.062,"y":-859.9736902165058},{"pi":0.063,"ll":-856.0397236068669,"x":0.063,"y":-856.0397236068669},{"pi":0.064,"ll":-852.1803936880797,"x":0.064,"y":-852.1803936880797},{"pi":0.065,"ll":-848.3934126956191,"x":0.065,"y":-848.3934126956191},{"pi":0.066,"ll":-844.6765977406204,"x":0.066,"y":-844.6765977406204},{"pi":0.067,"ll":-841.0278645015121,"x":0.067,"y":-841.0278645015121},{"pi":0.068,"ll":-837.4452213828425,"x":0.068,"y":-837.4452213828425},{"pi":0.06900000000000001,"ll":-833.9267641002613,"x":0.06900000000000001,"y":-833.9267641002613},{"pi":0.07000000000000001,"ll":-830.4706706555271,"x":0.07000000000000001,"y":-830.4706706555271},{"pi":0.07100000000000001,"ll":-827.0751966676439,"x":0.07100000000000001,"y":-827.0751966676439},{"pi":0.07200000000000001,"ll":-823.7386710305991,"x":0.07200000000000001,"y":-823.7386710305991},{"pi":0.073,"ll":-820.4594918705842,"x":0.073,"y":-820.4594918705842},{"pi":0.074,"ll":-817.236122778476,"x":0.074,"y":-817.236122778476},{"pi":0.075,"ll":-814.0670892947126,"x":0.075,"y":-814.0670892947126},{"pi":0.076,"ll":-810.9509756275636,"x":0.076,"y":-810.9509756275636},{"pi":0.077,"ll":-807.8864215854866,"x":0.077,"y":-807.8864215854866},{"pi":0.078,"ll":-804.8721197075781,"x":0.078,"y":-804.8721197075781},{"pi":0.079,"ll":-801.9068125767872,"x":0.079,"y":-801.9068125767872},{"pi":0.08,"ll":-798.9892903022267,"x":0.08,"y":-798.9892903022267},{"pi":0.081,"ll":-796.1183881576427,"x":0.081,"y":-796.1183881576427},{"pi":0.082,"ll":-793.2929843650221,"x":0.082,"y":-793.2929843650221},{"pi":0.083,"ll":-790.5119980124019,"x":0.083,"y":-790.5119980124019},{"pi":0.08400000000000001,"ll":-787.774387096452,"x":0.08400000000000001,"y":-787.774387096452},{"pi":0.08500000000000001,"ll":-785.0791466806747,"x":0.08500000000000001,"y":-785.0791466806747},{"pi":0.08600000000000001,"ll":-782.4253071617751,"x":0.08600000000000001,"y":-782.4253071617751},{"pi":0.08700000000000001,"ll":-779.8119326357082,"x":0.08700000000000001,"y":-779.8119326357082},{"pi":0.08799999999999999,"ll":-777.2381193574817,"x":0.08799999999999999,"y":-777.2381193574817},{"pi":0.089,"ll":-774.7029942878348,"x":0.089,"y":-774.7029942878348},{"pi":0.09,"ll":-772.2057137211691,"x":0.09,"y":-772.2057137211691},{"pi":0.091,"ll":-769.745461989236,"x":0.091,"y":-769.745461989236},{"pi":0.092,"ll":-767.321450235655,"x":0.092,"y":-767.321450235655},{"pi":0.093,"ll":-764.9329152568288,"x":0.093,"y":-764.9329152568288},{"pi":0.094,"ll":-762.5791184046453,"x":0.094,"y":-762.5791184046453},{"pi":0.095,"ll":-760.2593445473213,"x":0.095,"y":-760.2593445473213},{"pi":0.096,"ll":-757.9729010847849,"x":0.096,"y":-757.9729010847849},{"pi":0.097,"ll":-755.7191170148221,"x":0.097,"y":-755.7191170148221},{"pi":0.098,"ll":-753.4973420473727,"x":0.098,"y":-753.4973420473727},{"pi":0.099,"ll":-751.306945763602,"x":0.099,"y":-751.306945763602},{"pi":0.1,"ll":-749.1473168173331,"x":0.1,"y":-749.1473168173331},{"pi":0.101,"ll":-747.0178621762258,"x":0.101,"y":-747.0178621762258},{"pi":0.102,"ll":-744.9180064002038,"x":0.102,"y":-744.9180064002038},{"pi":0.103,"ll":-742.8471909552705,"x":0.103,"y":-742.8471909552705},{"pi":0.104,"ll":-740.8048735604381,"x":0.104,"y":-740.8048735604381},{"pi":0.105,"ll":-738.7905275656638,"x":0.105,"y":-738.7905275656638},{"pi":0.106,"ll":-736.8036413596311,"x":0.106,"y":-736.8036413596311},{"pi":0.107,"ll":-734.8437178051101,"x":0.107,"y":-734.8437178051101},{"pi":0.108,"ll":-732.9102737006802,"x":0.108,"y":-732.9102737006802},{"pi":0.109,"ll":-731.0028392671367,"x":0.109,"y":-731.0028392671367},{"pi":0.11,"ll":-729.120957657535,"x":0.11,"y":-729.120957657535},{"pi":0.111,"ll":-727.2641844893013,"x":0.111,"y":-727.2641844893013},{"pi":0.112,"ll":-725.4320873972169,"x":0.112,"y":-725.4320873972169},{"pi":0.113,"ll":-723.6242456065447,"x":0.113,"y":-723.6242456065447},{"pi":0.114,"ll":-721.8402495247495,"x":0.114,"y":-721.8402495247495},{"pi":0.115,"ll":-720.0797003510904,"x":0.115,"y":-720.0797003510904},{"pi":0.116,"ll":-718.3422097031437,"x":0.116,"y":-718.3422097031437},{"pi":0.117,"ll":-716.6273992593925,"x":0.117,"y":-716.6273992593925},{"pi":0.118,"ll":-714.9349004168949,"x":0.118,"y":-714.9349004168949},{"pi":0.119,"ll":-713.2643539635851,"x":0.119,"y":-713.2643539635851},{"pi":0.12,"ll":-711.6154097641095,"x":0.12,"y":-711.6154097641095},{"pi":0.121,"ll":-709.9877264588761,"x":0.121,"y":-709.9877264588761},{"pi":0.122,"ll":-708.3809711752733,"x":0.122,"y":-708.3809711752733},{"pi":0.123,"ll":-706.7948192508899,"x":0.123,"y":-706.7948192508899},{"pi":0.124,"ll":-705.2289539678367,"x":0.124,"y":-705.2289539678367},{"pi":0.125,"ll":-703.6830662977256,"x":0.125,"y":-703.6830662977256},{"pi":0.126,"ll":-702.1568546568977,"x":0.126,"y":-702.1568546568977},{"pi":0.127,"ll":-700.6500246711704,"x":0.127,"y":-700.6500246711704},{"pi":0.128,"ll":-699.1622889500558,"x":0.128,"y":-699.1622889500558},{"pi":0.129,"ll":-697.6933668694553,"x":0.129,"y":-697.6933668694553},{"pi":0.13,"ll":-696.2429843630822,"x":0.13,"y":-696.2429843630822},{"pi":0.131,"ll":-694.8108737215592,"x":0.131,"y":-694.8108737215592},{"pi":0.132,"ll":-693.3967733994717,"x":0.132,"y":-693.3967733994717},{"pi":0.133,"ll":-692.0004278293333,"x":0.133,"y":-692.0004278293333},{"pi":0.134,"ll":-690.6215872428654,"x":0.134,"y":-690.6215872428654},{"pi":0.135,"ll":-689.2600074988411,"x":0.135,"y":-689.2600074988411},{"pi":0.136,"ll":-687.9154499170058,"x":0.136,"y":-687.9154499170058},{"pi":0.137,"ll":-686.5876811185182,"x":0.137,"y":-686.5876811185182},{"pi":0.138,"ll":-685.2764728718465,"x":0.138,"y":-685.2764728718465},{"pi":0.139,"ll":-683.9816019444372,"x":0.139,"y":-683.9816019444372},{"pi":0.14,"ll":-682.7028499595975,"x":0.14,"y":-682.7028499595975},{"pi":0.141,"ll":-681.4400032584725,"x":0.141,"y":-681.4400032584725},{"pi":0.142,"ll":-680.1928527669801,"x":0.142,"y":-680.1928527669801},{"pi":0.143,"ll":-678.9611938673507,"x":0.143,"y":-678.9611938673507},{"pi":0.144,"ll":-677.744826274152,"x":0.144,"y":-677.744826274152},{"pi":0.145,"ll":-676.5435539146151,"x":0.145,"y":-676.5435539146151},{"pi":0.146,"ll":-675.3571848130659,"x":0.146,"y":-675.3571848130659},{"pi":0.147,"ll":-674.1855309793447,"x":0.147,"y":-674.1855309793447},{"pi":0.148,"ll":-673.0284083009187,"x":0.148,"y":-673.0284083009187},{"pi":0.149,"ll":-671.8856364387507,"x":0.149,"y":-671.8856364387507},{"pi":0.15,"ll":-670.757038726483,"x":0.15,"y":-670.757038726483},{"pi":0.151,"ll":-669.64244207323,"x":0.151,"y":-669.64244207323},{"pi":0.152,"ll":-668.5416768693083,"x":0.152,"y":-668.5416768693083},{"pi":0.153,"ll":-667.4545768951405,"x":0.153,"y":-667.4545768951405},{"pi":0.154,"ll":-666.3809792333425,"x":0.154,"y":-666.3809792333425},{"pi":0.155,"ll":-665.3207241832743,"x":0.155,"y":-665.3207241832743},{"pi":0.156,"ll":-664.2736551786768,"x":0.156,"y":-664.2736551786768},{"pi":0.157,"ll":-663.2396187077742,"x":0.157,"y":-663.2396187077742},{"pi":0.158,"ll":-662.2184642359022,"x":0.158,"y":-662.2184642359022},{"pi":0.159,"ll":-661.2100441307325,"x":0.159,"y":-661.2100441307325},{"pi":0.16,"ll":-660.2142135896178,"x":0.16,"y":-660.2142135896178},{"pi":0.161,"ll":-659.2308305693682,"x":0.161,"y":-659.2308305693682},{"pi":0.162,"ll":-658.2597557182117,"x":0.162,"y":-658.2597557182117},{"pi":0.163,"ll":-657.3008523096939,"x":0.163,"y":-657.3008523096939},{"pi":0.164,"ll":-656.3539861787724,"x":0.164,"y":-656.3539861787724},{"pi":0.165,"ll":-655.4190256597204,"x":0.165,"y":-655.4190256597204},{"pi":0.166,"ll":-654.4958415260342,"x":0.166,"y":-654.4958415260342},{"pi":0.167,"ll":-653.5843069320667,"x":0.167,"y":-653.5843069320667},{"pi":0.168,"ll":-652.6842973563824,"x":0.168,"y":-652.6842973563824},{"pi":0.169,"ll":-651.7956905468787,"x":0.169,"y":-651.7956905468787},{"pi":0.17,"ll":-650.9183664674185,"x":0.17,"y":-650.9183664674185},{"pi":0.171,"ll":-650.0522072461953,"x":0.171,"y":-650.0522072461953},{"pi":0.172,"ll":-649.1970971254113,"x":0.172,"y":-649.1970971254113},{"pi":0.173,"ll":-648.3529224125242,"x":0.173,"y":-648.3529224125242},{"pi":0.174,"ll":-647.5195714329499,"x":0.174,"y":-647.5195714329499},{"pi":0.175,"ll":-646.6969344839196,"x":0.175,"y":-646.6969344839196},{"pi":0.176,"ll":-645.8849037899645,"x":0.176,"y":-645.8849037899645},{"pi":0.177,"ll":-645.0833734593332,"x":0.177,"y":-645.0833734593332},{"pi":0.178,"ll":-644.2922394418378,"x":0.178,"y":-644.2922394418378},{"pi":0.179,"ll":-643.5113994879205,"x":0.179,"y":-643.5113994879205},{"pi":0.18,"ll":-642.7407531086874,"x":0.18,"y":-642.7407531086874},{"pi":0.181,"ll":-641.9802015371308,"x":0.181,"y":-641.9802015371308},{"pi":0.182,"ll":-641.2296476904856,"x":0.182,"y":-641.2296476904856},{"pi":0.183,"ll":-640.4889961335791,"x":0.183,"y":-640.4889961335791},{"pi":0.184,"ll":-639.7581530430817,"x":0.184,"y":-639.7581530430817},{"pi":0.185,"ll":-639.0370261729012,"x":0.185,"y":-639.0370261729012},{"pi":0.186,"ll":-638.3255248203734,"x":0.186,"y":-638.3255248203734},{"pi":0.187,"ll":-637.6235597934385,"x":0.187,"y":-637.6235597934385},{"pi":0.188,"ll":-636.9310433786575,"x":0.188,"y":-636.9310433786575},{"pi":0.189,"ll":-636.247889310073,"x":0.189,"y":-636.247889310073},{"pi":0.19,"ll":-635.5740127389049,"x":0.19,"y":-635.5740127389049},{"pi":0.191,"ll":-634.9093302041167,"x":0.191,"y":-634.9093302041167},{"pi":0.192,"ll":-634.2537596035816,"x":0.192,"y":-634.2537596035816},{"pi":0.193,"ll":-633.6072201661491,"x":0.193,"y":-633.6072201661491},{"pi":0.194,"ll":-632.9696324243923,"x":0.194,"y":-632.9696324243923},{"pi":0.195,"ll":-632.3409181880439,"x":0.195,"y":-632.3409181880439},{"pi":0.196,"ll":-631.7210005180649,"x":0.196,"y":-631.7210005180649},{"pi":0.197,"ll":-631.1098037015377,"x":0.197,"y":-631.1098037015377},{"pi":0.198,"ll":-630.5072532270161,"x":0.198,"y":-630.5072532270161},{"pi":0.199,"ll":-629.9132757605283,"x":0.199,"y":-629.9132757605283},{"pi":0.2,"ll":-629.3277991223418,"x":0.2,"y":-629.3277991223418},{"pi":0.201,"ll":-628.7507522640683,"x":0.201,"y":-628.7507522640683},{"pi":0.202,"ll":-628.1820652465751,"x":0.202,"y":-628.1820652465751},{"pi":0.203,"ll":-627.6216692182145,"x":0.203,"y":-627.6216692182145},{"pi":0.204,"ll":-627.0694963937924,"x":0.204,"y":-627.0694963937924},{"pi":0.205,"ll":-626.5254800339645,"x":0.205,"y":-626.5254800339645},{"pi":0.206,"ll":-625.9895544250743,"x":0.206,"y":-625.9895544250743},{"pi":0.207,"ll":-625.4616548595546,"x":0.207,"y":-625.4616548595546},{"pi":0.208,"ll":-624.9417176168459,"x":0.208,"y":-624.9417176168459},{"pi":0.209,"ll":-624.4296799447167,"x":0.209,"y":-624.4296799447167},{"pi":0.21,"ll":-623.9254800409445,"x":0.21,"y":-623.9254800409445},{"pi":0.211,"ll":-623.4290570356153,"x":0.211,"y":-623.4290570356153},{"pi":0.212,"ll":-622.9403509737267,"x":0.212,"y":-622.9403509737267},{"pi":0.213,"ll":-622.4593027981707,"x":0.213,"y":-622.4593027981707},{"pi":0.214,"ll":-621.9858543332774,"x":0.214,"y":-621.9858543332774},{"pi":0.215,"ll":-621.5199482685739,"x":0.215,"y":-621.5199482685739},{"pi":0.216,"ll":-621.0615281429357,"x":0.216,"y":-621.0615281429357},{"pi":0.217,"ll":-620.610538329287,"x":0.217,"y":-620.610538329287},{"pi":0.218,"ll":-620.1669240193957,"x":0.218,"y":-620.1669240193957},{"pi":0.219,"ll":-619.7306312092452,"x":0.219,"y":-619.7306312092452},{"pi":0.22,"ll":-619.3016066845697,"x":0.22,"y":-619.3016066845697},{"pi":0.221,"ll":-618.879798006825,"x":0.221,"y":-618.879798006825},{"pi":0.222,"ll":-618.4651534994482,"x":0.222,"y":-618.4651534994482},{"pi":0.223,"ll":-618.0576222344063,"x":0.223,"y":-618.0576222344063},{"pi":0.224,"ll":-617.6571540190797,"x":0.224,"y":-617.6571540190797},{"pi":0.225,"ll":-617.2636993834245,"x":0.225,"y":-617.2636993834245},{"pi":0.226,"ll":-616.8772095674199,"x":0.226,"y":-616.8772095674199},{"pi":0.227,"ll":-616.4976365087772,"x":0.227,"y":-616.4976365087772},{"pi":0.228,"ll":-616.1249328309756,"x":0.228,"y":-616.1249328309756},{"pi":0.229,"ll":-615.7590518314706,"x":0.229,"y":-615.7590518314706},{"pi":0.23,"ll":-615.3999474702908,"x":0.23,"y":-615.3999474702908},{"pi":0.231,"ll":-615.0475743587664,"x":0.231,"y":-615.0475743587664},{"pi":0.232,"ll":-614.7018877485085,"x":0.232,"y":-614.7018877485085},{"pi":0.233,"ll":-614.3628435207396,"x":0.233,"y":-614.3628435207396},{"pi":0.234,"ll":-614.0303981757379,"x":0.234,"y":-614.0303981757379},{"pi":0.235,"ll":-613.7045088225346,"x":0.235,"y":-613.7045088225346},{"pi":0.236,"ll":-613.3851331689103,"x":0.236,"y":-613.3851331689103},{"pi":0.237,"ll":-613.072229511433,"x":0.237,"y":-613.072229511433},{"pi":0.238,"ll":-612.7657567259298,"x":0.238,"y":-612.7657567259298},{"pi":0.239,"ll":-612.4656742579931,"x":0.239,"y":-612.4656742579931},{"pi":0.24,"ll":-612.1719421137019,"x":0.24,"y":-612.1719421137019},{"pi":0.241,"ll":-611.8845208506592,"x":0.241,"y":-611.8845208506592},{"pi":0.242,"ll":-611.6033715690725,"x":0.242,"y":-611.6033715690725},{"pi":0.243,"ll":-611.3284559030816,"x":0.243,"y":-611.3284559030816},{"pi":0.244,"ll":-611.0597360122993,"x":0.244,"y":-611.0597360122993},{"pi":0.245,"ll":-610.7971745734718,"x":0.245,"y":-610.7971745734718},{"pi":0.246,"ll":-610.5407347723311,"x":0.246,"y":-610.5407347723311},{"pi":0.247,"ll":-610.2903802956221,"x":0.247,"y":-610.2903802956221},{"pi":0.248,"ll":-610.0460753232601,"x":0.248,"y":-610.0460753232601},{"pi":0.249,"ll":-609.8077845207288,"x":0.249,"y":-609.8077845207288},{"pi":0.25,"ll":-609.5754730315347,"x":0.25,"y":-609.5754730315347},{"pi":0.251,"ll":-609.3491064698454,"x":0.251,"y":-609.3491064698454},{"pi":0.252,"ll":-609.128650913339,"x":0.252,"y":-609.128650913339},{"pi":0.253,"ll":-608.9140728960632,"x":0.253,"y":-608.9140728960632},{"pi":0.254,"ll":-608.7053394016493,"x":0.254,"y":-608.7053394016493},{"pi":0.255,"ll":-608.5024178563707,"x":0.255,"y":-608.5024178563707},{"pi":0.256,"ll":-608.3052761226339,"x":0.256,"y":-608.3052761226339},{"pi":0.257,"ll":-608.1138824923778,"x":0.257,"y":-608.1138824923778},{"pi":0.258,"ll":-607.928205680766,"x":0.258,"y":-607.928205680766},{"pi":0.259,"ll":-607.7482148198278,"x":0.259,"y":-607.7482148198278},{"pi":0.26,"ll":-607.5738794524524,"x":0.26,"y":-607.5738794524524},{"pi":0.261,"ll":-607.4051695262177,"x":0.261,"y":-607.4051695262177},{"pi":0.262,"ll":-607.2420553875992,"x":0.262,"y":-607.2420553875992},{"pi":0.263,"ll":-607.0845077761871,"x":0.263,"y":-607.0845077761871},{"pi":0.264,"ll":-606.9324978189578,"x":0.264,"y":-606.9324978189578},{"pi":0.265,"ll":-606.7859970247079,"x":0.265,"y":-606.7859970247079},{"pi":0.266,"ll":-606.6449772786352,"x":0.266,"y":-606.6449772786352},{"pi":0.267,"ll":-606.5094108370067,"x":0.267,"y":-606.5094108370067},{"pi":0.268,"ll":-606.3792703218108,"x":0.268,"y":-606.3792703218108},{"pi":0.269,"ll":-606.2545287157059,"x":0.269,"y":-606.2545287157059},{"pi":0.27,"ll":-606.1351593569074,"x":0.27,"y":-606.1351593569074},{"pi":0.271,"ll":-606.0211359342559,"x":0.271,"y":-606.0211359342559},{"pi":0.272,"ll":-605.9124324823565,"x":0.272,"y":-605.9124324823565},{"pi":0.273,"ll":-605.8090233767373,"x":0.273,"y":-605.8090233767373},{"pi":0.274,"ll":-605.7108833293038,"x":0.274,"y":-605.7108833293038},{"pi":0.275,"ll":-605.6179873835852,"x":0.275,"y":-605.6179873835852},{"pi":0.276,"ll":-605.530310910317,"x":0.276,"y":-605.530310910317},{"pi":0.277,"ll":-605.447829602993,"x":0.277,"y":-605.447829602993},{"pi":0.278,"ll":-605.3705194735492,"x":0.278,"y":-605.3705194735492},{"pi":0.279,"ll":-605.2983568480089,"x":0.279,"y":-605.2983568480089},{"pi":0.28,"ll":-605.2313183624041,"x":0.28,"y":-605.2313183624041},{"pi":0.281,"ll":-605.1693809585789,"x":0.281,"y":-605.1693809585789},{"pi":0.282,"ll":-605.1125218801819,"x":0.282,"y":-605.1125218801819},{"pi":0.283,"ll":-605.0607186687457,"x":0.283,"y":-605.0607186687457},{"pi":0.284,"ll":-605.0139491597268,"x":0.284,"y":-605.0139491597268},{"pi":0.285,"ll":-604.9721914787574,"x":0.285,"y":-604.9721914787574},{"pi":0.286,"ll":-604.9354240378324,"x":0.286,"y":-604.9354240378324},{"pi":0.287,"ll":-604.9036255316673,"x":0.287,"y":-604.9036255316673},{"pi":0.288,"ll":-604.8767749340494,"x":0.288,"y":-604.8767749340494},{"pi":0.289,"ll":-604.8548514943044,"x":0.289,"y":-604.8548514943044},{"pi":0.29,"ll":-604.8378347338441,"x":0.29,"y":-604.8378347338441},{"pi":0.291,"ll":-604.8257044426806,"x":0.291,"y":-604.8257044426806},{"pi":0.292,"ll":-604.8184406760764,"x":0.292,"y":-604.8184406760764},{"pi":0.293,"ll":-604.8160237512543,"x":0.293,"y":-604.8160237512543},{"pi":0.294,"ll":-604.8184342441831,"x":0.294,"y":-604.8184342441831},{"pi":0.295,"ll":-604.8256529862927,"x":0.295,"y":-604.8256529862927},{"pi":0.296,"ll":-604.8376610614456,"x":0.296,"y":-604.8376610614456},{"pi":0.297,"ll":-604.8544398028056,"x":0.297,"y":-604.8544398028056},{"pi":0.298,"ll":-604.8759707898116,"x":0.298,"y":-604.8759707898116},{"pi":0.299,"ll":-604.9022358452095,"x":0.299,"y":-604.9022358452095},{"pi":0.3,"ll":-604.9332170321893,"x":0.3,"y":-604.9332170321893},{"pi":0.301,"ll":-604.9688966514133,"x":0.301,"y":-604.9688966514133},{"pi":0.302,"ll":-605.0092572382986,"x":0.302,"y":-605.0092572382986},{"pi":0.303,"ll":-605.0542815601965,"x":0.303,"y":-605.0542815601965},{"pi":0.304,"ll":-605.103952613671,"x":0.304,"y":-605.103952613671},{"pi":0.305,"ll":-605.1582536218646,"x":0.305,"y":-605.1582536218646},{"pi":0.306,"ll":-605.2171680317863,"x":0.306,"y":-605.2171680317863},{"pi":0.307,"ll":-605.2806795118245,"x":0.307,"y":-605.2806795118245},{"pi":0.308,"ll":-605.3487719491799,"x":0.308,"y":-605.3487719491799},{"pi":0.309,"ll":-605.4214294473489,"x":0.309,"y":-605.4214294473489},{"pi":0.31,"ll":-605.4986363236823,"x":0.31,"y":-605.4986363236823},{"pi":0.311,"ll":-605.5803771069691,"x":0.311,"y":-605.5803771069691},{"pi":0.312,"ll":-605.6666365350906,"x":0.312,"y":-605.6666365350906},{"pi":0.313,"ll":-605.7573995526619,"x":0.313,"y":-605.7573995526619},{"pi":0.314,"ll":-605.8526513088211,"x":0.314,"y":-605.8526513088211},{"pi":0.315,"ll":-605.9523771548301,"x":0.315,"y":-605.9523771548301},{"pi":0.316,"ll":-606.056562642025,"x":0.316,"y":-606.056562642025},{"pi":0.317,"ll":-606.165193519533,"x":0.317,"y":-606.165193519533},{"pi":0.318,"ll":-606.2782557322101,"x":0.318,"y":-606.2782557322101},{"pi":0.319,"ll":-606.3957354184743,"x":0.319,"y":-606.3957354184743},{"pi":0.32,"ll":-606.5176189082626,"x":0.32,"y":-606.5176189082626},{"pi":0.321,"ll":-606.6438927210386,"x":0.321,"y":-606.6438927210386},{"pi":0.322,"ll":-606.7745435637704,"x":0.322,"y":-606.7745435637704},{"pi":0.323,"ll":-606.909558328916,"x":0.323,"y":-606.909558328916},{"pi":0.324,"ll":-607.0489240926066,"x":0.324,"y":-607.0489240926066},{"pi":0.325,"ll":-607.1926281126374,"x":0.325,"y":-607.1926281126374},{"pi":0.326,"ll":-607.340657826689,"x":0.326,"y":-607.340657826689},{"pi":0.327,"ll":-607.4930008504152,"x":0.327,"y":-607.4930008504152},{"pi":0.328,"ll":-607.6496449757087,"x":0.328,"y":-607.6496449757087},{"pi":0.329,"ll":-607.8105781689086,"x":0.329,"y":-607.8105781689086},{"pi":0.33,"ll":-607.9757885690077,"x":0.33,"y":-607.9757885690077},{"pi":0.331,"ll":-608.1452644860028,"x":0.331,"y":-608.1452644860028},{"pi":0.332,"ll":-608.3189943992028,"x":0.332,"y":-608.3189943992028},{"pi":0.333,"ll":-608.4969669555117,"x":0.333,"y":-608.4969669555117},{"pi":0.334,"ll":-608.6791709679088,"x":0.334,"y":-608.6791709679088},{"pi":0.335,"ll":-608.8655954137054,"x":0.335,"y":-608.8655954137054},{"pi":0.336,"ll":-609.0562294330886,"x":0.336,"y":-609.0562294330886},{"pi":0.337,"ll":-609.251062327496,"x":0.337,"y":-609.251062327496},{"pi":0.338,"ll":-609.4500835581564,"x":0.338,"y":-609.4500835581564},{"pi":0.339,"ll":-609.6532827445196,"x":0.339,"y":-609.6532827445196},{"pi":0.34,"ll":-609.860649662874,"x":0.34,"y":-609.860649662874},{"pi":0.341,"ll":-610.0721742448009,"x":0.341,"y":-610.0721742448009},{"pi":0.342,"ll":-610.2878465758026,"x":0.342,"y":-610.2878465758026},{"pi":0.343,"ll":-610.5076568938933,"x":0.343,"y":-610.5076568938933},{"pi":0.344,"ll":-610.7315955882575,"x":0.344,"y":-610.7315955882575},{"pi":0.345,"ll":-610.9596531978299,"x":0.345,"y":-610.9596531978299},{"pi":0.346,"ll":-611.1918204099748,"x":0.346,"y":-611.1918204099748},{"pi":0.347,"ll":-611.4280880592786,"x":0.347,"y":-611.4280880592786},{"pi":0.348,"ll":-611.6684471260733,"x":0.348,"y":-611.6684471260733},{"pi":0.349,"ll":-611.9128887353584,"x":0.349,"y":-611.9128887353584},{"pi":0.35,"ll":-612.1614041554825,"x":0.35,"y":-612.1614041554825},{"pi":0.351,"ll":-612.4139847968448,"x":0.351,"y":-612.4139847968448},{"pi":0.352,"ll":-612.6706222108353,"x":0.352,"y":-612.6706222108353},{"pi":0.353,"ll":-612.9313080885374,"x":0.353,"y":-612.9313080885374},{"pi":0.354,"ll":-613.1960342596346,"x":0.354,"y":-613.1960342596346},{"pi":0.355,"ll":-613.4647926912235,"x":0.355,"y":-613.4647926912235},{"pi":0.356,"ll":-613.737575486706,"x":0.356,"y":-613.737575486706},{"pi":0.357,"ll":-614.0143748847048,"x":0.357,"y":-614.0143748847048},{"pi":0.358,"ll":-614.2951832579323,"x":0.358,"y":-614.2951832579323},{"pi":0.359,"ll":-614.5799931121595,"x":0.359,"y":-614.5799931121595},{"pi":0.36,"ll":-614.868797085164,"x":0.36,"y":-614.868797085164},{"pi":0.361,"ll":-615.1615879456904,"x":0.361,"y":-615.1615879456904},{"pi":0.362,"ll":-615.4583585924169,"x":0.362,"y":-615.4583585924169},{"pi":0.363,"ll":-615.7591020530159,"x":0.363,"y":-615.7591020530159},{"pi":0.364,"ll":-616.0638114831032,"x":0.364,"y":-616.0638114831032},{"pi":0.365,"ll":-616.3724801653316,"x":0.365,"y":-616.3724801653316},{"pi":0.366,"ll":-616.6851015084198,"x":0.366,"y":-616.6851015084198},{"pi":0.367,"ll":-617.001669046223,"x":0.367,"y":-617.001669046223},{"pi":0.368,"ll":-617.3221764368185,"x":0.368,"y":-617.3221764368185},{"pi":0.369,"ll":-617.6466174616387,"x":0.369,"y":-617.6466174616387},{"pi":0.37,"ll":-617.9749860245222,"x":0.37,"y":-617.9749860245222},{"pi":0.371,"ll":-618.3072761509441,"x":0.371,"y":-618.3072761509441},{"pi":0.372,"ll":-618.6434819870922,"x":0.372,"y":-618.6434819870922},{"pi":0.373,"ll":-618.9835977990307,"x":0.373,"y":-618.9835977990307},{"pi":0.374,"ll":-619.3276179719018,"x":0.374,"y":-619.3276179719018},{"pi":0.375,"ll":-619.6755370091782,"x":0.375,"y":-619.6755370091782},{"pi":0.376,"ll":-620.0273495317042,"x":0.376,"y":-620.0273495317042},{"pi":0.377,"ll":-620.3830502771375,"x":0.377,"y":-620.3830502771375},{"pi":0.378,"ll":-620.7426340989928,"x":0.378,"y":-620.7426340989928},{"pi":0.379,"ll":-621.1060959660281,"x":0.379,"y":-621.1060959660281},{"pi":0.38,"ll":-621.4734309613823,"x":0.38,"y":-621.4734309613823},{"pi":0.381,"ll":-621.8446342820081,"x":0.381,"y":-621.8446342820081},{"pi":0.382,"ll":-622.2197012378218,"x":0.382,"y":-622.2197012378218},{"pi":0.383,"ll":-622.5986272510944,"x":0.383,"y":-622.5986272510944},{"pi":0.384,"ll":-622.9814078557334,"x":0.384,"y":-622.9814078557334},{"pi":0.385,"ll":-623.3680386966123,"x":0.385,"y":-623.3680386966123},{"pi":0.386,"ll":-623.7585155289088,"x":0.386,"y":-623.7585155289088},{"pi":0.387,"ll":-624.1528342174956,"x":0.387,"y":-624.1528342174956},{"pi":0.388,"ll":-624.5509907363138,"x":0.388,"y":-624.5509907363138},{"pi":0.389,"ll":-624.9529811676057,"x":0.389,"y":-624.9529811676057},{"pi":0.39,"ll":-625.3588017015701,"x":0.39,"y":-625.3588017015701},{"pi":0.391,"ll":-625.7684486355267,"x":0.391,"y":-625.7684486355267},{"pi":0.392,"ll":-626.1819183734511,"x":0.392,"y":-626.1819183734511},{"pi":0.393,"ll":-626.5992074253766,"x":0.393,"y":-626.5992074253766},{"pi":0.394,"ll":-627.0203124068435,"x":0.394,"y":-627.0203124068435},{"pi":0.395,"ll":-627.4452300383037,"x":0.395,"y":-627.4452300383037},{"pi":0.396,"ll":-627.8739571446646,"x":0.396,"y":-627.8739571446646},{"pi":0.397,"ll":-628.3064906546747,"x":0.397,"y":-628.3064906546747},{"pi":0.398,"ll":-628.7428276004649,"x":0.398,"y":-628.7428276004649},{"pi":0.399,"ll":-629.182965117017,"x":0.399,"y":-629.182965117017},{"pi":0.4,"ll":-629.626900441675,"x":0.4,"y":-629.626900441675},{"pi":0.401,"ll":-630.0746309136817,"x":0.401,"y":-630.0746309136817},{"pi":0.402,"ll":-630.526153973677,"x":0.402,"y":-630.526153973677},{"pi":0.403,"ll":-630.9814671631899,"x":0.403,"y":-630.9814671631899},{"pi":0.404,"ll":-631.4405681243239,"x":0.404,"y":-631.4405681243239},{"pi":0.405,"ll":-631.9034545991616,"x":0.405,"y":-631.9034545991616},{"pi":0.406,"ll":-632.3701244294429,"x":0.406,"y":-632.3701244294429},{"pi":0.407,"ll":-632.8405755560727,"x":0.407,"y":-632.8405755560727},{"pi":0.408,"ll":-633.3148060187324,"x":0.408,"y":-633.3148060187324},{"pi":0.409,"ll":-633.7928139554746,"x":0.409,"y":-633.7928139554746},{"pi":0.41,"ll":-634.2745976023772,"x":0.41,"y":-634.2745976023772},{"pi":0.411,"ll":-634.7601552930691,"x":0.411,"y":-634.7601552930691},{"pi":0.412,"ll":-635.2494854583917,"x":0.412,"y":-635.2494854583917},{"pi":0.413,"ll":-635.7425866260951,"x":0.413,"y":-635.7425866260951},{"pi":0.414,"ll":-636.2394574203734,"x":0.414,"y":-636.2394574203734},{"pi":0.415,"ll":-636.7400965616213,"x":0.415,"y":-636.7400965616213},{"pi":0.416,"ll":-637.2445028660326,"x":0.416,"y":-637.2445028660326},{"pi":0.417,"ll":-637.7526752452916,"x":0.417,"y":-637.7526752452916},{"pi":0.418,"ll":-638.2646127062567,"x":0.418,"y":-638.2646127062567},{"pi":0.419,"ll":-638.7803143506472,"x":0.419,"y":-638.7803143506472},{"pi":0.42,"ll":-639.2997793747511,"x":0.42,"y":-639.2997793747511},{"pi":0.421,"ll":-639.8230070690935,"x":0.421,"y":-639.8230070690935},{"pi":0.422,"ll":-640.3499968182263,"x":0.422,"y":-640.3499968182263},{"pi":0.423,"ll":-640.880748100351,"x":0.423,"y":-640.880748100351},{"pi":0.424,"ll":-641.4152604871757,"x":0.424,"y":-641.4152604871757},{"pi":0.425,"ll":-641.95353364355,"x":0.425,"y":-641.95353364355},{"pi":0.426,"ll":-642.4955673272783,"x":0.426,"y":-642.4955673272783},{"pi":0.427,"ll":-643.0413613888311,"x":0.427,"y":-643.0413613888311},{"pi":0.428,"ll":-643.5909157711559,"x":0.428,"y":-643.5909157711559},{"pi":0.429,"ll":-644.1442305094272,"x":0.429,"y":-644.1442305094272},{"pi":0.43,"ll":-644.7013057308413,"x":0.43,"y":-644.7013057308413},{"pi":0.431,"ll":-645.2621416544304,"x":0.431,"y":-645.2621416544304},{"pi":0.432,"ll":-645.8267385907525,"x":0.432,"y":-645.8267385907525},{"pi":0.433,"ll":-646.3950969418865,"x":0.433,"y":-646.3950969418865},{"pi":0.434,"ll":-646.9672172010644,"x":0.434,"y":-646.9672172010644},{"pi":0.435,"ll":-647.5430999526224,"x":0.435,"y":-647.5430999526224},{"pi":0.436,"ll":-648.1227458717342,"x":0.436,"y":-648.1227458717342},{"pi":0.437,"ll":-648.7061557243692,"x":0.437,"y":-648.7061557243692},{"pi":0.438,"ll":-649.2933303669959,"x":0.438,"y":-649.2933303669959},{"pi":0.439,"ll":-649.8842707465668,"x":0.439,"y":-649.8842707465668},{"pi":0.44,"ll":-650.4789779002983,"x":0.44,"y":-650.4789779002983},{"pi":0.441,"ll":-651.0774529555625,"x":0.441,"y":-651.0774529555625},{"pi":0.442,"ll":-651.6796971297842,"x":0.442,"y":-651.6796971297842},{"pi":0.443,"ll":-652.2857117303225,"x":0.443,"y":-652.2857117303225},{"pi":0.444,"ll":-652.8954981543271,"x":0.444,"y":-652.8954981543271},{"pi":0.445,"ll":-653.5090578886961,"x":0.445,"y":-653.5090578886961},{"pi":0.446,"ll":-654.1263925099286,"x":0.446,"y":-654.1263925099286},{"pi":0.447,"ll":-654.7475036840621,"x":0.447,"y":-654.7475036840621},{"pi":0.448,"ll":-655.372393166634,"x":0.448,"y":-655.372393166634},{"pi":0.449,"ll":-656.0010628025473,"x":0.449,"y":-656.0010628025473},{"pi":0.45,"ll":-656.6335145260346,"x":0.45,"y":-656.6335145260346},{"pi":0.451,"ll":-657.269750360608,"x":0.451,"y":-657.269750360608},{"pi":0.452,"ll":-657.9097724190435,"x":0.452,"y":-657.9097724190435},{"pi":0.453,"ll":-658.5535829032665,"x":0.453,"y":-658.5535829032665},{"pi":0.454,"ll":-659.2011841043842,"x":0.454,"y":-659.2011841043842},{"pi":0.455,"ll":-659.8525784025954,"x":0.455,"y":-659.8525784025954},{"pi":0.456,"ll":-660.5077682672637,"x":0.456,"y":-660.5077682672637},{"pi":0.457,"ll":-661.1667562568425,"x":0.457,"y":-661.1667562568425},{"pi":0.458,"ll":-661.8295450188454,"x":0.458,"y":-661.8295450188454},{"pi":0.459,"ll":-662.4961372899267,"x":0.459,"y":-662.4961372899267},{"pi":0.46,"ll":-663.1665358958351,"x":0.46,"y":-663.1665358958351},{"pi":0.461,"ll":-663.8407437514562,"x":0.461,"y":-663.8407437514562},{"pi":0.462,"ll":-664.5187638608072,"x":0.462,"y":-664.5187638608072},{"pi":0.463,"ll":-665.2005993170985,"x":0.463,"y":-665.2005993170985},{"pi":0.464,"ll":-665.8862533027777,"x":0.464,"y":-665.8862533027777},{"pi":0.465,"ll":-666.5757290895737,"x":0.465,"y":-666.5757290895737},{"pi":0.466,"ll":-667.2690300384626,"x":0.466,"y":-667.2690300384626},{"pi":0.467,"ll":-667.9661595999033,"x":0.467,"y":-667.9661595999033},{"pi":0.468,"ll":-668.6671213137301,"x":0.468,"y":-668.6671213137301},{"pi":0.469,"ll":-669.371918809327,"x":0.469,"y":-669.371918809327},{"pi":0.47,"ll":-670.0805558057018,"x":0.47,"y":-670.0805558057018},{"pi":0.471,"ll":-670.7930361115067,"x":0.471,"y":-670.7930361115067},{"pi":0.472,"ll":-671.5093636252545,"x":0.472,"y":-671.5093636252545},{"pi":0.473,"ll":-672.2295423352549,"x":0.473,"y":-672.2295423352549},{"pi":0.474,"ll":-672.9535763199293,"x":0.474,"y":-672.9535763199293},{"pi":0.475,"ll":-673.681469747708,"x":0.475,"y":-673.681469747708},{"pi":0.476,"ll":-674.4132268773647,"x":0.476,"y":-674.4132268773647},{"pi":0.477,"ll":-675.1488520579425,"x":0.477,"y":-675.1488520579425},{"pi":0.478,"ll":-675.8883497291203,"x":0.478,"y":-675.8883497291203},{"pi":0.479,"ll":-676.6317244211018,"x":0.479,"y":-676.6317244211018},{"pi":0.48,"ll":-677.3789807550173,"x":0.48,"y":-677.3789807550173},{"pi":0.481,"ll":-678.1301234428641,"x":0.481,"y":-678.1301234428641},{"pi":0.482,"ll":-678.8851572878665,"x":0.482,"y":-678.8851572878665},{"pi":0.483,"ll":-679.644087184462,"x":0.483,"y":-679.644087184462},{"pi":0.484,"ll":-680.4069181187009,"x":0.484,"y":-680.4069181187009},{"pi":0.485,"ll":-681.1736551682012,"x":0.485,"y":-681.1736551682012},{"pi":0.486,"ll":-681.9443035024927,"x":0.486,"y":-681.9443035024927},{"pi":0.487,"ll":-682.718868383213,"x":0.487,"y":-682.718868383213},{"pi":0.488,"ll":-683.4973551642394,"x":0.488,"y":-683.4973551642394},{"pi":0.489,"ll":-684.2797692919847,"x":0.489,"y":-684.2797692919847},{"pi":0.49,"ll":-685.0661163055745,"x":0.49,"y":-685.0661163055745},{"pi":0.491,"ll":-685.856401837114,"x":0.491,"y":-685.856401837114},{"pi":0.492,"ll":-686.6506316119127,"x":0.492,"y":-686.6506316119127},{"pi":0.493,"ll":-687.4488114486575,"x":0.493,"y":-687.4488114486575},{"pi":0.494,"ll":-688.2509472598462,"x":0.494,"y":-688.2509472598462},{"pi":0.495,"ll":-689.0570450518314,"x":0.495,"y":-689.0570450518314},{"pi":0.496,"ll":-689.8671109252817,"x":0.496,"y":-689.8671109252817},{"pi":0.497,"ll":-690.681151075314,"x":0.497,"y":-690.681151075314},{"pi":0.498,"ll":-691.4991717918567,"x":0.498,"y":-691.4991717918567},{"pi":0.499,"ll":-692.3211794599409,"x":0.499,"y":-692.3211794599409},{"pi":0.5,"ll":-693.1471805599322,"x":0.5,"y":-693.1471805599322},{"pi":0.501,"ll":-693.9771816679413,"x":0.501,"y":-693.9771816679413},{"pi":0.502,"ll":-694.8111894560191,"x":0.502,"y":-694.8111894560191},{"pi":0.503,"ll":-695.6492106926078,"x":0.503,"y":-695.6492106926078},{"pi":0.504,"ll":-696.4912522427063,"x":0.504,"y":-696.4912522427063},{"pi":0.505,"ll":-697.337321068391,"x":0.505,"y":-697.337321068391},{"pi":0.506,"ll":-698.1874242290512,"x":0.506,"y":-698.1874242290512},{"pi":0.507,"ll":-699.04156888174,"x":0.507,"y":-699.04156888174},{"pi":0.508,"ll":-699.8997622815762,"x":0.508,"y":-699.8997622815762},{"pi":0.509,"ll":-700.7620117820996,"x":0.509,"y":-700.7620117820996},{"pi":0.51,"ll":-701.628324835656,"x":0.51,"y":-701.628324835656},{"pi":0.511,"ll":-702.4987089937285,"x":0.511,"y":-702.4987089937285},{"pi":0.512,"ll":-703.3731719073907,"x":0.512,"y":-703.3731719073907},{"pi":0.513,"ll":-704.2517213277112,"x":0.513,"y":-704.2517213277112},{"pi":0.514,"ll":-705.134365106119,"x":0.514,"y":-705.134365106119},{"pi":0.515,"ll":-706.021111194866,"x":0.515,"y":-706.021111194866},{"pi":0.516,"ll":-706.9119676473838,"x":0.516,"y":-706.9119676473838},{"pi":0.517,"ll":-707.8069426187969,"x":0.517,"y":-707.8069426187969},{"pi":0.518,"ll":-708.706044366347,"x":0.518,"y":-708.706044366347},{"pi":0.519,"ll":-709.6092812497504,"x":0.519,"y":-709.6092812497504},{"pi":0.52,"ll":-710.5166617318583,"x":0.52,"y":-710.5166617318583},{"pi":0.521,"ll":-711.4281943788747,"x":0.521,"y":-711.4281943788747},{"pi":0.522,"ll":-712.3438878610735,"x":0.522,"y":-712.3438878610735},{"pi":0.523,"ll":-713.2637509530608,"x":0.523,"y":-713.2637509530608},{"pi":0.524,"ll":-714.1877925344675,"x":0.524,"y":-714.1877925344675},{"pi":0.525,"ll":-715.1160215903059,"x":0.525,"y":-715.1160215903059},{"pi":0.526,"ll":-716.0484472115687,"x":0.526,"y":-716.0484472115687},{"pi":0.527,"ll":-716.9850785957258,"x":0.527,"y":-716.9850785957258},{"pi":0.528,"ll":-717.9259250472253,"x":0.528,"y":-717.9259250472253},{"pi":0.529,"ll":-718.870995978046,"x":0.529,"y":-718.870995978046},{"pi":0.53,"ll":-719.8203009083041,"x":0.53,"y":-719.8203009083041},{"pi":0.531,"ll":-720.77384946673,"x":0.531,"y":-720.77384946673},{"pi":0.532,"ll":-721.7316513912652,"x":0.532,"y":-721.7316513912652},{"pi":0.533,"ll":-722.6937165296376,"x":0.533,"y":-722.6937165296376},{"pi":0.534,"ll":-723.6600548399653,"x":0.534,"y":-723.6600548399653},{"pi":0.535,"ll":-724.6306763913586,"x":0.535,"y":-724.6306763913586},{"pi":0.536,"ll":-725.6055913644171,"x":0.536,"y":-725.6055913644171},{"pi":0.537,"ll":-726.5848100520672,"x":0.537,"y":-726.5848100520672},{"pi":0.538,"ll":-727.568342859954,"x":0.538,"y":-727.568342859954},{"pi":0.539,"ll":-728.5562003071605,"x":0.539,"y":-728.5562003071605},{"pi":0.54,"ll":-729.5483930269646,"x":0.54,"y":-729.5483930269646},{"pi":0.541,"ll":-730.5449317672994,"x":0.541,"y":-730.5449317672994},{"pi":0.542,"ll":-731.5458273915793,"x":0.542,"y":-731.5458273915793},{"pi":0.543,"ll":-732.551090879301,"x":0.543,"y":-732.551090879301},{"pi":0.544,"ll":-733.5607333266655,"x":0.544,"y":-733.5607333266655},{"pi":0.545,"ll":-734.5747659474789,"x":0.545,"y":-734.5747659474789},{"pi":0.546,"ll":-735.5932000736433,"x":0.546,"y":-735.5932000736433},{"pi":0.547,"ll":-736.6160471559876,"x":0.547,"y":-736.6160471559876},{"pi":0.548,"ll":-737.6433187649876,"x":0.548,"y":-737.6433187649876},{"pi":0.549,"ll":-738.6750265914536,"x":0.549,"y":-738.6750265914536},{"pi":0.55,"ll":-739.7111824473716,"x":0.55,"y":-739.7111824473716},{"pi":0.551,"ll":-740.7517982665562,"x":0.551,"y":-740.7517982665562},{"pi":0.552,"ll":-741.7968861055425,"x":0.552,"y":-741.7968861055425},{"pi":0.553,"ll":-742.8464581442915,"x":0.553,"y":-742.8464581442915},{"pi":0.554,"ll":-743.9005266869933,"x":0.554,"y":-743.9005266869933},{"pi":0.555,"ll":-744.9591041628989,"x":0.555,"y":-744.9591041628989},{"pi":0.556,"ll":-746.0222031271292,"x":0.556,"y":-746.0222031271292},{"pi":0.5570000000000001,"ll":-747.0898362615391,"x":0.5570000000000001,"y":-747.0898362615391},{"pi":0.5580000000000001,"ll":-748.1620163754806,"x":0.5580000000000001,"y":-748.1620163754806},{"pi":0.5590000000000001,"ll":-749.2387564067803,"x":0.5590000000000001,"y":-749.2387564067803},{"pi":0.5600000000000001,"ll":-750.3200694224917,"x":0.5600000000000001,"y":-750.3200694224917},{"pi":0.5610000000000001,"ll":-751.4059686198381,"x":0.5610000000000001,"y":-751.4059686198381},{"pi":0.5620000000000001,"ll":-752.4964673271273,"x":0.5620000000000001,"y":-752.4964673271273},{"pi":0.5630000000000001,"ll":-753.5915790046218,"x":0.5630000000000001,"y":-753.5915790046218},{"pi":0.5640000000000001,"ll":-754.6913172454248,"x":0.5640000000000001,"y":-754.6913172454248},{"pi":0.5650000000000001,"ll":-755.7956957765309,"x":0.5650000000000001,"y":-755.7956957765309},{"pi":0.5660000000000001,"ll":-756.9047284596044,"x":0.5660000000000001,"y":-756.9047284596044},{"pi":0.5670000000000001,"ll":-758.0184292921487,"x":0.5670000000000001,"y":-758.0184292921487},{"pi":0.5680000000000001,"ll":-759.1368124082618,"x":0.5680000000000001,"y":-759.1368124082618},{"pi":0.5690000000000001,"ll":-760.2598920797682,"x":0.5690000000000001,"y":-760.2598920797682},{"pi":0.5700000000000001,"ll":-761.3876827172087,"x":0.5700000000000001,"y":-761.3876827172087},{"pi":0.5710000000000001,"ll":-762.520198870812,"x":0.5710000000000001,"y":-762.520198870812},{"pi":0.5720000000000001,"ll":-763.6574552315368,"x":0.5720000000000001,"y":-763.6574552315368},{"pi":0.5730000000000001,"ll":-764.7994666320816,"x":0.5730000000000001,"y":-764.7994666320816},{"pi":0.5740000000000001,"ll":-765.9462480480627,"x":0.5740000000000001,"y":-765.9462480480627},{"pi":0.5750000000000001,"ll":-767.0978145989565,"x":0.5750000000000001,"y":-767.0978145989565},{"pi":0.5760000000000001,"ll":-768.2541815492394,"x":0.5760000000000001,"y":-768.2541815492394},{"pi":0.577,"ll":-769.4153643095316,"x":0.577,"y":-769.4153643095316},{"pi":0.578,"ll":-770.5813784376829,"x":0.578,"y":-770.5813784376829},{"pi":0.579,"ll":-771.7522396398103,"x":0.579,"y":-771.7522396398103},{"pi":0.58,"ll":-772.9279637716534,"x":0.58,"y":-772.9279637716534},{"pi":0.581,"ll":-774.1085668395849,"x":0.581,"y":-774.1085668395849},{"pi":0.582,"ll":-775.2940650018174,"x":0.582,"y":-775.2940650018174},{"pi":0.583,"ll":-776.4844745696972,"x":0.583,"y":-776.4844745696972},{"pi":0.584,"ll":-777.6798120087659,"x":0.584,"y":-777.6798120087659},{"pi":0.585,"ll":-778.880093940106,"x":0.585,"y":-778.880093940106},{"pi":0.586,"ll":-780.0853371415863,"x":0.586,"y":-780.0853371415863},{"pi":0.587,"ll":-781.2955585490532,"x":0.587,"y":-781.2955585490532},{"pi":0.588,"ll":-782.510775257711,"x":0.588,"y":-782.510775257711},{"pi":0.589,"ll":-783.7310045233986,"x":0.589,"y":-783.7310045233986},{"pi":0.59,"ll":-784.9562637637712,"x":0.59,"y":-784.9562637637712},{"pi":0.591,"ll":-786.1865705598906,"x":0.591,"y":-786.1865705598906},{"pi":0.592,"ll":-787.4219426573941,"x":0.592,"y":-787.4219426573941},{"pi":0.593,"ll":-788.6623979678828,"x":0.593,"y":-788.6623979678828},{"pi":0.594,"ll":-789.9079545704468,"x":0.594,"y":-789.9079545704468},{"pi":0.595,"ll":-791.1586307129543,"x":0.595,"y":-791.1586307129543},{"pi":0.596,"ll":-792.4144448134643,"x":0.596,"y":-792.4144448134643},{"pi":0.597,"ll":-793.6754154618104,"x":0.597,"y":-793.6754154618104},{"pi":0.598,"ll":-794.9415614209663,"x":0.598,"y":-794.9415614209663},{"pi":0.599,"ll":-796.2129016285602,"x":0.599,"y":-796.2129016285602},{"pi":0.6,"ll":-797.489455198453,"x":0.6,"y":-797.489455198453},{"pi":0.601,"ll":-798.7712414221834,"x":0.601,"y":-798.7712414221834},{"pi":0.602,"ll":-800.058279770563,"x":0.602,"y":-800.058279770563},{"pi":0.603,"ll":-801.3505898952222,"x":0.603,"y":-801.3505898952222},{"pi":0.604,"ll":-802.6481916303255,"x":0.604,"y":-802.6481916303255},{"pi":0.605,"ll":-803.951104994019,"x":0.605,"y":-803.951104994019},{"pi":0.606,"ll":-805.2593501901893,"x":0.606,"y":-805.2593501901893},{"pi":0.607,"ll":-806.5729476101399,"x":0.607,"y":-806.5729476101399},{"pi":0.608,"ll":-807.8919178341837,"x":0.608,"y":-807.8919178341837},{"pi":0.609,"ll":-809.2162816334875,"x":0.609,"y":-809.2162816334875},{"pi":0.61,"ll":-810.546059971643,"x":0.61,"y":-810.546059971643},{"pi":0.611,"ll":-811.8812740066104,"x":0.611,"y":-811.8812740066104},{"pi":0.612,"ll":-813.2219450923686,"x":0.612,"y":-813.2219450923686},{"pi":0.613,"ll":-814.5680947807591,"x":0.613,"y":-814.5680947807591},{"pi":0.614,"ll":-815.9197448233848,"x":0.614,"y":-815.9197448233848},{"pi":0.615,"ll":-817.2769171733577,"x":0.615,"y":-817.2769171733577},{"pi":0.616,"ll":-818.6396339872828,"x":0.616,"y":-818.6396339872828},{"pi":0.617,"ll":-820.007917627135,"x":0.617,"y":-820.007917627135},{"pi":0.618,"ll":-821.3817906621759,"x":0.618,"y":-821.3817906621759},{"pi":0.619,"ll":-822.7612758709652,"x":0.619,"y":-822.7612758709652},{"pi":0.62,"ll":-824.1463962433368,"x":0.62,"y":-824.1463962433368},{"pi":0.621,"ll":-825.5371749823496,"x":0.621,"y":-825.5371749823496},{"pi":0.622,"ll":-826.9336355065046,"x":0.622,"y":-826.9336355065046},{"pi":0.623,"ll":-828.3358014516763,"x":0.623,"y":-828.3358014516763},{"pi":0.624,"ll":-829.7436966732279,"x":0.624,"y":-829.7436966732279},{"pi":0.625,"ll":-831.1573452482984,"x":0.625,"y":-831.1573452482984},{"pi":0.626,"ll":-832.5767714777304,"x":0.626,"y":-832.5767714777304},{"pi":0.627,"ll":-834.0019998885223,"x":0.627,"y":-834.0019998885223},{"pi":0.628,"ll":-835.4330552358349,"x":0.628,"y":-835.4330552358349},{"pi":0.629,"ll":-836.8699625054402,"x":0.629,"y":-836.8699625054402},{"pi":0.63,"ll":-838.3127469158956,"x":0.63,"y":-838.3127469158956},{"pi":0.631,"ll":-839.7614339209206,"x":0.631,"y":-839.7614339209206},{"pi":0.632,"ll":-841.2160492116685,"x":0.632,"y":-841.2160492116685},{"pi":0.633,"ll":-842.6766187193101,"x":0.633,"y":-842.6766187193101},{"pi":0.634,"ll":-844.1431686172616,"x":0.634,"y":-844.1431686172616},{"pi":0.635,"ll":-845.6157253237615,"x":0.635,"y":-845.6157253237615},{"pi":0.636,"ll":-847.0943155043136,"x":0.636,"y":-847.0943155043136},{"pi":0.637,"ll":-848.5789660742407,"x":0.637,"y":-848.5789660742407},{"pi":0.638,"ll":-850.069704201278,"x":0.638,"y":-850.069704201278},{"pi":0.639,"ll":-851.5665573081823,"x":0.639,"y":-851.5665573081823},{"pi":0.64,"ll":-853.0695530752287,"x":0.64,"y":-853.0695530752287},{"pi":0.641,"ll":-854.5787194431621,"x":0.641,"y":-854.5787194431621},{"pi":0.642,"ll":-856.0940846156834,"x":0.642,"y":-856.0940846156834},{"pi":0.643,"ll":-857.6156770623072,"x":0.643,"y":-857.6156770623072},{"pi":0.644,"ll":-859.1435255211624,"x":0.644,"y":-859.1435255211624},{"pi":0.645,"ll":-860.6776590018497,"x":0.645,"y":-860.6776590018497},{"pi":0.646,"ll":-862.2181067882466,"x":0.646,"y":-862.2181067882466},{"pi":0.647,"ll":-863.7648984415224,"x":0.647,"y":-863.7648984415224},{"pi":0.648,"ll":-865.3180638030813,"x":0.648,"y":-865.3180638030813},{"pi":0.649,"ll":-866.8776329974633,"x":0.649,"y":-866.8776329974633},{"pi":0.65,"ll":-868.4436364356437,"x":0.65,"y":-868.4436364356437},{"pi":0.651,"ll":-870.0161048179225,"x":0.651,"y":-870.0161048179225},{"pi":0.652,"ll":-871.5950691370812,"x":0.652,"y":-871.5950691370812},{"pi":0.653,"ll":-873.1805606817082,"x":0.653,"y":-873.1805606817082},{"pi":0.654,"ll":-874.7726110393675,"x":0.654,"y":-874.7726110393675},{"pi":0.655,"ll":-876.37125209983,"x":0.655,"y":-876.37125209983},{"pi":0.656,"ll":-877.9765160585296,"x":0.656,"y":-877.9765160585296},{"pi":0.657,"ll":-879.5884354198257,"x":0.657,"y":-879.5884354198257},{"pi":0.658,"ll":-881.2070430005734,"x":0.658,"y":-881.2070430005734},{"pi":0.659,"ll":-882.8323719334726,"x":0.659,"y":-882.8323719334726},{"pi":0.66,"ll":-884.4644556707137,"x":0.66,"y":-884.4644556707137},{"pi":0.661,"ll":-886.1033279876086,"x":0.661,"y":-886.1033279876086},{"pi":0.662,"ll":-887.7490229860979,"x":0.662,"y":-887.7490229860979},{"pi":0.663,"ll":-889.4015750985648,"x":0.663,"y":-889.4015750985648},{"pi":0.664,"ll":-891.0610190915725,"x":0.664,"y":-891.0610190915725},{"pi":0.665,"ll":-892.7273900696407,"x":0.665,"y":-892.7273900696407},{"pi":0.666,"ll":-894.400723479274,"x":0.666,"y":-894.400723479274},{"pi":0.667,"ll":-896.0810551126664,"x":0.667,"y":-896.0810551126664},{"pi":0.668,"ll":-897.7684211119434,"x":0.668,"y":-897.7684211119434},{"pi":0.669,"ll":-899.4628579729765,"x":0.669,"y":-899.4628579729765},{"pi":0.67,"ll":-901.1644025497311,"x":0.67,"y":-901.1644025497311},{"pi":0.671,"ll":-902.8730920583081,"x":0.671,"y":-902.8730920583081},{"pi":0.672,"ll":-904.5889640812444,"x":0.672,"y":-904.5889640812444},{"pi":0.673,"ll":-906.312056571883,"x":0.673,"y":-906.312056571883},{"pi":0.674,"ll":-908.0424078585728,"x":0.674,"y":-908.0424078585728},{"pi":0.675,"ll":-909.780056649359,"x":0.675,"y":-909.780056649359},{"pi":0.676,"ll":-911.5250420363648,"x":0.676,"y":-911.5250420363648},{"pi":0.677,"ll":-913.2774035004314,"x":0.677,"y":-913.2774035004314},{"pi":0.678,"ll":-915.0371809157199,"x":0.678,"y":-915.0371809157199},{"pi":0.679,"ll":-916.8044145545138,"x":0.679,"y":-916.8044145545138},{"pi":0.68,"ll":-918.5791450921022,"x":0.68,"y":-918.5791450921022},{"pi":0.681,"ll":-920.3614136114492,"x":0.681,"y":-920.3614136114492},{"pi":0.6820000000000001,"ll":-922.1512616084268,"x":0.6820000000000001,"y":-922.1512616084268},{"pi":0.6830000000000001,"ll":-923.9487309966502,"x":0.6830000000000001,"y":-923.9487309966502},{"pi":0.6840000000000001,"ll":-925.7538641127709,"x":0.6840000000000001,"y":-925.7538641127709},{"pi":0.6850000000000001,"ll":-927.5667037215636,"x":0.6850000000000001,"y":-927.5667037215636},{"pi":0.6860000000000001,"ll":-929.3872930213125,"x":0.6860000000000001,"y":-929.3872930213125},{"pi":0.6870000000000001,"ll":-931.215675649105,"x":0.6870000000000001,"y":-931.215675649105},{"pi":0.6880000000000001,"ll":-933.0518956863601,"x":0.6880000000000001,"y":-933.0518956863601},{"pi":0.6890000000000001,"ll":-934.8959976644287,"x":0.6890000000000001,"y":-934.8959976644287},{"pi":0.6900000000000001,"ll":-936.7480265701089,"x":0.6900000000000001,"y":-936.7480265701089},{"pi":0.6910000000000001,"ll":-938.6080278515068,"x":0.6910000000000001,"y":-938.6080278515068},{"pi":0.6920000000000001,"ll":-940.4760474238475,"x":0.6920000000000001,"y":-940.4760474238475},{"pi":0.6930000000000001,"ll":-942.3521316753552,"x":0.6930000000000001,"y":-942.3521316753552},{"pi":0.6940000000000001,"ll":-944.2363274733092,"x":0.6940000000000001,"y":-944.2363274733092},{"pi":0.6950000000000001,"ll":-946.1286821702348,"x":0.6950000000000001,"y":-946.1286821702348},{"pi":0.6960000000000001,"ll":-948.0292436099425,"x":0.6960000000000001,"y":-948.0292436099425},{"pi":0.6970000000000001,"ll":-949.9380601341624,"x":0.6970000000000001,"y":-949.9380601341624},{"pi":0.6980000000000001,"ll":-951.8551805887203,"x":0.6980000000000001,"y":-951.8551805887203},{"pi":0.6990000000000001,"ll":-953.7806543301749,"x":0.6990000000000001,"y":-953.7806543301749},{"pi":0.7000000000000001,"ll":-955.7145312325024,"x":0.7000000000000001,"y":-955.7145312325024},{"pi":0.7010000000000001,"ll":-957.6568616937823,"x":0.7010000000000001,"y":-957.6568616937823},{"pi":0.7020000000000001,"ll":-959.6076966432431,"x":0.7020000000000001,"y":-959.6076966432431},{"pi":0.7030000000000001,"ll":-961.567087548088,"x":0.7030000000000001,"y":-961.567087548088},{"pi":0.704,"ll":-963.5350864207137,"x":0.704,"y":-963.5350864207137},{"pi":0.705,"ll":-965.5117458258917,"x":0.705,"y":-965.5117458258917},{"pi":0.706,"ll":-967.4971188881791,"x":0.706,"y":-967.4971188881791},{"pi":0.707,"ll":-969.4912592993653,"x":0.707,"y":-969.4912592993653},{"pi":0.708,"ll":-971.4942213261879,"x":0.708,"y":-971.4942213261879},{"pi":0.709,"ll":-973.5060598179952,"x":0.709,"y":-973.5060598179952},{"pi":0.71,"ll":-975.5268302145502,"x":0.71,"y":-975.5268302145502},{"pi":0.711,"ll":-977.5565885542863,"x":0.711,"y":-977.5565885542863},{"pi":0.712,"ll":-979.5953914823294,"x":0.712,"y":-979.5953914823294},{"pi":0.713,"ll":-981.6432962587101,"x":0.713,"y":-981.6432962587101},{"pi":0.714,"ll":-983.7003607669993,"x":0.714,"y":-983.7003607669993},{"pi":0.715,"ll":-985.7666435228589,"x":0.715,"y":-985.7666435228589},{"pi":0.716,"ll":-987.8422036827073,"x":0.716,"y":-987.8422036827073},{"pi":0.717,"ll":-989.9271010526996,"x":0.717,"y":-989.9271010526996},{"pi":0.718,"ll":-992.0213960977803,"x":0.718,"y":-992.0213960977803},{"pi":0.719,"ll":-994.125149950931,"x":0.719,"y":-994.125149950931},{"pi":0.72,"ll":-996.2384244225195,"x":0.72,"y":-996.2384244225195},{"pi":0.721,"ll":-998.3612820099432,"x":0.721,"y":-998.3612820099432},{"pi":0.722,"ll":-1000.493785907264,"x":0.722,"y":-1000.493785907264},{"pi":0.723,"ll":-1002.636000015164,"x":0.723,"y":-1002.636000015164},{"pi":0.724,"ll":-1004.787988951108,"x":0.724,"y":-1004.787988951108},{"pi":0.725,"ll":-1006.949818059468,"x":0.725,"y":-1006.949818059468},{"pi":0.726,"ll":-1009.121553422127,"x":0.726,"y":-1009.121553422127},{"pi":0.727,"ll":-1011.303261869032,"x":0.727,"y":-1011.303261869032},{"pi":0.728,"ll":-1013.495010989243,"x":0.728,"y":-1013.495010989243},{"pi":0.729,"ll":-1015.696869141637,"x":0.729,"y":-1015.696869141637},{"pi":0.73,"ll":-1017.908905466559,"x":0.73,"y":-1017.908905466559},{"pi":0.731,"ll":-1020.131189896965,"x":0.731,"y":-1020.131189896965},{"pi":0.732,"ll":-1022.363793170306,"x":0.732,"y":-1022.363793170306},{"pi":0.733,"ll":-1024.606786840388,"x":0.733,"y":-1024.606786840388},{"pi":0.734,"ll":-1026.860243289412,"x":0.734,"y":-1026.860243289412},{"pi":0.735,"ll":-1029.124235740522,"x":0.735,"y":-1029.124235740522},{"pi":0.736,"ll":-1031.398838270134,"x":0.736,"y":-1031.398838270134},{"pi":0.737,"ll":-1033.684125820972,"x":0.737,"y":-1033.684125820972},{"pi":0.738,"ll":-1035.980174215098,"x":0.738,"y":-1035.980174215098},{"pi":0.739,"ll":-1038.287060167169,"x":0.739,"y":-1038.287060167169},{"pi":0.74,"ll":-1040.604861298071,"x":0.74,"y":-1040.604861298071},{"pi":0.741,"ll":-1042.933656148793,"x":0.741,"y":-1042.933656148793},{"pi":0.742,"ll":-1045.273524194503,"x":0.742,"y":-1045.273524194503},{"pi":0.743,"ll":-1047.624545858903,"x":0.743,"y":-1047.624545858903},{"pi":0.744,"ll":-1049.986802528981,"x":0.744,"y":-1049.986802528981},{"pi":0.745,"ll":-1052.360376569927,"x":0.745,"y":-1052.360376569927},{"pi":0.746,"ll":-1054.74535134032,"x":0.746,"y":-1054.74535134032},{"pi":0.747,"ll":-1057.14181120786,"x":0.747,"y":-1057.14181120786},{"pi":0.748,"ll":-1059.549841565042,"x":0.748,"y":-1059.549841565042},{"pi":0.749,"ll":-1061.9695288454,"x":0.749,"y":-1061.9695288454},{"pi":0.75,"ll":-1064.400960540128,"x":0.75,"y":-1064.400960540128},{"pi":0.751,"ll":-1066.844225214699,"x":0.751,"y":-1066.844225214699},{"pi":0.752,"ll":-1069.299412526178,"x":0.752,"y":-1069.299412526178},{"pi":0.753,"ll":-1071.766613240804,"x":0.753,"y":-1071.766613240804},{"pi":0.754,"ll":-1074.245919251621,"x":0.754,"y":-1074.245919251621},{"pi":0.755,"ll":-1076.73742359704,"x":0.755,"y":-1076.73742359704},{"pi":0.756,"ll":-1079.241220479235,"x":0.756,"y":-1079.241220479235},{"pi":0.757,"ll":-1081.75740528321,"x":0.757,"y":-1081.75740528321},{"pi":0.758,"ll":-1084.286074596137,"x":0.758,"y":-1084.286074596137},{"pi":0.759,"ll":-1086.827326227309,"x":0.759,"y":-1086.827326227309},{"pi":0.76,"ll":-1089.381259228192,"x":0.76,"y":-1089.381259228192},{"pi":0.761,"ll":-1091.947973913087,"x":0.761,"y":-1091.947973913087},{"pi":0.762,"ll":-1094.52757188021,"x":0.762,"y":-1094.52757188021},{"pi":0.763,"ll":-1097.120156033257,"x":0.763,"y":-1097.120156033257},{"pi":0.764,"ll":-1099.725830603236,"x":0.764,"y":-1099.725830603236},{"pi":0.765,"ll":-1102.344701171043,"x":0.765,"y":-1102.344701171043},{"pi":0.766,"ll":-1104.976874690243,"x":0.766,"y":-1104.976874690243},{"pi":0.767,"ll":-1107.622459510596,"x":0.767,"y":-1107.622459510596},{"pi":0.768,"ll":-1110.281565401802,"x":0.768,"y":-1110.281565401802},{"pi":0.769,"ll":-1112.954303578073,"x":0.769,"y":-1112.954303578073},{"pi":0.77,"ll":-1115.640786723043,"x":0.77,"y":-1115.640786723043},{"pi":0.771,"ll":-1118.341129015248,"x":0.771,"y":-1118.341129015248},{"pi":0.772,"ll":-1121.055446154111,"x":0.772,"y":-1121.055446154111},{"pi":0.773,"ll":-1123.783855386673,"x":0.773,"y":-1123.783855386673},{"pi":0.774,"ll":-1126.526475534842,"x":0.774,"y":-1126.526475534842},{"pi":0.775,"ll":-1129.28342702309,"x":0.775,"y":-1129.28342702309},{"pi":0.776,"ll":-1132.054831906956,"x":0.776,"y":-1132.054831906956},{"pi":0.777,"ll":-1134.840813902116,"x":0.777,"y":-1134.840813902116},{"pi":0.778,"ll":-1137.641498414191,"x":0.778,"y":-1137.641498414191},{"pi":0.779,"ll":-1140.457012568951,"x":0.779,"y":-1140.457012568951},{"pi":0.78,"ll":-1143.287485243701,"x":0.78,"y":-1143.287485243701},{"pi":0.781,"ll":-1146.133047098842,"x":0.781,"y":-1146.133047098842},{"pi":0.782,"ll":-1148.993830610473,"x":0.782,"y":-1148.993830610473},{"pi":0.783,"ll":-1151.86997010373,"x":0.783,"y":-1151.86997010373},{"pi":0.784,"ll":-1154.761601786755,"x":0.784,"y":-1154.761601786755},{"pi":0.785,"ll":-1157.668863785643,"x":0.785,"y":-1157.668863785643},{"pi":0.786,"ll":-1160.591896179918,"x":0.786,"y":-1160.591896179918},{"pi":0.787,"ll":-1163.530841039267,"x":0.787,"y":-1163.530841039267},{"pi":0.788,"ll":-1166.485842460682,"x":0.788,"y":-1166.485842460682},{"pi":0.789,"ll":-1169.457046606717,"x":0.789,"y":-1169.457046606717},{"pi":0.79,"ll":-1172.444601744783,"x":0.79,"y":-1172.444601744783},{"pi":0.791,"ll":-1175.448658287093,"x":0.791,"y":-1175.448658287093},{"pi":0.792,"ll":-1178.469368831685,"x":0.792,"y":-1178.469368831685},{"pi":0.793,"ll":-1181.506888204502,"x":0.793,"y":-1181.506888204502},{"pi":0.794,"ll":-1184.561373502486,"x":0.794,"y":-1184.561373502486},{"pi":0.795,"ll":-1187.632984137541,"x":0.795,"y":-1187.632984137541},{"pi":0.796,"ll":-1190.721881881871,"x":0.796,"y":-1190.721881881871},{"pi":0.797,"ll":-1193.82823091406,"x":0.797,"y":-1193.82823091406},{"pi":0.798,"ll":-1196.952197866675,"x":0.798,"y":-1196.952197866675},{"pi":0.799,"ll":-1200.093951874852,"x":0.799,"y":-1200.093951874852},{"pi":0.8,"ll":-1203.253664625983,"x":0.8,"y":-1203.253664625983},{"pi":0.801,"ll":-1206.431510410875,"x":0.801,"y":-1206.431510410875},{"pi":0.802,"ll":-1209.627666176201,"x":0.802,"y":-1209.627666176201},{"pi":0.803,"ll":-1212.842311577982,"x":0.803,"y":-1212.842311577982},{"pi":0.804,"ll":-1216.075629036722,"x":0.804,"y":-1216.075629036722},{"pi":0.805,"ll":-1219.327803793935,"x":0.805,"y":-1219.327803793935},{"pi":0.806,"ll":-1222.599023969921,"x":0.806,"y":-1222.599023969921},{"pi":0.8070000000000001,"ll":-1225.889480623261,"x":0.8070000000000001,"y":-1225.889480623261},{"pi":0.8080000000000001,"ll":-1229.199367811809,"x":0.8080000000000001,"y":-1229.199367811809},{"pi":0.8090000000000001,"ll":-1232.528882655044,"x":0.8090000000000001,"y":-1232.528882655044},{"pi":0.8100000000000001,"ll":-1235.878225398377,"x":0.8100000000000001,"y":-1235.878225398377},{"pi":0.8110000000000001,"ll":-1239.247599479178,"x":0.8110000000000001,"y":-1239.247599479178},{"pi":0.8120000000000001,"ll":-1242.637211594005,"x":0.8120000000000001,"y":-1242.637211594005},{"pi":0.8130000000000001,"ll":-1246.047271768418,"x":0.8130000000000001,"y":-1246.047271768418},{"pi":0.8140000000000001,"ll":-1249.47799342817,"x":0.8140000000000001,"y":-1249.47799342817},{"pi":0.8150000000000001,"ll":-1252.929593472185,"x":0.8150000000000001,"y":-1252.929593472185},{"pi":0.8160000000000001,"ll":-1256.402292348104,"x":0.8160000000000001,"y":-1256.402292348104},{"pi":0.8170000000000001,"ll":-1259.896314129288,"x":0.8170000000000001,"y":-1259.896314129288},{"pi":0.8180000000000001,"ll":-1263.411886594238,"x":0.8180000000000001,"y":-1263.411886594238},{"pi":0.8190000000000001,"ll":-1266.949241308238,"x":0.8190000000000001,"y":-1266.949241308238},{"pi":0.8200000000000001,"ll":-1270.508613707076,"x":0.8200000000000001,"y":-1270.508613707076},{"pi":0.8210000000000001,"ll":-1274.090243183166,"x":0.8210000000000001,"y":-1274.090243183166},{"pi":0.8220000000000001,"ll":-1277.694373174165,"x":0.8220000000000001,"y":-1277.694373174165},{"pi":0.8230000000000001,"ll":-1281.321251254062,"x":0.8230000000000001,"y":-1281.321251254062},{"pi":0.8240000000000001,"ll":-1284.971129226688,"x":0.8240000000000001,"y":-1284.971129226688},{"pi":0.8250000000000001,"ll":-1288.644263222143,"x":0.8250000000000001,"y":-1288.644263222143},{"pi":0.8260000000000001,"ll":-1292.340913795828,"x":0.8260000000000001,"y":-1292.340913795828},{"pi":0.8270000000000001,"ll":-1296.061346030254,"x":0.8270000000000001,"y":-1296.061346030254},{"pi":0.8280000000000001,"ll":-1299.805829640132,"x":0.8280000000000001,"y":-1299.805829640132},{"pi":0.8290000000000001,"ll":-1303.574639080126,"x":0.8290000000000001,"y":-1303.574639080126},{"pi":0.8300000000000001,"ll":-1307.368053655941,"x":0.8300000000000001,"y":-1307.368053655941},{"pi":0.8310000000000001,"ll":-1311.186357638882,"x":0.8310000000000001,"y":-1311.186357638882},{"pi":0.8320000000000001,"ll":-1315.029840383428,"x":0.8320000000000001,"y":-1315.029840383428},{"pi":0.833,"ll":-1318.89879644861,"x":0.833,"y":-1318.89879644861},{"pi":0.834,"ll":-1322.793525722967,"x":0.834,"y":-1322.793525722967},{"pi":0.835,"ll":-1326.714333553138,"x":0.835,"y":-1326.714333553138},{"pi":0.836,"ll":-1330.661530876617,"x":0.836,"y":-1330.661530876617},{"pi":0.837,"ll":-1334.635434358329,"x":0.837,"y":-1334.635434358329},{"pi":0.838,"ll":-1338.63636653159,"x":0.838,"y":-1338.63636653159},{"pi":0.839,"ll":-1342.664655943226,"x":0.839,"y":-1342.664655943226},{"pi":0.84,"ll":-1346.720637303463,"x":0.84,"y":-1346.720637303463},{"pi":0.841,"ll":-1350.804651640381,"x":0.841,"y":-1350.804651640381},{"pi":0.842,"ll":-1354.917046459072,"x":0.842,"y":-1354.917046459072},{"pi":0.843,"ll":-1359.058175906345,"x":0.843,"y":-1359.058175906345},{"pi":0.844,"ll":-1363.228400940072,"x":0.844,"y":-1363.228400940072},{"pi":0.845,"ll":-1367.428089504585,"x":0.845,"y":-1367.428089504585},{"pi":0.846,"ll":-1371.657616711072,"x":0.846,"y":-1371.657616711072},{"pi":0.847,"ll":-1375.91736502462,"x":0.847,"y":-1375.91736502462},{"pi":0.848,"ll":-1380.207724456788,"x":0.848,"y":-1380.207724456788},{"pi":0.849,"ll":-1384.529092764751,"x":0.849,"y":-1384.529092764751},{"pi":0.85,"ll":-1388.88187565716,"x":0.85,"y":-1388.88187565716},{"pi":0.851,"ll":-1393.266487006692,"x":0.851,"y":-1393.266487006692},{"pi":0.852,"ll":-1397.683349069921,"x":0.852,"y":-1397.683349069921},{"pi":0.853,"ll":-1402.13289271451,"x":0.853,"y":-1402.13289271451},{"pi":0.854,"ll":-1406.615557654271,"x":0.854,"y":-1406.615557654271},{"pi":0.855,"ll":-1411.131792692313,"x":0.855,"y":-1411.131792692313},{"pi":0.856,"ll":-1415.682055972369,"x":0.856,"y":-1415.682055972369},{"pi":0.857,"ll":-1420.266815239243,"x":0.857,"y":-1420.266815239243},{"pi":0.858,"ll":-1424.88654810809,"x":0.858,"y":-1424.88654810809},{"pi":0.859,"ll":-1429.54174234341,"x":0.859,"y":-1429.54174234341},{"pi":0.86,"ll":-1434.232896147834,"x":0.86,"y":-1434.232896147834},{"pi":0.861,"ll":-1438.960518461424,"x":0.861,"y":-1438.960518461424},{"pi":0.862,"ll":-1443.725129271546,"x":0.862,"y":-1443.725129271546},{"pi":0.863,"ll":-1448.52725993421,"x":0.863,"y":-1448.52725993421},{"pi":0.864,"ll":-1453.367453507141,"x":0.864,"y":-1453.367453507141},{"pi":0.865,"ll":-1458.246265095128,"x":0.865,"y":-1458.246265095128},{"pi":0.866,"ll":-1463.164262208033,"x":0.866,"y":-1463.164262208033},{"pi":0.867,"ll":-1468.122025132637,"x":0.867,"y":-1468.122025132637},{"pi":0.868,"ll":-1473.120147318097,"x":0.868,"y":-1473.120147318097},{"pi":0.869,"ll":-1478.159235776146,"x":0.869,"y":-1478.159235776146},{"pi":0.87,"ll":-1483.239911497001,"x":0.87,"y":-1483.239911497001},{"pi":0.871,"ll":-1488.362809880666,"x":0.871,"y":-1488.362809880666},{"pi":0.872,"ll":-1493.528581185651,"x":0.872,"y":-1493.528581185651},{"pi":0.873,"ll":-1498.73789099489,"x":0.873,"y":-1498.73789099489},{"pi":0.874,"ll":-1503.991420700373,"x":0.874,"y":-1503.991420700373},{"pi":0.875,"ll":-1509.289868006627,"x":0.875,"y":-1509.289868006627},{"pi":0.876,"ll":-1514.633947454983,"x":0.876,"y":-1514.633947454983},{"pi":0.877,"ll":-1520.024390968792,"x":0.877,"y":-1520.024390968792},{"pi":0.878,"ll":-1525.461948420633,"x":0.878,"y":-1525.461948420633},{"pi":0.879,"ll":-1530.94738822348,"x":0.879,"y":-1530.94738822348},{"pi":0.88,"ll":-1536.481497945877,"x":0.88,"y":-1536.481497945877},{"pi":0.881,"ll":-1542.065084952983,"x":0.881,"y":-1542.065084952983},{"pi":0.882,"ll":-1547.698977074936,"x":0.882,"y":-1547.698977074936},{"pi":0.883,"ll":-1553.384023303179,"x":0.883,"y":-1553.384023303179},{"pi":0.884,"ll":-1559.121094517087,"x":0.884,"y":-1559.121094517087},{"pi":0.885,"ll":-1564.911084241976,"x":0.885,"y":-1564.911084241976},{"pi":0.886,"ll":-1570.754909439942,"x":0.886,"y":-1570.754909439942},{"pi":0.887,"ll":-1576.653511335794,"x":0.887,"y":-1576.653511335794},{"pi":0.888,"ll":-1582.607856279789,"x":0.888,"y":-1582.607856279789},{"pi":0.889,"ll":-1588.618936648752,"x":0.889,"y":-1588.618936648752},{"pi":0.89,"ll":-1594.6877717881,"x":0.89,"y":-1594.6877717881},{"pi":0.891,"ll":-1600.815408997204,"x":0.891,"y":-1600.815408997204},{"pi":0.892,"ll":-1607.002924559387,"x":0.892,"y":-1607.002924559387},{"pi":0.893,"ll":-1613.251424820754,"x":0.893,"y":-1613.251424820754},{"pi":0.894,"ll":-1619.56204731905,"x":0.894,"y":-1619.56204731905},{"pi":0.895,"ll":-1625.935961966239,"x":0.895,"y":-1625.935961966239},{"pi":0.896,"ll":-1632.37437228753,"x":0.896,"y":-1632.37437228753},{"pi":0.897,"ll":-1638.878516720568,"x":0.897,"y":-1638.878516720568},{"pi":0.898,"ll":-1645.449669977625,"x":0.898,"y":-1645.449669977625},{"pi":0.899,"ll":-1652.089144475166,"x":0.899,"y":-1652.089144475166},{"pi":0.9,"ll":-1658.798291834557,"x":0.9,"y":-1658.798291834557},{"pi":0.901,"ll":-1665.578504457723,"x":0.901,"y":-1665.578504457723},{"pi":0.902,"ll":-1672.431217183679,"x":0.902,"y":-1672.431217183679},{"pi":0.903,"ll":-1679.357909029073,"x":0.903,"y":-1679.357909029073},{"pi":0.904,"ll":-1686.360105019495,"x":0.904,"y":-1686.360105019495},{"pi":0.905,"ll":-1693.439378116475,"x":0.905,"y":-1693.439378116475},{"pi":0.906,"ll":-1700.597351246643,"x":0.906,"y":-1700.597351246643},{"pi":0.907,"ll":-1707.835699439043,"x":0.907,"y":-1707.835699439043},{"pi":0.908,"ll":-1715.156152078257,"x":0.908,"y":-1715.156152078257},{"pi":0.909,"ll":-1722.560495280743,"x":0.909,"y":-1722.560495280743},{"pi":0.91,"ll":-1730.050574401966,"x":0.91,"y":-1730.050574401966},{"pi":0.911,"ll":-1737.628296684367,"x":0.911,"y":-1737.628296684367},{"pi":0.912,"ll":-1745.295634054256,"x":0.912,"y":-1745.295634054256},{"pi":0.913,"ll":-1753.054626079029,"x":0.913,"y":-1753.054626079029},{"pi":0.914,"ll":-1760.907383094835,"x":0.914,"y":-1760.907383094835},{"pi":0.915,"ll":-1768.85608951779,"x":0.915,"y":-1768.85608951779},{"pi":0.916,"ll":-1776.903007350409,"x":0.916,"y":-1776.903007350409},{"pi":0.917,"ll":-1785.050479898789,"x":0.917,"y":-1785.050479898789},{"pi":0.918,"ll":-1793.300935714472,"x":0.918,"y":-1793.300935714472},{"pi":0.919,"ll":-1801.656892778536,"x":0.919,"y":-1801.656892778536},{"pi":0.92,"ll":-1810.120962945067,"x":0.92,"y":-1810.120962945067},{"pi":0.921,"ll":-1818.695856665121,"x":0.921,"y":-1818.695856665121},{"pi":0.922,"ll":-1827.384388010488,"x":0.922,"y":-1827.384388010488},{"pi":0.923,"ll":-1836.189480022232,"x":0.923,"y":-1836.189480022232},{"pi":0.924,"ll":-1845.114170408709,"x":0.924,"y":-1845.114170408709},{"pi":0.925,"ll":-1854.161617620809,"x":0.925,"y":-1854.161617620809},{"pi":0.926,"ll":-1863.335107335502,"x":0.926,"y":-1863.335107335502},{"pi":0.927,"ll":-1872.638059379432,"x":0.927,"y":-1872.638059379432},{"pi":0.928,"ll":-1882.0740351314,"x":0.928,"y":-1882.0740351314},{"pi":0.929,"ll":-1891.646745441486,"x":0.929,"y":-1891.646745441486},{"pi":0.93,"ll":-1901.360059112127,"x":0.93,"y":-1901.360059112127},{"pi":0.931,"ll":-1911.218011989713,"x":0.931,"y":-1911.218011989713},{"pi":0.9320000000000001,"ll":-1921.224816719737,"x":0.9320000000000001,"y":-1921.224816719737},{"pi":0.9330000000000001,"ll":-1931.384873224436,"x":0.9330000000000001,"y":-1931.384873224436},{"pi":0.9340000000000001,"ll":-1941.702779968404,"x":0.9340000000000001,"y":-1941.702779968404},{"pi":0.9350000000000001,"ll":-1952.183346084322,"x":0.9350000000000001,"y":-1952.183346084322},{"pi":0.9360000000000001,"ll":-1962.831604438885,"x":0.9360000000000001,"y":-1962.831604438885},{"pi":0.9370000000000001,"ll":-1973.652825727497,"x":0.9370000000000001,"y":-1973.652825727497},{"pi":0.9380000000000001,"ll":-1984.652533696457,"x":0.9380000000000001,"y":-1984.652533696457},{"pi":0.9390000000000001,"ll":-1995.83652160361,"x":0.9390000000000001,"y":-1995.83652160361},{"pi":0.9400000000000001,"ll":-2007.210870038719,"x":0.9400000000000001,"y":-2007.210870038719},{"pi":0.9410000000000001,"ll":-2018.781966242268,"x":0.9410000000000001,"y":-2018.781966242268},{"pi":0.9420000000000001,"ll":-2030.55652507492,"x":0.9420000000000001,"y":-2030.55652507492},{"pi":0.9430000000000001,"ll":-2042.541611811509,"x":0.9430000000000001,"y":-2042.541611811509},{"pi":0.9440000000000001,"ll":-2054.744666951728,"x":0.9440000000000001,"y":-2054.744666951728},{"pi":0.9450000000000001,"ll":-2067.173533267119,"x":0.9450000000000001,"y":-2067.173533267119},{"pi":0.9460000000000001,"ll":-2079.836485328986,"x":0.9460000000000001,"y":-2079.836485328986},{"pi":0.9470000000000001,"ll":-2092.742261797242,"x":0.9470000000000001,"y":-2092.742261797242},{"pi":0.9480000000000001,"ll":-2105.900100784346,"x":0.9480000000000001,"y":-2105.900100784346},{"pi":0.9490000000000001,"ll":-2119.319778653335,"x":0.9490000000000001,"y":-2119.319778653335},{"pi":0.9500000000000001,"ll":-2133.011652658241,"x":0.9500000000000001,"y":-2133.011652658241},{"pi":0.9510000000000001,"ll":-2146.986707892087,"x":0.9510000000000001,"y":-2146.986707892087},{"pi":0.9520000000000001,"ll":-2161.256609076414,"x":0.9520000000000001,"y":-2161.256609076414},{"pi":0.9530000000000001,"ll":-2175.833757802434,"x":0.9530000000000001,"y":-2175.833757802434},{"pi":0.9540000000000001,"ll":-2190.73135592998,"x":0.9540000000000001,"y":-2190.73135592998},{"pi":0.9550000000000001,"ll":-2205.96347595369,"x":0.9550000000000001,"y":-2205.96347595369},{"pi":0.9560000000000001,"ll":-2221.545139277921,"x":0.9560000000000001,"y":-2221.545139277921},{"pi":0.9570000000000001,"ll":-2237.492403491096,"x":0.9570000000000001,"y":-2237.492403491096},{"pi":0.9580000000000001,"ll":-2253.822459910346,"x":0.9580000000000001,"y":-2253.822459910346},{"pi":0.9590000000000001,"ll":-2270.553742881306,"x":0.9590000000000001,"y":-2270.553742881306},{"pi":0.96,"ll":-2287.706052576259,"x":0.96,"y":-2287.706052576259},{"pi":0.961,"ll":-2305.300693340177,"x":0.961,"y":-2305.300693340177},{"pi":0.962,"ll":-2323.360630010524,"x":0.962,"y":-2323.360630010524},{"pi":0.963,"ll":-2341.910665085849,"x":0.963,"y":-2341.910665085849},{"pi":0.964,"ll":-2360.97764017281,"x":0.964,"y":-2360.97764017281},{"pi":0.965,"ll":-2380.590665816818,"x":0.965,"y":-2380.590665816818},{"pi":0.966,"ll":-2400.781384654253,"x":0.966,"y":-2400.781384654253},{"pi":0.967,"ll":-2421.584273857515,"x":0.967,"y":-2421.584273857515},{"pi":0.968,"ll":-2443.036994130688,"x":0.968,"y":-2443.036994130688},{"pi":0.969,"ll":-2465.180794127168,"x":0.969,"y":-2465.180794127168},{"pi":0.97,"ll":-2488.060981198224,"x":0.97,"y":-2488.060981198224},{"pi":0.971,"ll":-2511.72747197235,"x":0.971,"y":-2511.72747197235},{"pi":0.972,"ll":-2536.235439581367,"x":0.972,"y":-2536.235439581367},{"pi":0.973,"ll":-2561.646078636581,"x":0.973,"y":-2561.646078636581},{"pi":0.974,"ll":-2588.02751463365,"x":0.974,"y":-2588.02751463365},{"pi":0.975,"ll":-2615.455891797975,"x":0.975,"y":-2615.455891797975},{"pi":0.976,"ll":-2644.016683107124,"x":0.976,"y":-2644.016683107124},{"pi":0.977,"ll":-2673.80627927172,"x":0.977,"y":-2673.80627927172},{"pi":0.978,"ll":-2704.93393113758,"x":0.978,"y":-2704.93393113758},{"pi":0.979,"ll":-2737.524144250228,"x":0.979,"y":-2737.524144250228},{"pi":0.98,"ll":-2771.719658081748,"x":0.98,"y":-2771.719658081748},{"pi":0.981,"ll":-2807.685190058818,"x":0.981,"y":-2807.685190058818},{"pi":0.982,"ll":-2845.612192801654,"x":0.982,"y":-2845.612192801654},{"pi":0.983,"ll":-2885.724972531273,"x":0.983,"y":-2885.724972531273},{"pi":0.984,"ll":-2928.288664522267,"x":0.984,"y":-2928.288664522267},{"pi":0.985,"ll":-2973.619785939492,"x":0.985,"y":-2973.619785939492},{"pi":0.986,"ll":-3022.100435045619,"x":0.986,"y":-3022.100435045619},{"pi":0.987,"ll":-3074.19776170283,"x":0.987,"y":-3074.19776170283},{"pi":0.988,"ll":-3130.491247141865,"x":0.988,"y":-3130.491247141865},{"pi":0.989,"ll":-3191.711881948252,"x":0.989,"y":-3191.711881948252},{"pi":0.99,"ll":-3258.800069898709,"x":0.99,"y":-3258.800069898709},{"pi":0.991,"ll":-3332.994144246744,"x":0.991,"y":-3332.994144246744},{"pi":0.992,"ll":-3415.971238580049,"x":0.992,"y":-3415.971238580049},{"pi":0.993,"ll":-3510.082719034866,"x":0.993,"y":-3510.082719034866},{"pi":0.994,"ll":-3618.772332687592,"x":0.994,"y":-3618.772332687592},{"pi":0.995,"ll":-3747.379052903707,"x":0.995,"y":-3747.379052903707},{"pi":0.996,"ll":-3904.847219198152,"x":0.996,"y":-3904.847219198152},{"pi":0.997,"ll":-4107.94441529489,"x":0.997,"y":-4107.94441529489},{"pi":0.998,"ll":-4394.314512366921,"x":0.998,"y":-4394.314512366921},{"pi":0.999,"ll":-4884.076128838151,"x":0.999,"y":-4884.076128838151},{"pi":1,"ll":null,"x":1,"y":null}],"type":"line"}],"xAxis":{"title":{"text":"Pi"},"plotLines":[{"color":"red","value":0.293}]},"legend":{"enabled":false},"colors":["#005A43","#6CC24A","#A7DA92","#BDBEBD","#000000"]},"theme":{"chart":{"backgroundColor":"transparent"},"colors":["#7cb5ec","#434348","#90ed7d","#f7a35c","#8085e9","#f15c80","#e4d354","#2b908f","#f45b5b","#91e8e1"]},"conf_opts":{"global":{"Date":null,"VMLRadialGradientURL":"http =//code.highcharts.com/list(version)/gfx/vml-radial-gradient.png","canvasToolsURL":"http =//code.highcharts.com/list(version)/modules/canvas-tools.js","getTimezoneOffset":null,"timezoneOffset":0,"useUTC":true},"lang":{"contextButtonTitle":"Chart context menu","decimalPoint":".","downloadCSV":"Download CSV","downloadJPEG":"Download JPEG image","downloadPDF":"Download PDF document","downloadPNG":"Download PNG image","downloadSVG":"Download SVG vector image","downloadXLS":"Download XLS","drillUpText":"◁ Back to {series.name}","exitFullscreen":"Exit from full screen","exportData":{"annotationHeader":"Annotations","categoryDatetimeHeader":"DateTime","categoryHeader":"Category"},"hideData":"Hide data table","invalidDate":null,"loading":"Loading...","months":["January","February","March","April","May","June","July","August","September","October","November","December"],"noData":"No data to display","numericSymbolMagnitude":1000,"numericSymbols":["k","M","G","T","P","E"],"printChart":"Print chart","resetZoom":"Reset zoom","resetZoomTitle":"Reset zoom level 1:1","shortMonths":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"shortWeekdays":["Sat","Sun","Mon","Tue","Wed","Thu","Fri"],"thousandsSep":" ","viewData":"View data table","viewFullscreen":"View in full screen","weekdays":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]}},"type":"chart","fonts":[],"debug":false},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="newton-raphson" class="level3">
<h3 class="anchored" data-anchor-id="newton-raphson">Newton-Raphson</h3>
<p>There are lots of ways to optimize a function - in statistical software, most of them derive from Newton’s iterative method. A very common algorithm is the Newton-Raphson method. This is what <code>maxlik</code> used in the example above. Newton-Raphson is an iterative process that starts with an initial guess for the parameter <span class="math inline">\(\pi\)</span> and updates it in the direction of the maximum until it converges to the maximum. At each step, it computes the first and second derivatives of the likelihood function, then uses these to update the parameter estimate. The update rule is:</p>
<p><span class="math display">\[ \pi_{new} = \pi_{old} - \frac{g(\pi)}{H(\pi)} \]</span></p>
<p>So the new estimate of the parameter is the old estimate minus the first derivative (gradient) of the log-likelihood function divided by the Hessian (second derivative) of the log-likelihood function. Here, <span class="math inline">\(g(\pi)\)</span> is the gradient of the log-likelihood function and <span class="math inline">\(H(\pi)\)</span> is the Hessian of the log-likelihood function. The algorithm iterates this process until the change in <span class="math inline">\(\pi\)</span> is sufficiently small, below a specified threshold.</p>
<p>Let’s write the Newton-Raphson algorithm ourselves:</p>
</section>
<section id="programming-newton-raphson" class="level3">
<h3 class="anchored" data-anchor-id="programming-newton-raphson">Programming Newton-Raphson</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># use same data generated above; same LLF as above, aiming to recover pi</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co">#write the gradient - matrix of partial first derivatives of the log-likelihood function.</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>gradient <span class="ot">&lt;-</span> <span class="cf">function</span>(pi, y) {</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(y <span class="sc">/</span> pi <span class="sc">-</span> (<span class="dv">1</span> <span class="sc">-</span> y) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> pi))</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co">#write the Hessian - matrix of partial second derivatives of the log-likelihood function.</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>hessian <span class="ot">&lt;-</span> <span class="cf">function</span>(pi, y) {</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(<span class="sc">-</span>y <span class="sc">/</span> pi<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> (<span class="dv">1</span> <span class="sc">-</span> y) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> pi)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="co">#declare a starting value for pi</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>pi <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="co">#set convergence criteria - when new pi is within 1e-6 of old pi, stop iterating</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>tol <span class="ot">&lt;-</span> <span class="fl">1e-6</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a><span class="co">#initialize iteration counter, set maximum iterations; how many times will we do this before we stop if we don't converge prior? </span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>iter <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>max_iter <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a><span class="co">#iterate the Newton-Raphson algorithm</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (iter <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>max_iter) {</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute gradient  </span></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>  grad <span class="ot">&lt;-</span> <span class="fu">gradient</span>(pi, y)</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute Hessian</span></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>  hess <span class="ot">&lt;-</span> <span class="fu">hessian</span>(pi, y)</span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Update pi</span></span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>  pi_new <span class="ot">&lt;-</span> pi <span class="sc">-</span> (grad <span class="sc">/</span> hess)</span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>  pi <span class="ot">&lt;-</span> pi_new</span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Check for convergence</span></span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">abs</span>(pi_new <span class="sc">-</span> pi) <span class="sc">&lt;</span> tol) {</span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">break</span></span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>  iter <span class="ot">&lt;-</span> iter <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a><span class="co">#after convergence, print the result</span></span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pi)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.293</code></pre>
</div>
</div>
<p>So what’s gone on here? We have 1000 observations of a binary variable; maximum likelihood is answering the question “what is the value of the parameter <span class="math inline">\(\pi\)</span> that makes the observed data most likely?” To get that answer, we have tried candidate values of <span class="math inline">\(\pi\)</span> to see which one maximizes the log-likelihood function.</p>
<p>We’ve maximized the function two ways - using a grid search process, and using an optimization algorith implement in the <code>maxLik</code> package; it uses the Newton-Raphson method to find the maximum of the likelihood function. The <code>start</code> argument is the initial guess for the parameter <span class="math inline">\(\pi\)</span>. The <code>method</code> argument specifies the optimization method, in this case, Newton-Raphson.</p>
<!-- Ok, so now we have a log-likelihood function, and an algorithm for maximizing it. Let's write this as a function that takes the observed data and returns the estimated parameter $\pi$. -->
<!-- ```{r} -->
<!-- logistic_regression <- function(y, max_iter = 100, tol = 1e-6) { -->
<!--   # Initialize pi -->
<!--   pi <- 0.5 -->
<!--   # Iterate the Newton-Raphson algorithm -->
<!--   for (iter in 1:max_iter) { -->
<!--     # Compute gradient -->
<!--     grad <- gradient(pi, y) -->
<!--     # Compute Hessian -->
<!--     hess <- hessian(pi, y) -->
<!--     # Update pi -->
<!--     pi_new <- pi - grad / hess -->
<!--     # Check for convergence -->
<!--     if (abs(pi_new - pi) < tol) { -->
<!--       break -->
<!--     } -->
<!--     pi <- pi_new -->
<!--   } -->
<!--   return(list( -->
<!--     pi = pi, -->
<!--     iterations = iter -->
<!--   )) -->
<!-- } -->
<!-- print(logistic_regression(y)) -->
<!-- ``` -->
</section>
<section id="multiple-predictors" class="level3">
<h3 class="anchored" data-anchor-id="multiple-predictors">Multiple Predictors</h3>
<p>Let’s make this more realistic in terms of resembling the models we want to run by adding an intercept term and multiple predictors to the model - the likelihood now has to account for those <span class="math inline">\(X\)</span> variables and maximize with respect to them.</p>
<ul>
<li>generate some data on <span class="math inline">\(y\)</span>, and <span class="math inline">\(X\)</span></li>
<li>write the likelihood</li>
<li>write the Newton-Raphson algorithm</li>
<li>apply to the data</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate binary y, and two X variables for regression; coefficients are -1, 0.5, -0.5</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">8675309</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n <span class="sc">*</span> <span class="dv">2</span>), <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>true_beta <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="fl">0.5</span>, <span class="sc">-</span><span class="fl">0.5</span>)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="dv">1</span>, X) <span class="sc">%*%</span> true_beta</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>prob <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>z))</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, prob)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the log-likelihood function</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>log_likelihood <span class="ot">&lt;-</span> <span class="cf">function</span>(beta, X, y) {</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> X <span class="sc">%*%</span> beta</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>  probs <span class="ot">&lt;-</span> <span class="fu">plogis</span>(z)</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(y <span class="sc">*</span> <span class="fu">log</span>(probs) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> y) <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> probs))</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="co"># maximize using newton-raphson iterative algorithm</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>logistic_regression <span class="ot">&lt;-</span> <span class="cf">function</span>(X, y, <span class="at">max_iter =</span> <span class="dv">100</span>, <span class="at">tol =</span> <span class="fl">1e-6</span>) {</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add intercept term to X if not already present</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">all</span>(X[,<span class="dv">1</span>] <span class="sc">==</span> <span class="dv">1</span>)) {</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="dv">1</span>, X)</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a><span class="co">#write the gradient function - matrix of partial first derivatives of the log-likelihood function.</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>gradient <span class="ot">&lt;-</span> <span class="cf">function</span>(beta, X, y) {</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">plogis</span>(X <span class="sc">%*%</span> beta)</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t</span>(X) <span class="sc">%*%</span> (y <span class="sc">-</span> p)</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(X)</span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">ncol</span>(X)</span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a><span class="co"># set starting values for k columns of data (betas)</span></span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>  beta <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, k) </span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Store gradients and log-likelihoods for analysis</span></span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>  gradient_history <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>  ll_history <span class="ot">&lt;-</span> <span class="fu">numeric</span>()</span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a><span class="co"># iterate NR </span></span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (iter <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>max_iter) {</span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a>    <span class="co"># compute gradient</span></span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a>    grad <span class="ot">&lt;-</span> <span class="fu">gradient</span>(beta, X, y)</span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a>    gradient_history[[iter]] <span class="ot">&lt;-</span> grad</span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a>    <span class="co"># compute log-likelihood</span></span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a>    ll <span class="ot">&lt;-</span> <span class="fu">log_likelihood</span>(beta, X, y)</span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a>    ll_history[iter] <span class="ot">&lt;-</span> ll</span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true" tabindex="-1"></a>    <span class="co"># compute Hessian</span></span>
<span id="cb9-55"><a href="#cb9-55" aria-hidden="true" tabindex="-1"></a>    z <span class="ot">&lt;-</span> X <span class="sc">%*%</span> beta</span>
<span id="cb9-56"><a href="#cb9-56" aria-hidden="true" tabindex="-1"></a>    probs <span class="ot">&lt;-</span> <span class="fu">plogis</span>(z)</span>
<span id="cb9-57"><a href="#cb9-57" aria-hidden="true" tabindex="-1"></a>    W <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="fu">as.vector</span>(probs <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> probs)))</span>
<span id="cb9-58"><a href="#cb9-58" aria-hidden="true" tabindex="-1"></a>    hessian <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">t</span>(X) <span class="sc">%*%</span> W <span class="sc">%*%</span> X</span>
<span id="cb9-59"><a href="#cb9-59" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-60"><a href="#cb9-60" aria-hidden="true" tabindex="-1"></a>    <span class="co"># update beta</span></span>
<span id="cb9-61"><a href="#cb9-61" aria-hidden="true" tabindex="-1"></a>    delta <span class="ot">&lt;-</span> <span class="fu">solve</span>(hessian, grad)</span>
<span id="cb9-62"><a href="#cb9-62" aria-hidden="true" tabindex="-1"></a>    beta_new <span class="ot">&lt;-</span> beta <span class="sc">-</span> delta</span>
<span id="cb9-63"><a href="#cb9-63" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-64"><a href="#cb9-64" aria-hidden="true" tabindex="-1"></a>    <span class="co"># check for convergence</span></span>
<span id="cb9-65"><a href="#cb9-65" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">max</span>(<span class="fu">abs</span>(beta_new <span class="sc">-</span> beta)) <span class="sc">&lt;</span> tol) {</span>
<span id="cb9-66"><a href="#cb9-66" aria-hidden="true" tabindex="-1"></a>      <span class="cf">break</span></span>
<span id="cb9-67"><a href="#cb9-67" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb9-68"><a href="#cb9-68" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-69"><a href="#cb9-69" aria-hidden="true" tabindex="-1"></a>    beta <span class="ot">&lt;-</span> beta_new</span>
<span id="cb9-70"><a href="#cb9-70" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-71"><a href="#cb9-71" aria-hidden="true" tabindex="-1"></a>    <span class="co"># compute standard errors for this model by taking the square root of the main diagonal elements of the inverse negative Hessian</span></span>
<span id="cb9-72"><a href="#cb9-72" aria-hidden="true" tabindex="-1"></a>  se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">solve</span>(<span class="sc">-</span>hessian)))</span>
<span id="cb9-73"><a href="#cb9-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-74"><a href="#cb9-74" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-75"><a href="#cb9-75" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb9-76"><a href="#cb9-76" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-77"><a href="#cb9-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb9-78"><a href="#cb9-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">coefficients =</span> beta,</span>
<span id="cb9-79"><a href="#cb9-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">st.errors =</span> se,</span>
<span id="cb9-80"><a href="#cb9-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">log_likelihood =</span> ll,</span>
<span id="cb9-81"><a href="#cb9-81" aria-hidden="true" tabindex="-1"></a>    <span class="at">iterations =</span> iter,</span>
<span id="cb9-82"><a href="#cb9-82" aria-hidden="true" tabindex="-1"></a>    <span class="at">gradient_history =</span> gradient_history,</span>
<span id="cb9-83"><a href="#cb9-83" aria-hidden="true" tabindex="-1"></a>    <span class="at">ll_history =</span> ll_history</span>
<span id="cb9-84"><a href="#cb9-84" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb9-85"><a href="#cb9-85" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-86"><a href="#cb9-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-87"><a href="#cb9-87" aria-hidden="true" tabindex="-1"></a><span class="co">#estimate the model</span></span>
<span id="cb9-88"><a href="#cb9-88" aria-hidden="true" tabindex="-1"></a>logit <span class="ot">&lt;-</span> <span class="fu">logistic_regression</span>(X, y)</span>
<span id="cb9-89"><a href="#cb9-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-90"><a href="#cb9-90" aria-hidden="true" tabindex="-1"></a><span class="co">#compare to glm estimates </span></span>
<span id="cb9-91"><a href="#cb9-91" aria-hidden="true" tabindex="-1"></a>glm_fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> X, <span class="at">family =</span> binomial)</span>
<span id="cb9-92"><a href="#cb9-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-93"><a href="#cb9-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-94"><a href="#cb9-94" aria-hidden="true" tabindex="-1"></a><span class="co"># compare the results </span></span>
<span id="cb9-95"><a href="#cb9-95" aria-hidden="true" tabindex="-1"></a>glmcoefs <span class="ot">&lt;-</span> <span class="fu">coef</span>(glm_fit)</span>
<span id="cb9-96"><a href="#cb9-96" aria-hidden="true" tabindex="-1"></a>glmse <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcov</span>(glm_fit)))</span>
<span id="cb9-97"><a href="#cb9-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-98"><a href="#cb9-98" aria-hidden="true" tabindex="-1"></a><span class="co">#html table comparing glmcoefs to logit$coefficients</span></span>
<span id="cb9-99"><a href="#cb9-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-100"><a href="#cb9-100" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb9-101"><a href="#cb9-101" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(glmcoefs, logit<span class="sc">$</span>coefficients, glmse, logit<span class="sc">$</span>st.errors) <span class="sc">%&gt;%</span> </span>
<span id="cb9-102"><a href="#cb9-102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="st">"html"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb9-103"><a href="#cb9-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="st">"striped"</span>, <span class="at">full_width =</span> F) <span class="sc">%&gt;%</span> </span>
<span id="cb9-104"><a href="#cb9-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">1</span>, <span class="at">border_right =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb9-105"><a href="#cb9-105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">2</span>, <span class="at">border_right =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb9-106"><a href="#cb9-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">3</span>, <span class="at">border_right =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb9-107"><a href="#cb9-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">4</span>, <span class="at">border_right =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb9-108"><a href="#cb9-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collapse_rows</span>(<span class="at">columns =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">valign =</span> <span class="st">"top"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<table class="table table-striped table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">glmcoefs</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">logit.coefficients</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">glmse</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">logit.st.errors</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; border-right: 1px solid;">(Intercept)</td>
<td style="text-align: right; border-right: 1px solid;">-0.9531826</td>
<td style="text-align: right; border-right: 1px solid;">-0.9531826</td>
<td style="text-align: right; border-right: 1px solid;">0.0236756</td>
<td style="text-align: right;">0.0236748</td>
</tr>
<tr class="even">
<td style="text-align: left; border-right: 1px solid;">X1</td>
<td style="text-align: right; border-right: 1px solid;">0.4938831</td>
<td style="text-align: right; border-right: 1px solid;">0.4938831</td>
<td style="text-align: right; border-right: 1px solid;">0.0238303</td>
<td style="text-align: right;">0.0238295</td>
</tr>
<tr class="odd">
<td style="text-align: left; border-right: 1px solid;">X2</td>
<td style="text-align: right; border-right: 1px solid;">-0.4719703</td>
<td style="text-align: right; border-right: 1px solid;">-0.4719703</td>
<td style="text-align: right; border-right: 1px solid;">0.0240294</td>
<td style="text-align: right;">0.0240286</td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
<p>Alright, lots of fun here. Now, let’s use the program above to estimate a logit model using the democratic peace data.</p>
</section>
<section id="logit-using-democratic-peace-data" class="level3">
<h3 class="anchored" data-anchor-id="logit-using-democratic-peace-data">Logit using Democratic Peace data</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>dp <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"/users/dave/documents/teaching/606J-mle/2022/exercises/ex1/dp.csv"</span>, <span class="at">header=</span><span class="cn">TRUE</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co"># for the log_likelihood function below, define y as the variable "dispute" in the dp data frame, and x1, x2, and x3 as the variables "caprat", "border", and "deml" in the dp data frame, respectively.</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(dp[, <span class="fu">c</span>(<span class="st">"caprat"</span>, <span class="st">"border"</span>, <span class="st">"deml"</span>)])</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(dp<span class="sc">$</span>dispute)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the log-likelihood function</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>log_likelihood <span class="ot">&lt;-</span> <span class="cf">function</span>(beta, X, y) {</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> X <span class="sc">%*%</span> beta</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  probs <span class="ot">&lt;-</span> <span class="fu">plogis</span>(z)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(y <span class="sc">*</span> <span class="fu">log</span>(probs) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> y) <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> probs))</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="co"># maximize using newton-raphson </span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>logistic_regression <span class="ot">&lt;-</span> <span class="cf">function</span>(X, y, <span class="at">max_iter =</span> <span class="dv">100</span>, <span class="at">tol =</span> <span class="fl">1e-6</span>) {</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add intercept term to X if not already present</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">all</span>(X[,<span class="dv">1</span>] <span class="sc">==</span> <span class="dv">1</span>)) {</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="dv">1</span>, X)</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a><span class="co">#define the gradient function -  partial first derivatives of the log-likelihood function.</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>gradient <span class="ot">&lt;-</span> <span class="cf">function</span>(beta, X, y) {</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>X <span class="sc">%*%</span> beta))</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t</span>(X) <span class="sc">%*%</span> (y <span class="sc">-</span> p)</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(X)</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">ncol</span>(X)</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Initialize beta</span></span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>  beta <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, p)</span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Store gradients and log-likelihoods</span></span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>  gradient_history <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>  ll_history <span class="ot">&lt;-</span> <span class="fu">numeric</span>()</span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (iter <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>max_iter) {</span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Compute gradient</span></span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>    grad <span class="ot">&lt;-</span> <span class="fu">gradient</span>(beta, X, y)</span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a>    gradient_history[[iter]] <span class="ot">&lt;-</span> grad</span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Compute log-likelihood</span></span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a>    ll <span class="ot">&lt;-</span> <span class="fu">log_likelihood</span>(beta, X, y)</span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a>    ll_history[iter] <span class="ot">&lt;-</span> ll</span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Compute Hessian - 2nd partial derivatives </span></span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a>    z <span class="ot">&lt;-</span> X <span class="sc">%*%</span> beta</span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a>    probs <span class="ot">&lt;-</span> <span class="fu">plogis</span>(z)</span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a>    W <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="fu">as.vector</span>(probs <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> probs)))</span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a>    hessian <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">t</span>(X) <span class="sc">%*%</span> W <span class="sc">%*%</span> X</span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update beta</span></span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true" tabindex="-1"></a>    delta <span class="ot">&lt;-</span> <span class="fu">solve</span>(hessian, grad)</span>
<span id="cb10-57"><a href="#cb10-57" aria-hidden="true" tabindex="-1"></a>    beta_new <span class="ot">&lt;-</span> beta <span class="sc">-</span> delta</span>
<span id="cb10-58"><a href="#cb10-58" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-59"><a href="#cb10-59" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check for convergence - end if change in beta is less than tolerance value </span></span>
<span id="cb10-60"><a href="#cb10-60" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">max</span>(<span class="fu">abs</span>(beta_new <span class="sc">-</span> beta)) <span class="sc">&lt;</span> tol) {</span>
<span id="cb10-61"><a href="#cb10-61" aria-hidden="true" tabindex="-1"></a>      <span class="cf">break</span></span>
<span id="cb10-62"><a href="#cb10-62" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb10-63"><a href="#cb10-63" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-64"><a href="#cb10-64" aria-hidden="true" tabindex="-1"></a>    beta <span class="ot">&lt;-</span> beta_new</span>
<span id="cb10-65"><a href="#cb10-65" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb10-66"><a href="#cb10-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-67"><a href="#cb10-67" aria-hidden="true" tabindex="-1"></a><span class="co">#compute standard errors for this model; take the square root of the main diagonal elements of the inverse negative Hessian</span></span>
<span id="cb10-68"><a href="#cb10-68" aria-hidden="true" tabindex="-1"></a>  se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">solve</span>(<span class="sc">-</span>hessian)))</span>
<span id="cb10-69"><a href="#cb10-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-70"><a href="#cb10-70" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-71"><a href="#cb10-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb10-72"><a href="#cb10-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">coefficients =</span> beta,</span>
<span id="cb10-73"><a href="#cb10-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">st.errors =</span> se,</span>
<span id="cb10-74"><a href="#cb10-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">log_likelihood =</span> ll,</span>
<span id="cb10-75"><a href="#cb10-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">iterations =</span> iter,</span>
<span id="cb10-76"><a href="#cb10-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">gradient_history =</span> gradient_history,</span>
<span id="cb10-77"><a href="#cb10-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">ll_history =</span> ll_history</span>
<span id="cb10-78"><a href="#cb10-78" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb10-79"><a href="#cb10-79" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-80"><a href="#cb10-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-81"><a href="#cb10-81" aria-hidden="true" tabindex="-1"></a><span class="co">#estimate the model</span></span>
<span id="cb10-82"><a href="#cb10-82" aria-hidden="true" tabindex="-1"></a>logit <span class="ot">&lt;-</span> <span class="fu">logistic_regression</span>(X, y)</span>
<span id="cb10-83"><a href="#cb10-83" aria-hidden="true" tabindex="-1"></a>logit<span class="sc">$</span>coefficients</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               [,1]
       -3.666760193
caprat -0.002687365
border  0.945976154
deml   -0.078401814</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>logit<span class="sc">$</span>st.errors</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   caprat       border         deml 
0.0721818683 0.0003920263 0.0738842477 0.0067789319 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">#compare to glm estimates </span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>glm_fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> X, <span class="at">family =</span> binomial)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># compare the results </span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>glmcoefs <span class="ot">&lt;-</span> <span class="fu">coef</span>(glm_fit)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>glmse <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcov</span>(glm_fit)))</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="co">#html table comparing glmcoefs to logit$coefficients</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(glmcoefs, logit<span class="sc">$</span>coefficients, glmse, logit<span class="sc">$</span>st.errors) <span class="sc">%&gt;%</span> </span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="st">"html"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="st">"striped"</span>, <span class="at">full_width =</span> F) <span class="sc">%&gt;%</span> </span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">1</span>, <span class="at">border_right =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">2</span>, <span class="at">border_right =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collapse_rows</span>(<span class="at">columns =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">valign =</span> <span class="st">"top"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<table class="table table-striped table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">glmcoefs</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">logit.coefficients</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">glmse</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">logit.st.errors</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; border-right: 1px solid;">(Intercept)</td>
<td style="text-align: right; border-right: 1px solid;">-3.6667602</td>
<td style="text-align: right;">-3.6667602</td>
<td style="text-align: right;">0.0721816</td>
<td style="text-align: right;">0.0721819</td>
</tr>
<tr class="even">
<td style="text-align: left; border-right: 1px solid;">Xcaprat</td>
<td style="text-align: right; border-right: 1px solid;">-0.0026874</td>
<td style="text-align: right;">-0.0026874</td>
<td style="text-align: right;">0.0003920</td>
<td style="text-align: right;">0.0003920</td>
</tr>
<tr class="odd">
<td style="text-align: left; border-right: 1px solid;">Xborder</td>
<td style="text-align: right; border-right: 1px solid;">0.9459761</td>
<td style="text-align: right;">0.9459762</td>
<td style="text-align: right;">0.0738841</td>
<td style="text-align: right;">0.0738842</td>
</tr>
<tr class="even">
<td style="text-align: left; border-right: 1px solid;">Xdeml</td>
<td style="text-align: right; border-right: 1px solid;">-0.0784018</td>
<td style="text-align: right;">-0.0784018</td>
<td style="text-align: right;">0.0067789</td>
<td style="text-align: right;">0.0067789</td>
</tr>
</tbody>
</table>


</div>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract LL from glm </span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co"># library(stats)  </span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co"># logLik(glm_fit)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>What did we just do?</p>
<ol type="1">
<li>We wrote a log-likelihood function for a logistic regression model with multiple predictors.</li>
<li>To maximize the log-likelihood, we implemented a Newton-Raphson algorithm in the following steps:
<ul>
<li>Defined the gradient and Hessian functions. The gradient is the vector of first partial derivatives of the log-likelihood, and the Hessian is the matrix of second partial derivatives.</li>
<li>Initialized the beta coefficients and stored gradients and log-likelihoods.</li>
<li>Iterated the algorithm to update beta values.</li>
<li>Checked for convergence based on the change in beta.</li>
</ul></li>
<li>Once the model converged, we computed standard errors for the estimated coefficients by taking the square root of the main diagonal elements of the inverse negative Hessian.</li>
</ol>
</section>
<section id="plot-gradient-over-iterations" class="level3">
<h3 class="anchored" data-anchor-id="plot-gradient-over-iterations">Plot Gradient over iterations</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot gradient convergence</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>gradients <span class="ot">&lt;-</span> <span class="fu">do.call</span>(cbind, logit<span class="sc">$</span>gradient_history)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>gradients <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(gradients) <span class="sc">%&gt;%</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">coef=</span><span class="fu">c</span>(<span class="st">"Intercept"</span>, <span class="st">"caprat"</span>, <span class="st">"border"</span>, <span class="st">"deml"</span>)) </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>gradients <span class="ot">&lt;-</span> gradients <span class="sc">%&gt;%</span> </span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>coef, <span class="at">names_to =</span> <span class="st">"iteration"</span>, <span class="at">values_to =</span> <span class="st">"value"</span>)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>bucolors<span class="ot">&lt;-</span><span class="fu">list</span>(<span class="st">"#005A43"</span>,<span class="st">"#6CC24A"</span>, <span class="st">"#A7DA92"</span>, <span class="st">"#BDBEBD"</span>, <span class="st">"#000000"</span> )</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>highcharter<span class="sc">::</span><span class="fu">highchart</span>() <span class="sc">%&gt;%</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_add_series</span>(gradients, <span class="st">"line"</span>, <span class="fu">hcaes</span>(<span class="at">x=</span>iteration, <span class="at">y=</span>value, <span class="at">group=</span>coef, <span class="at">color=</span>coef)) <span class="sc">%&gt;%</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_title</span>(<span class="at">text =</span> <span class="st">"Gradient Convergence"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_xAxis</span>(<span class="at">title =</span> <span class="fu">list</span>(<span class="at">text =</span> <span class="st">"Iteration"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_yAxis</span>(<span class="at">title =</span> <span class="fu">list</span>(<span class="at">text =</span> <span class="st">"Gradient"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_colors</span>(bucolors) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="highchart html-widget html-fill-item" id="htmlwidget-d562f8de167c182c4a36" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-d562f8de167c182c4a36">{"x":{"hc_opts":{"chart":{"reflow":true},"title":{"text":"Gradient Convergence"},"yAxis":{"title":{"text":"Gradient"}},"credits":{"enabled":false},"exporting":{"enabled":false},"boost":{"enabled":false},"plotOptions":{"series":{"label":{"enabled":false},"turboThreshold":0},"treemap":{"layoutAlgorithm":"squarified"}},"series":[{"name":"Intercept","data":[{"coef":"Intercept","iteration":"V1","value":-9548,"y":-9548,"color":"#FDE725","name":"V1","colorv":"Intercept"},{"coef":"Intercept","iteration":"V2","value":-1997.105368234596,"y":-1997.105368234596,"color":"#FDE725","name":"V2","colorv":"Intercept"},{"coef":"Intercept","iteration":"V3","value":-533.7680095659274,"y":-533.7680095659274,"color":"#FDE725","name":"V3","colorv":"Intercept"},{"coef":"Intercept","iteration":"V4","value":-118.2948928316253,"y":-118.2948928316253,"color":"#FDE725","name":"V4","colorv":"Intercept"},{"coef":"Intercept","iteration":"V5","value":-21.78799516616742,"y":-21.78799516616742,"color":"#FDE725","name":"V5","colorv":"Intercept"},{"coef":"Intercept","iteration":"V6","value":-5.212306129510333,"y":-5.212306129510333,"color":"#FDE725","name":"V6","colorv":"Intercept"},{"coef":"Intercept","iteration":"V7","value":-0.8671524733035209,"y":-0.8671524733035209,"color":"#FDE725","name":"V7","colorv":"Intercept"},{"coef":"Intercept","iteration":"V8","value":-0.01989246700385234,"y":-0.01989246700385234,"color":"#FDE725","name":"V8","colorv":"Intercept"},{"coef":"Intercept","iteration":"V9","value":-8.959070519284212e-06,"y":-8.959070519284212e-06,"color":"#FDE725","name":"V9","colorv":"Intercept"}],"type":"line"},{"name":"border","data":[{"coef":"border","iteration":"V1","value":-2752,"y":-2752,"color":"#440154","name":"V1","colorv":"border"},{"coef":"border","iteration":"V2","value":-494.7744026498677,"y":-494.7744026498677,"color":"#440154","name":"V2","colorv":"border"},{"coef":"border","iteration":"V3","value":-90.42918016166651,"y":-90.42918016166651,"color":"#440154","name":"V3","colorv":"border"},{"coef":"border","iteration":"V4","value":-11.58753754306463,"y":-11.58753754306463,"color":"#440154","name":"V4","colorv":"border"},{"coef":"border","iteration":"V5","value":-3.206585470090669,"y":-3.206585470090669,"color":"#440154","name":"V5","colorv":"border"},{"coef":"border","iteration":"V6","value":-0.4484695785339219,"y":-0.4484695785339219,"color":"#440154","name":"V6","colorv":"border"},{"coef":"border","iteration":"V7","value":-0.04968927674323675,"y":-0.04968927674323675,"color":"#440154","name":"V7","colorv":"border"},{"coef":"border","iteration":"V8","value":-0.001117345956970436,"y":-0.001117345956970436,"color":"#440154","name":"V8","colorv":"border"},{"coef":"border","iteration":"V9","value":-4.995736343910151e-07,"y":-4.995736343910151e-07,"color":"#440154","name":"V9","colorv":"border"}],"type":"line"},{"name":"caprat","data":[{"coef":"caprat","iteration":"V1","value":-1678429.353945701,"y":-1678429.353945701,"color":"#2C6079","name":"V1","colorv":"caprat"},{"coef":"caprat","iteration":"V2","value":-390652.0196822016,"y":-390652.0196822016,"color":"#2C6079","name":"V2","colorv":"caprat"},{"coef":"caprat","iteration":"V3","value":-131910.0359405414,"y":-131910.0359405414,"color":"#2C6079","name":"V3","colorv":"caprat"},{"coef":"caprat","iteration":"V4","value":-46104.92211262019,"y":-46104.92211262019,"color":"#2C6079","name":"V4","colorv":"caprat"},{"coef":"caprat","iteration":"V5","value":-16074.71199856277,"y":-16074.71199856277,"color":"#2C6079","name":"V5","colorv":"caprat"},{"coef":"caprat","iteration":"V6","value":-4512.808739883622,"y":-4512.808739883622,"color":"#2C6079","name":"V6","colorv":"caprat"},{"coef":"caprat","iteration":"V7","value":-586.4338155232391,"y":-586.4338155232391,"color":"#2C6079","name":"V7","colorv":"caprat"},{"coef":"caprat","iteration":"V8","value":-12.2020518707005,"y":-12.2020518707005,"color":"#2C6079","name":"V8","colorv":"caprat"},{"coef":"caprat","iteration":"V9","value":-0.005420811663435205,"y":-0.005420811663435205,"color":"#2C6079","name":"V9","colorv":"caprat"}],"type":"line"},{"name":"deml","data":[{"coef":"deml","iteration":"V1","value":31111.5,"y":31111.5,"color":"#6AAD69","name":"V1","colorv":"deml"},{"coef":"deml","iteration":"V2","value":5713.223874228809,"y":5713.223874228809,"color":"#6AAD69","name":"V2","colorv":"deml"},{"coef":"deml","iteration":"V3","value":1036.148452391417,"y":1036.148452391417,"color":"#6AAD69","name":"V3","colorv":"deml"},{"coef":"deml","iteration":"V4","value":51.61618585688002,"y":51.61618585688002,"color":"#6AAD69","name":"V4","colorv":"deml"},{"coef":"deml","iteration":"V5","value":22.3960510903142,"y":22.3960510903142,"color":"#6AAD69","name":"V5","colorv":"deml"},{"coef":"deml","iteration":"V6","value":28.62749905554031,"y":28.62749905554031,"color":"#6AAD69","name":"V6","colorv":"deml"},{"coef":"deml","iteration":"V7","value":5.592025710351689,"y":5.592025710351689,"color":"#6AAD69","name":"V7","colorv":"deml"},{"coef":"deml","iteration":"V8","value":0.1295010540941835,"y":0.1295010540941835,"color":"#6AAD69","name":"V8","colorv":"deml"},{"coef":"deml","iteration":"V9","value":5.842505968853273e-05,"y":5.842505968853273e-05,"color":"#6AAD69","name":"V9","colorv":"deml"}],"type":"line"}],"xAxis":{"title":{"text":"Iteration"}},"colors":["#005A43","#6CC24A","#A7DA92","#BDBEBD","#000000"]},"theme":{"chart":{"backgroundColor":"transparent"},"colors":["#7cb5ec","#434348","#90ed7d","#f7a35c","#8085e9","#f15c80","#e4d354","#2b908f","#f45b5b","#91e8e1"]},"conf_opts":{"global":{"Date":null,"VMLRadialGradientURL":"http =//code.highcharts.com/list(version)/gfx/vml-radial-gradient.png","canvasToolsURL":"http =//code.highcharts.com/list(version)/modules/canvas-tools.js","getTimezoneOffset":null,"timezoneOffset":0,"useUTC":true},"lang":{"contextButtonTitle":"Chart context menu","decimalPoint":".","downloadCSV":"Download CSV","downloadJPEG":"Download JPEG image","downloadPDF":"Download PDF document","downloadPNG":"Download PNG image","downloadSVG":"Download SVG vector image","downloadXLS":"Download XLS","drillUpText":"◁ Back to {series.name}","exitFullscreen":"Exit from full screen","exportData":{"annotationHeader":"Annotations","categoryDatetimeHeader":"DateTime","categoryHeader":"Category"},"hideData":"Hide data table","invalidDate":null,"loading":"Loading...","months":["January","February","March","April","May","June","July","August","September","October","November","December"],"noData":"No data to display","numericSymbolMagnitude":1000,"numericSymbols":["k","M","G","T","P","E"],"printChart":"Print chart","resetZoom":"Reset zoom","resetZoomTitle":"Reset zoom level 1:1","shortMonths":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"shortWeekdays":["Sat","Sun","Mon","Tue","Wed","Thu","Fri"],"thousandsSep":" ","viewData":"View data table","viewFullscreen":"View in full screen","weekdays":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]}},"type":"chart","fonts":[],"debug":false},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="plot-log-likelihood-over-iterations" class="level3">
<h3 class="anchored" data-anchor-id="plot-log-likelihood-over-iterations">Plot Log-Likelihood over iterations</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot ll convergence</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>lls <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(logit<span class="sc">$</span>ll_history) <span class="sc">%&gt;%</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">iteration=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(.))</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>bucolors<span class="ot">&lt;-</span><span class="fu">list</span>(<span class="st">"#005A43"</span>,<span class="st">"#6CC24A"</span>, <span class="st">"#A7DA92"</span>, <span class="st">"#BDBEBD"</span>, <span class="st">"#000000"</span> )</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>highcharter<span class="sc">::</span><span class="fu">highchart</span>() <span class="sc">%&gt;%</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_add_series</span>(lls, <span class="st">"line"</span>, <span class="fu">hcaes</span>(<span class="at">x=</span>iteration, <span class="at">y=</span><span class="st">`</span><span class="at">logit$ll_history</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_title</span>(<span class="at">text =</span> <span class="st">"Log-Likelihood Convergence"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_xAxis</span>(<span class="at">title =</span> <span class="fu">list</span>(<span class="at">text =</span> <span class="st">"Iteration"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_yAxis</span>(<span class="at">title =</span> <span class="fu">list</span>(<span class="at">text =</span> <span class="st">"Log-Likelihood"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hc_colors</span>(bucolors) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="highchart html-widget html-fill-item" id="htmlwidget-73a9278b7f27a3a3592e" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-73a9278b7f27a3a3592e">{"x":{"hc_opts":{"chart":{"reflow":true},"title":{"text":"Log-Likelihood Convergence"},"yAxis":{"title":{"text":"Log-Likelihood"}},"credits":{"enabled":false},"exporting":{"enabled":false},"boost":{"enabled":false},"plotOptions":{"series":{"label":{"enabled":false},"turboThreshold":0},"treemap":{"layoutAlgorithm":"squarified"}},"series":[{"group":"group","data":[{"logit$ll_history":-14549.15931995624,"iteration":1,"x":1,"y":-14549.15931995624},{"logit$ll_history":-4805.551479983532,"iteration":2,"x":2,"y":-4805.551479983532},{"logit$ll_history":-3788.447482964257,"iteration":3,"x":3,"y":-3788.447482964257},{"logit$ll_history":-3598.166513728968,"iteration":4,"x":4,"y":-3598.166513728968},{"logit$ll_history":-3563.935708699368,"iteration":5,"x":5,"y":-3563.935708699368},{"logit$ll_history":-3555.914875395035,"iteration":6,"x":6,"y":-3555.914875395035},{"logit$ll_history":-3554.848544685918,"iteration":7,"x":7,"y":-3554.848544685918},{"logit$ll_history":-3554.827463219393,"iteration":8,"x":8,"y":-3554.827463219393},{"logit$ll_history":-3554.827453980499,"iteration":9,"x":9,"y":-3554.827453980499}],"type":"line"}],"xAxis":{"title":{"text":"Iteration"}},"colors":["#005A43","#6CC24A","#A7DA92","#BDBEBD","#000000"]},"theme":{"chart":{"backgroundColor":"transparent"},"colors":["#7cb5ec","#434348","#90ed7d","#f7a35c","#8085e9","#f15c80","#e4d354","#2b908f","#f45b5b","#91e8e1"]},"conf_opts":{"global":{"Date":null,"VMLRadialGradientURL":"http =//code.highcharts.com/list(version)/gfx/vml-radial-gradient.png","canvasToolsURL":"http =//code.highcharts.com/list(version)/modules/canvas-tools.js","getTimezoneOffset":null,"timezoneOffset":0,"useUTC":true},"lang":{"contextButtonTitle":"Chart context menu","decimalPoint":".","downloadCSV":"Download CSV","downloadJPEG":"Download JPEG image","downloadPDF":"Download PDF document","downloadPNG":"Download PNG image","downloadSVG":"Download SVG vector image","downloadXLS":"Download XLS","drillUpText":"◁ Back to {series.name}","exitFullscreen":"Exit from full screen","exportData":{"annotationHeader":"Annotations","categoryDatetimeHeader":"DateTime","categoryHeader":"Category"},"hideData":"Hide data table","invalidDate":null,"loading":"Loading...","months":["January","February","March","April","May","June","July","August","September","October","November","December"],"noData":"No data to display","numericSymbolMagnitude":1000,"numericSymbols":["k","M","G","T","P","E"],"printChart":"Print chart","resetZoom":"Reset zoom","resetZoomTitle":"Reset zoom level 1:1","shortMonths":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"shortWeekdays":["Sat","Sun","Mon","Tue","Wed","Thu","Fri"],"thousandsSep":" ","viewData":"View data table","viewFullscreen":"View in full screen","weekdays":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]}},"type":"chart","fonts":[],"debug":false},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<!-- 1. Objective: -->
<!--    Maximize the log-likelihood function L(β), where β are the regression coefficients. -->
<!-- 2. Gradient (Score function): -->
<!--    The gradient g(β) is the vector of first partial derivatives of L(β) with respect to each βi. -->
<!--    g(β) = ∂L(β)/∂β =  -->
<!-- 3. Hessian: -->
<!--    The Hessian H(β) is the matrix of second partial derivatives of L(β). -->
<!--    Hij(β) = ∂²L(β)/∂βi∂βj -->
<!-- 4. Newton-Raphson update: -->
<!--    β(t+1) = β(t) - [H(β(t))]^(-1) g(β(t)) -->
<!-- 5. Convergence: -->
<!--    The process converges when the change in β or the log-likelihood is below a specified threshold. -->
<!-- Influence of gradient and Hessian on convergence: -->
<!-- 1. Gradient: -->
<!--    - Indicates the direction of steepest ascent in the likelihood surface. -->
<!--    - Larger gradient magnitudes suggest we're far from the optimum. -->
<!--    - As we approach the maximum, the gradient approaches zero. -->
<!-- 2. Hessian: -->
<!--    - Describes the curvature of the likelihood surface. -->
<!--    - Negative definite at the maximum (ensuring it's a local maximum). -->
<!--    - Inverse Hessian scales the step size in each dimension. -->
<!-- 3. Convergence properties: -->
<!--    - Quadratic convergence when close to the optimum. -->
<!--    - Can be faster than gradient descent methods. -->
<!--    - May converge in fewer iterations but each iteration is more computationally expensive. -->
<!-- 4. Potential issues: -->
<!--    - Non-positive definite Hessian can cause convergence problems. -->
<!--    - Very flat or very steep surfaces can lead to slow convergence or overshooting. -->
<!-- 5. Modifications: -->
<!--    - Fisher Scoring: Uses expected Hessian instead of observed Hessian. -->
<!--    - Quasi-Newton methods (e.g., BFGS): Approximate Hessian to reduce computational cost. -->
<!-- logistic_regression <- function(X, y, max_iter = 100, tol = 1e-6) { -->
<!--   # Add intercept term to X -->
<!--   X <- cbind(1, X) -->
<!--   n <- nrow(X) -->
<!--   p <- ncol(X) -->
<!--   # Initialize beta -->
<!--   beta <- rep(0, p) -->
<!--   # Store gradients -->
<!--   gradient_history <- list() -->
<!--   for (iter in 1:max_iter) { -->
<!--     # Compute probabilities -->
<!--     z <- X %*% beta -->
<!--     probs <- 1 / (1 + exp(-z)) -->
<!--     # Compute gradient - first derivative matrix; only used in gradient descent -->
<!--     gradient <- t(X) %*% (y - probs) -->
<!--     gradient_history[[iter]] <- gradient -->
<!--     # Compute Hessian - second derivative matrix; both used in NR method -->
<!--     W <- diag(as.vector(probs * (1 - probs))) -->
<!--     hessian <- -t(X) %*% W %*% X -->
<!--     # Update beta -->
<!--     delta <- solve(hessian, gradient) -->
<!--     beta_new <- beta - delta -->
<!--     # Check for convergence -->
<!--     if (max(abs(beta_new - beta)) < tol) { -->
<!--       break -->
<!--     } -->
<!--     beta <- beta_new -->
<!--   } -->
<!--   # Compute final log-likelihood -->
<!--   z <- X %*% beta -->
<!--   probs <- 1 / (1 + exp(-z)) -->
<!--   log_likelihood <- sum(y * log(probs) + (1 - y) * log(1 - probs)) -->
<!--   return(list( -->
<!--     coefficients = beta, -->
<!--     log_likelihood = log_likelihood, -->
<!--     iterations = iter, -->
<!--     gradient_history = gradient_history -->
<!--   )) -->
<!-- } -->
<!-- # Example usage: -->
<!-- set.seed(123) -->
<!-- n <- 1000 -->
<!-- X <- matrix(rnorm(n * 2), ncol = 2) -->
<!-- true_beta <- c(-1, 0.5, -0.5) -->
<!-- z <- cbind(1, X) %*% true_beta -->
<!-- prob <- 1 / (1 + exp(-z)) -->
<!-- y <- rbinom(n, 1, prob) -->
<!-- result <- logistic_regression(X, y) -->
<!-- print(result$coefficients) -->
<!-- print(result$log_likelihood) -->
<!-- print(result$iterations) -->
<!-- # plot gradients -->
<!-- # Plot gradient convergence -->
<!-- gradients <- do.call(cbind, result$gradient_history) -->
<!-- matplot(1:ncol(gradients), t(gradients), type = 'l',  -->
<!--         xlab = 'Iteration', ylab = 'Gradient', main = 'Gradient Convergence') -->
<!-- legend('topright', legend = paste('Beta', 0:(ncol(X)-1)),  -->
<!--        col = 1:ncol(X), lty = 1:ncol(X)) -->
<!-- This program does the following: -->
<!-- 1. Defines a `logistic_regression` function that implements the Newton-Raphson method for logistic regression. -->
<!-- 2. Initializes parameters and sets up storage for gradient history. -->
<!-- 3. Iterates the Newton-Raphson algorithm: -->
<!--    - Computes probabilities, gradient, and Hessian. -->
<!--    - Updates beta values. -->
<!--    - Stores the gradient at each iteration. -->
<!--    - Checks for convergence. -->
<!-- 4. Returns the estimated coefficients, final log-likelihood, number of iterations, and gradient history. -->
<!-- 5. Includes an example usage with simulated data. -->
<!-- 6. Prints the results and plots the gradient convergence. -->
<!-- The gradient history can be accessed via `result$gradient_history`. Each element of this list is the gradient vector for one iteration. -->


</section>
</section>
</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>