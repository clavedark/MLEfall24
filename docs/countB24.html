<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Dave Clark">
<meta name="dcterms.date" content="2024-11-08">

<title>Count Models II – MLE - Fall 2024</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="site_libs/htmltools-fill/fill.css" rel="stylesheet">
<script src="site_libs/htmlwidgets/htmlwidgets.js"></script>
<script src="site_libs/jquery/jquery.min.js"></script>
<script src="site_libs/proj4js/proj4.js"></script>
<link href="site_libs/highcharts/css/motion.css" rel="stylesheet">
<script src="site_libs/highcharts/highcharts.js"></script>
<script src="site_libs/highcharts/highcharts-3d.js"></script>
<script src="site_libs/highcharts/highcharts-more.js"></script>
<script src="site_libs/highcharts/modules/stock.js"></script>
<script src="site_libs/highcharts/modules/map.js"></script>
<script src="site_libs/highcharts/modules/data.js"></script>
<script src="site_libs/highcharts/modules/exporting.js"></script>
<script src="site_libs/highcharts/modules/offline-exporting.js"></script>
<script src="site_libs/highcharts/modules/drilldown.js"></script>
<script src="site_libs/highcharts/modules/item-series.js"></script>
<script src="site_libs/highcharts/modules/overlapping-datalabels.js"></script>
<script src="site_libs/highcharts/modules/annotations.js"></script>
<script src="site_libs/highcharts/modules/export-data.js"></script>
<script src="site_libs/highcharts/modules/funnel.js"></script>
<script src="site_libs/highcharts/modules/heatmap.js"></script>
<script src="site_libs/highcharts/modules/treemap.js"></script>
<script src="site_libs/highcharts/modules/sankey.js"></script>
<script src="site_libs/highcharts/modules/dependency-wheel.js"></script>
<script src="site_libs/highcharts/modules/organization.js"></script>
<script src="site_libs/highcharts/modules/solid-gauge.js"></script>
<script src="site_libs/highcharts/modules/streamgraph.js"></script>
<script src="site_libs/highcharts/modules/sunburst.js"></script>
<script src="site_libs/highcharts/modules/vector.js"></script>
<script src="site_libs/highcharts/modules/wordcloud.js"></script>
<script src="site_libs/highcharts/modules/xrange.js"></script>
<script src="site_libs/highcharts/modules/tilemap.js"></script>
<script src="site_libs/highcharts/modules/venn.js"></script>
<script src="site_libs/highcharts/modules/gantt.js"></script>
<script src="site_libs/highcharts/modules/timeline.js"></script>
<script src="site_libs/highcharts/modules/parallel-coordinates.js"></script>
<script src="site_libs/highcharts/modules/bullet.js"></script>
<script src="site_libs/highcharts/modules/coloraxis.js"></script>
<script src="site_libs/highcharts/modules/dumbbell.js"></script>
<script src="site_libs/highcharts/modules/lollipop.js"></script>
<script src="site_libs/highcharts/modules/series-label.js"></script>
<script src="site_libs/highcharts/plugins/motion.js"></script>
<script src="site_libs/highcharts/custom/reset.js"></script>
<script src="site_libs/highcharts/modules/boost.js"></script>
<script src="site_libs/highchart-binding/highchart.js"></script>
<script src="site_libs/kePrint/kePrint.js"></script>
<link href="site_libs/lightable/lightable.css" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">MLE - Fall 2024</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./slides.html"> 
<span class="menu-text">Slides</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./mlesyllabus24.html"> 
<span class="menu-text">MLE Syllabus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./code.html"> 
<span class="menu-text">Code</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools tools-wide">
    <div class="dropdown">
      <a href="" title="" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label=""><i class="bi bi-github"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://github.com/clavedark/MLEfall24">
            repo
            </a>
          </li>
      </ul>
    </div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Count Models II</h1>
                      </div>
  </div>
    
  <div class="quarto-title-meta-author">
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-heading">Affiliation</div>
    
      <div class="quarto-title-meta-contents">
      <p class="author">Dave Clark </p>
    </div>
    <div class="quarto-title-meta-contents">
          <p class="affiliation">
              Binghamton University
            </p>
        </div>
    </div>

  <div class="quarto-title-meta">

        
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">November 8, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#poisson-processes" id="toc-poisson-processes" class="nav-link active" data-scroll-target="#poisson-processes">Poisson Processes</a>
  <ul class="collapse">
  <li><a href="#extra-poisson-processes" id="toc-extra-poisson-processes" class="nav-link" data-scroll-target="#extra-poisson-processes">Extra-poisson processes</a></li>
  <li><a href="#trials" id="toc-trials" class="nav-link" data-scroll-target="#trials">Trials</a></li>
  <li><a href="#incidence-rate-ratios" id="toc-incidence-rate-ratios" class="nav-link" data-scroll-target="#incidence-rate-ratios">Incidence Rate Ratios</a></li>
  <li><a href="#quantities-of-interest" id="toc-quantities-of-interest" class="nav-link" data-scroll-target="#quantities-of-interest">Quantities of Interest</a></li>
  <li><a href="#unobserved-heterogeneity" id="toc-unobserved-heterogeneity" class="nav-link" data-scroll-target="#unobserved-heterogeneity">Unobserved Heterogeneity</a></li>
  <li><a href="#heterogeneity-in-event-data" id="toc-heterogeneity-in-event-data" class="nav-link" data-scroll-target="#heterogeneity-in-event-data">Heterogeneity in Event Data</a></li>
  <li><a href="#heterogeneity-in-failuresurvival-time-data" id="toc-heterogeneity-in-failuresurvival-time-data" class="nav-link" data-scroll-target="#heterogeneity-in-failuresurvival-time-data">Heterogeneity in Failure/Survival Time Data</a></li>
  <li><a href="#heterogeneity" id="toc-heterogeneity" class="nav-link" data-scroll-target="#heterogeneity">Heterogeneity</a></li>
  <li><a href="#what-do-we-mean-exactly-by-heterogeneity" id="toc-what-do-we-mean-exactly-by-heterogeneity" class="nav-link" data-scroll-target="#what-do-we-mean-exactly-by-heterogeneity">What do we mean exactly by heterogeneity?</a>
  <ul class="collapse">
  <li><a href="#eventsperiods-from-different-distributions" id="toc-eventsperiods-from-different-distributions" class="nav-link" data-scroll-target="#eventsperiods-from-different-distributions">Events/Periods from Different Distributions</a></li>
  <li><a href="#different-parts-of-distribution" id="toc-different-parts-of-distribution" class="nav-link" data-scroll-target="#different-parts-of-distribution">Different Parts of Distribution</a></li>
  <li><a href="#different-dgps-indicate-different-mechanisms" id="toc-different-dgps-indicate-different-mechanisms" class="nav-link" data-scroll-target="#different-dgps-indicate-different-mechanisms">Different DGPs indicate different mechanisms</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#motivating-models" id="toc-motivating-models" class="nav-link" data-scroll-target="#motivating-models">Motivating models</a>
  <ul class="collapse">
  <li><a href="#mechanics" id="toc-mechanics" class="nav-link" data-scroll-target="#mechanics">Mechanics</a></li>
  <li><a href="#split-populations" id="toc-split-populations" class="nav-link" data-scroll-target="#split-populations">Split Populations</a></li>
  <li><a href="#dual-regimes" id="toc-dual-regimes" class="nav-link" data-scroll-target="#dual-regimes">Dual Regimes</a></li>
  </ul></li>
  <li><a href="#zero-inflated-event-counts" id="toc-zero-inflated-event-counts" class="nav-link" data-scroll-target="#zero-inflated-event-counts">Zero Inflated Event Counts</a></li>
  <li><a href="#examples" id="toc-examples" class="nav-link" data-scroll-target="#examples">Examples</a>
  <ul class="collapse">
  <li><a href="#opportunities-to-use-force-abroad" id="toc-opportunities-to-use-force-abroad" class="nav-link" data-scroll-target="#opportunities-to-use-force-abroad">Opportunities to use force abroad</a></li>
  <li><a href="#comment" id="toc-comment" class="nav-link" data-scroll-target="#comment">Comment</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<!-- rm(list=ls()) -->
<p><img src="paranormal.jpeg" class="img-fluid"></p>
<section id="poisson-processes" class="level1">
<h1>Poisson Processes</h1>
<ul>
<li>constant rate of arrival of events, <span class="math inline">\(\lambda\)</span>.</li>
<li><span class="math inline">\(\lambda\)</span> is the expected number of events per period, <span class="math inline">\(d\)</span>.</li>
<li>event probability per period is <span class="math inline">\(\lambda d\)</span></li>
<li>events arrive independently of one another in each period.</li>
<li>constant rate of arrival and event independence imply mean-variance equality.</li>
</ul>
<section id="extra-poisson-processes" class="level2">
<h2 class="anchored" data-anchor-id="extra-poisson-processes">Extra-poisson processes</h2>
<ul>
<li>The occurrence of one event increases/decreases the chances of a second event.</li>
<li>This might occur due to positive/negative contagion.</li>
<li>The result is observations of <span class="math inline">\(y\)</span> with larger/smaller observed numbers of events.</li>
<li>This increases/decreases the mean relative to the variance; this is over/under dispersion.</li>
<li>The negative binomial measures the ``extra’’ variance, <span class="math inline">\(\alpha\)</span>. If <span class="math inline">\(\alpha=0\)</span>, the variance is <span class="math inline">\(exp(0)*\lambda=\lambda\)</span>, so the variance is Poisson.</li>
</ul>
</section>
<section id="trials" class="level2">
<h2 class="anchored" data-anchor-id="trials">Trials</h2>
<p>If we have events coded as a binary variable indicating successes and failures, and we know the number of trials, the data are binomial, and probably should {<em>not</em>} be aggregated and treated as Poisson.</p>
<p>Relatedly, we often assume the number of trials, <span class="math inline">\(M\)</span> is infinite - i.e., an infinite number of events {<em>could</em>} occur in each period. But sometimes, we know <span class="math inline">\(M\)</span>, and that it is {<em>not</em>} infinite, and that no number of events greater than <span class="math inline">\(M\)</span> could take place in period <span class="math inline">\(d\)</span>. Think of this known number of trials as {<strong>exposure</strong>} or the maximum number of times an event could possibly occur in a period.</p>
<p>If exposure, is neither infinite nor constant, it’s important to control for it in the model:</p>
<p><span class="math display">\[E[Y] = exp(x\beta + \ln(exposure))\]</span></p>
<p>where the coefficient on exposure is fixed at 1. Note this reduces to <span class="math inline">\(\lambda*M\)</span> or the rate of event arrival given the number of trials. The rate is now proportional to trials or exposure.\ ~\</p>
<p>For instance, suppose we model the number of deaths by terror attack per attack. Exposure for attacks in crowded markets would be different from exposure for attacks in relatively deserted roadsides. Alternatively, exposure for number of flu cases per household would be limited by the size of the household.</p>
</section>
<section id="incidence-rate-ratios" class="level2">
<h2 class="anchored" data-anchor-id="incidence-rate-ratios">Incidence Rate Ratios</h2>
<p>Note that the estimate <span class="math inline">\(\hat{\lambda}\)</span> is a rate. That rate measured at two values of a variable, say <span class="math inline">\(X=0, X=1\)</span> can be written as a ratio (the Incidence Rate Ratio, IRR):</p>
<p><span class="math display">\[\frac{\hat{\lambda}|X=1}{\hat{\lambda}|X=0} = \frac{x\hat{\beta}+(X=1)*\hat{\beta_x}}{x\hat{\beta}+(X=0)*\hat{\beta_x}} = exp(\hat{\beta_x})\]</span></p>
<p>which we can interpret as the change in the incidence rate, <span class="math inline">\(\lambda\)</span> given a change in <span class="math inline">\(X\)</span> from zero to one. This is an easy interpretation, useful to report for count models.</p>
</section>
<section id="quantities-of-interest" class="level2">
<h2 class="anchored" data-anchor-id="quantities-of-interest">Quantities of Interest</h2>
<ul>
<li>the rate of event occurrence, <span class="math inline">\(\lambda = exp(x\beta)\)</span>. -<span class="math inline">\(Pr(Y=y) = \frac{exp(-\lambda) * \lambda^y_i}{y_i !}\)</span></li>
<li>confidence bounds given by <span class="math inline">\(\lambda \pm 1.96*s.e.\)</span> or by something similar for the Poisson probability.</li>
</ul>
</section>
<section id="unobserved-heterogeneity" class="level2">
<h2 class="anchored" data-anchor-id="unobserved-heterogeneity">Unobserved Heterogeneity</h2>
<p>A problem in any model is unobserved heterogeneity. In nonlinear models, the problem is acute because misspecification may have to do with</p>
<ul>
<li>missing variables.</li>
<li>outliers on <span class="math inline">\(y\)</span>.</li>
<li>functional form of <span class="math inline">\(x\)</span> or <span class="math inline">\(\beta\)</span>.</li>
<li>assumed homogeneity in observations on <span class="math inline">\(y\)</span>.</li>
<li>assumed homogeneity in the rate of change across <span class="math inline">\(y\)</span>.</li>
<li>assumed homogeneity in DGP with respect to <span class="math inline">\(y\)</span>.</li>
</ul>
<p>Event count and hazard models provide a variety of mechanisms for thinking about these problems, for accounting for them mechanically, and for modeling heterogeneity.</p>
</section>
<section id="heterogeneity-in-event-data" class="level2">
<h2 class="anchored" data-anchor-id="heterogeneity-in-event-data">Heterogeneity in Event Data</h2>
<p>Let’s talk about things we might be concerned with in events data:</p>
<ul>
<li>frequency distribution of events.</li>
<li>similarity of events within period.</li>
<li>similarity of periods, not just in length but in exposure for events.</li>
<li>differences in reasons for non occurrence.</li>
<li>correlation of events within period.</li>
</ul>
</section>
<section id="heterogeneity-in-failuresurvival-time-data" class="level2">
<h2 class="anchored" data-anchor-id="heterogeneity-in-failuresurvival-time-data">Heterogeneity in Failure/Survival Time Data</h2>
<p>And compare those things to what we might be concerned about in time to failure (hazard) data:</p>
<ul>
<li>distribution of time periods between events/failures - label these ``failure times.’’</li>
<li>similarity of failure times.</li>
<li>similarity of failure events.</li>
<li>censored cases; why some cases never have failure events.</li>
<li>correlation of failure probabilities within period.</li>
</ul>
</section>
<section id="heterogeneity" class="level2">
<h2 class="anchored" data-anchor-id="heterogeneity">Heterogeneity</h2>
<p>Notice in both lists that the problems all lie in heterogeneity either in events, periods between events, or latent probabilities of events.</p>
</section>
<section id="what-do-we-mean-exactly-by-heterogeneity" class="level2">
<h2 class="anchored" data-anchor-id="what-do-we-mean-exactly-by-heterogeneity">What do we mean exactly by heterogeneity?</h2>
<ul>
<li>events/periods are qualitatively different such that we cannot expect the same process to produce them all.</li>
<li>put differently, events are drawn from different distributions of events; different means, variances, or both.</li>
<li>if the means are different, <span class="math inline">\(\beta\)</span> will be attenuated.</li>
<li>if the variances are different, the model suffers something like heteroskedasticity.</li>
<li>even if events are drawn from the same distribution, they may come from different parts of the distribution. % - if <span class="math inline">\(x\)</span> variables are not correlated (sufficient to explain) the whole distribution, some events are unmodeled and skew conditional expected mean and variance.</li>
</ul>
<section id="eventsperiods-from-different-distributions" class="level3">
<h3 class="anchored" data-anchor-id="eventsperiods-from-different-distributions">Events/Periods from Different Distributions</h3>
<ul>
<li>World War II, Vietnam, Franco-Prussian, Football - vary on magnitude, participants, rules, weaponry.</li>
<li>Interstate war, Civil war, Extra-systemic war - different units.</li>
<li>Relevant, irrelevant dyads - imperfect measurement; split outcomes; continuous latent variable.</li>
<li>Patients visiting general practitioners in US - varies with insurance and wages.</li>
<li>Taylor Swift concerts attended - varies in times on tour, proximity to event</li>
<li>Visits to Disney World per year (time between visits) - proximity and number of children as exposure.</li>
</ul>
</section>
<section id="different-parts-of-distribution" class="level3">
<h3 class="anchored" data-anchor-id="different-parts-of-distribution">Different Parts of Distribution</h3>
<ul>
<li>Effect of divided govt - different pre-cold war, cold war.</li>
<li>Power status changes as states become major or super powers, others decline</li>
</ul>
</section>
<section id="different-dgps-indicate-different-mechanisms" class="level3">
<h3 class="anchored" data-anchor-id="different-dgps-indicate-different-mechanisms">Different DGPs indicate different mechanisms</h3>
<ul>
<li><p>Different distributions implies different data generating processes and that we need to think about models with two parts, potentially two equations.</p></li>
<li><p>This sort of thinking characterizes event count, hazard, censored, selection, and seemingly unrelated regression models.</p></li>
<li><p>The focus here is on count models where the observed count is generated by multiple processes.</p></li>
</ul>
</section>
</section>
</section>
<section id="motivating-models" class="level1">
<h1>Motivating models</h1>
<p>The formal motivations of these models is straightforward enough. Motivating a mechanism, however, is more complicated and more important. The common empirical indicator of multiple DGPs is excess zeros. But excess zeros does not guarantee two processes are at work, nor that we know what they are even if they do.</p>
<p>Short version - use these if your theory indicates parallel processes at work, not merely because the data are dominated by zeros.</p>
<section id="mechanics" class="level2">
<h2 class="anchored" data-anchor-id="mechanics">Mechanics</h2>
<p>Suppose that we have count data that contains a large number of zeros.</p>
<ul>
<li>The zeros reduce both the mean and the variance.</li>
<li>The variance is likely to be larger than the mean due to any positive counts.</li>
<li>An overabundance of zeros can produce overdispersion; a large conditional variance relative to the mean.<br>
</li>
<li>This sounds like garden-variety unobserved heterogeneity; we haven’t sufficiently modeled the zeros in the data. While this might be true, another possibility exists.</li>
</ul>
</section>
<section id="split-populations" class="level2">
<h2 class="anchored" data-anchor-id="split-populations">Split Populations</h2>
<p>Suppose that two different processes actually generate the data we observe in our event count variable. One process determines whether or not we will <em>ever</em> have any chance of observing positive (nonzero) numbers of events; that is, it determines <span class="math inline">\(Pr(y_i=0)\)</span>.</p>
<p>The second process determines <em>how many</em> events we will observe, given that we have any probability of observing nonzero events, <span class="math inline">\(Pr(y_i=j)\)</span>.</p>
<p>The generality of this allows us to distinguish two basic models. If our story tells us to expect,</p>
<p><span class="math display">\[
Pr(y_i&gt;j, \forall j&gt;0)|Pr(y_i&gt;0)
\]</span></p>
<p>then we have something like the hurdle poisson model. On the other hand, if our story says</p>
<p><span class="math display">\[
Pr(y_i&gt;j, \forall j \geq 0|Pr(y_i&gt;0)
\]</span></p>
<p>then we have something like the zero inflated model. I’m going to focus on the zero inflated models.</p>
<p>Let’s consider two stories to illustrate (the first drawn from Green via Zorn (1998, 372), the other from the IR literature).</p>
<p>Suppose we want to know how many times individuals have fished in a particular lake. Some individuals will answer that they have never fished in that lake because they’ve simply never gone there, preferring other fishing holes. These individuals are <em>at risk</em> for having fished there, but haven’t for exogenous reasons. Other individuals, however, will respond that they’ve never fished in the lake and probably never will because they don’t fish, don’t own fishing gear, and hate the water. These folks are never <em>at risk</em> of fishing there any positive number of times - they will always receive zeros in the data.</p>
<p>The problem is that the data have plenty of zeros (“No, I’ve never fished there”), but the zeros can mean two substantively different things - “I could have, but didn’t” for some reason (I live too far away, etc.) and “I hate fish.” Some process determines whether or not an individual crosses the threshold from “always-zero” into the “possibly, but not inevitably, positive” zone. A second process determines <em>how often</em> an individual actually does fish there, given that they fish at all.</p>
<p>Here’s a second example. The international conflict literature talks at some length about the “opportunity and willingness” to engage in military conflict and claims these are “jointly necessary conditions” for interstate conflict. Typically, IR scholars are adept at identifying variables that represent different facets of “willingness” to fight, but deal less well with whether or not states have the opportunity to fight. Indeed, there’s an empirical literature on the “opportunity” to fight addressing the issue of “political relevance.”</p>
<p>But think about the possibility that two processes generate the data on whether or not or how often states fight one another. One process makes pairs of states either eligible to fight or not; the other process determines how often those states fight, given that they are eligible to do so. Put another way, one process determines whether a dyad has the opportunity to fight, and another process determines the extent to which they are willing to fight and how many disputes the dyad actually has.</p>
</section>
<section id="dual-regimes" class="level2">
<h2 class="anchored" data-anchor-id="dual-regimes">Dual Regimes</h2>
<p>Two <em>regimes</em> generate the observed data. Treating those two data generating processes masks substantial heterogeneity, and so misspecifies the model in structural ways. If we fail to acknowledge the two regimes, we treat them as if they’re the same. So in the case of excess zeros, we treat those zeros as if they’re all generated by the same process.</p>
<p>The underlying problem in either of these examples and in these dual regime models more generally is that even though we might theorize on the two processes, ultimately we cannot look at the zeros in the data and say, “these zeros occur because these states simply lack the opportunity to fight, while those zeros occur because even though states had the opportunity to fight, they chose not to.”’’” In other words, we cannot observe the exact split in the zeros, between the two regimes or processes.</p>
<p>In the count context, we turn to <em>zero inflated</em> count models - these are one type of split population model.</p>
</section>
</section>
<section id="zero-inflated-event-counts" class="level1">
<h1>Zero Inflated Event Counts</h1>
<p>Suppose we have an event count variable <span class="math inline">\(Y\)</span>, but we believe the variable might be produced by two different processes. Then,</p>
<p><span class="math display">\[
y_{i}=p_{i}^{*}y_{i}^{*} \nonumber
\]</span></p>
<p>In this formulation, <span class="math inline">\(p_{i}\)</span> is the probability of any individual makes the transition from the state where he can only experience a zero, to the state where he is eligible to experience a positive number of events; <span class="math inline">\(p_{i}^{*}\)</span> is a dichotmous variable indicating whether or not the individual makes the transition - note that this is very much the intuition underlying binary variable models like probit and logit. <span class="math inline">\(y_{i}^{*}\)</span> is the Poisson distributed event count {<em>for those individuals who make the transition</em>}. Thus, the mean of <span class="math inline">\(y_{i}^{*}\)</span>, <span class="math inline">\(\lambda_{i}\)</span> is conditional on <span class="math inline">\(p_{i}\)</span>.\</p>
<p>Less formally, consider <span class="math inline">\(p_{i}^{*}\)</span> and <span class="math inline">\(Y_{i}^{*}\)</span> as two dependent variables about which we can hypothesize; the first is dichotomous and we can model it using probit or logit; the second is Poisson and we can use Poisson regression (or even negative binomial regression if there are other sources of overdispersion).</p>
<p>Suppose we believe that a set of variables, <span class="math inline">\(z\)</span> produce <span class="math inline">\(p_{i}^{*}\)</span>; let’s label the probability of being a zero (not making the transition) as <span class="math inline">\(\psi\)</span> and we can treat this either as probit,</p>
<p><span class="math display">\[
\psi = \Phi(z_{i} \gamma) \nonumber
\]</span></p>
<p>or logit</p>
<p><span class="math display">\[
\psi = \frac{e^{z_{i}\gamma}}{1+e^{z_{i}\gamma}} \nonumber
\]</span></p>
<p>Now consider <span class="math inline">\(y_{i}^{*}\)</span> which is Poisson distributed and we believe it is a function of some variables, <span class="math inline">\(X\)</span>;</p>
<p><span class="math display">\[
P(Y_{i}=y) = \frac{e^{(-\lambda)} \lambda^{y}}{{y!}} \nonumber
\]</span> and</p>
<p><span class="math display">\[
\lambda_{i} = e^{X_{i} \beta_{i}} \nonumber
\]</span></p>
<p>Now, let’s combine these</p>
<p><span class="math display">\[
P(y_{i}=0|x_{i})=\psi_{i}+(1-\psi_{i})e^{-\lambda_{i}} \nonumber \\ \nonumber \\
P(Y=y_{i}|x_{i})=(1-\psi_{i})\frac{e^{-\lambda_{i}}\lambda_{i}^{y_{i}}}{y_{i}!}~
\mbox{for}~ y_{i}&gt;0  \nonumber
\]</span></p>
<p>This is the Zero Inflated Poisson (ZIP) model. The conditional mean of <span class="math inline">\(Y\)</span>, <span class="math inline">\(\lambda\)</span>, is adjusted for the zeros in the model - the conditional mean is adjusted by a factor of <span class="math inline">\(\psi\)</span>, the probability of {<em>not</em>} experiencing the transition. We can also extend this logic to the negative binomial (ZINB) model, but I’m going to stick with the Poisson for examples below. Long provides a good treatment of the both of these models and their interpretations.</p>
</section>
<section id="examples" class="level1">
<h1>Examples</h1>
<p>In a widely cited paper, <span class="citation" data-cites="fordhamjcr">Fordham (<a href="#ref-fordhamjcr" role="doc-biblioref">1998</a>)</span> argues that US uses of force abroad for political purposes will vary with the political economy concerns of US presidents; those PE concerns vary with party. Republican presidents can better address inflation (a concern of their core constituents) via macroeconomic policy than they can unemployment. Democrats can better deal with unemployment while satisfying their core constituents’ preferences. This means US presidents of different parties should react to economic conditions differently. Democratic presidents should use force less when they face unemployment, more when they face inflation. Republican presidents should use force less when they face inflation, more when they face unemployment.</p>
<p>The <span class="math inline">\(y\)</span> variable in this paper is US uses of force per quarter; let’s take a look at the data.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(haven)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># read in the data</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>fordham <span class="ot">&lt;-</span> <span class="fu">read_dta</span>(<span class="st">"/Users/dave/Documents/teaching/606J-mle/2022/slides/L11_count2/code/fordham98jcr.dta"</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>force <span class="ot">&lt;-</span> fordham <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(force) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">n=</span><span class="fu">n</span>())</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># highcharter aggregated frequency bars of force variable </span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">highchart</span>() <span class="sc">%&gt;%</span> <span class="fu">hc_chart</span>(<span class="at">type =</span> <span class="st">"column"</span>) <span class="sc">%&gt;%</span> <span class="fu">hc_title</span>(<span class="at">text =</span> <span class="st">"Uses of Force"</span>) <span class="sc">%&gt;%</span> <span class="fu">hc_xAxis</span>(<span class="at">categories =</span> force<span class="sc">$</span>force) <span class="sc">%&gt;%</span> <span class="fu">hc_yAxis</span>(<span class="at">title =</span> <span class="fu">list</span>(<span class="at">text =</span> <span class="st">"Frequency"</span>)) <span class="sc">%&gt;%</span> <span class="fu">hc_add_series</span>(<span class="at">name =</span> <span class="st">"Uses of Force"</span>, <span class="at">data =</span> force<span class="sc">$</span>n) <span class="sc">%&gt;%</span> <span class="fu">hc_tooltip</span>(<span class="at">valueDecimals =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> <span class="fu">hc_plotOptions</span>(<span class="at">column =</span> <span class="fu">list</span>(<span class="at">colorByPoint =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span> <span class="fu">hc_colors</span>(<span class="fu">c</span>(<span class="st">"#005A43"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="highchart html-widget html-fill-item" id="htmlwidget-67e2bbd1f2c35352e2d5" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-67e2bbd1f2c35352e2d5">{"x":{"hc_opts":{"chart":{"reflow":true,"type":"column"},"title":{"text":"Uses of Force"},"yAxis":{"title":{"text":"Frequency"}},"credits":{"enabled":false},"exporting":{"enabled":false},"boost":{"enabled":false},"plotOptions":{"series":{"label":{"enabled":false},"turboThreshold":0},"treemap":{"layoutAlgorithm":"squarified"},"column":{"colorByPoint":true}},"xAxis":{"categories":[0,1,2,3,4,5]},"series":[{"data":[95,57,21,9,1,1],"name":"Uses of Force"}],"tooltip":{"valueDecimals":0},"colors":["#005A43"]},"theme":{"chart":{"backgroundColor":"transparent"},"colors":["#7cb5ec","#434348","#90ed7d","#f7a35c","#8085e9","#f15c80","#e4d354","#2b908f","#f45b5b","#91e8e1"]},"conf_opts":{"global":{"Date":null,"VMLRadialGradientURL":"http =//code.highcharts.com/list(version)/gfx/vml-radial-gradient.png","canvasToolsURL":"http =//code.highcharts.com/list(version)/modules/canvas-tools.js","getTimezoneOffset":null,"timezoneOffset":0,"useUTC":true},"lang":{"contextButtonTitle":"Chart context menu","decimalPoint":".","downloadCSV":"Download CSV","downloadJPEG":"Download JPEG image","downloadPDF":"Download PDF document","downloadPNG":"Download PNG image","downloadSVG":"Download SVG vector image","downloadXLS":"Download XLS","drillUpText":"◁ Back to {series.name}","exitFullscreen":"Exit from full screen","exportData":{"annotationHeader":"Annotations","categoryDatetimeHeader":"DateTime","categoryHeader":"Category"},"hideData":"Hide data table","invalidDate":null,"loading":"Loading...","months":["January","February","March","April","May","June","July","August","September","October","November","December"],"noData":"No data to display","numericSymbolMagnitude":1000,"numericSymbols":["k","M","G","T","P","E"],"printChart":"Print chart","resetZoom":"Reset zoom","resetZoomTitle":"Reset zoom level 1:1","shortMonths":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"shortWeekdays":["Sat","Sun","Mon","Tue","Wed","Thu","Fri"],"thousandsSep":" ","viewData":"View data table","viewFullscreen":"View in full screen","weekdays":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]}},"type":"chart","fonts":[],"debug":false},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Here’s a Poisson model similar to what Fordham reports (left column) and a negative binomial model (right column) for comparison.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Poisson model</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(force <span class="sc">~</span> unemp <span class="sc">+</span> cpi <span class="sc">+</span> war <span class="sc">+</span> wecycle <span class="sc">+</span> pecycle <span class="sc">+</span> demunemp <span class="sc">+</span> demcpi, <span class="at">data=</span>fordham, <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>))</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># negative binomial model, MASS library</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>mod1nb <span class="ot">&lt;-</span> <span class="fu">glm.nb</span>(force <span class="sc">~</span> unemp <span class="sc">+</span> cpi <span class="sc">+</span> war <span class="sc">+</span> wecycle <span class="sc">+</span> pecycle <span class="sc">+</span> demunemp <span class="sc">+</span> demcpi, <span class="at">data=</span>fordham)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(<span class="fu">list</span>(mod1, mod1nb), <span class="at">type=</span><span class="st">"html"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<table style="text-align:center">
<tbody><tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="2">
<em>Dependent variable:</em>
</td>
</tr>
<tr>
<td>
</td>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="2">
force
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
<em>Poisson</em>
</td>
<td>
<em>negative</em>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
<em></em>
</td>
<td>
<em>binomial</em>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(1)
</td>
<td>
(2)
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
unemp
</td>
<td>
0.150<sup>**</sup>
</td>
<td>
0.150<sup>**</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.060)
</td>
<td>
(0.063)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
cpi
</td>
<td>
-0.087<sup>**</sup>
</td>
<td>
-0.087<sup>**</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.040)
</td>
<td>
(0.041)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
war
</td>
<td>
-0.542<sup>*</sup>
</td>
<td>
-0.542<sup>*</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.281)
</td>
<td>
(0.290)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
wecycle
</td>
<td>
0.965<sup>***</sup>
</td>
<td>
0.974<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.307)
</td>
<td>
(0.320)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
pecycle
</td>
<td>
0.023
</td>
<td>
0.024
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.237)
</td>
<td>
(0.247)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
demunemp
</td>
<td>
-0.100<sup>*</sup>
</td>
<td>
-0.101<sup>*</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.051)
</td>
<td>
(0.053)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
demcpi
</td>
<td>
0.082
</td>
<td>
0.083
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.057)
</td>
<td>
(0.059)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
-0.785<sup>*</sup>
</td>
<td>
-0.787<sup>*</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.427)
</td>
<td>
(0.446)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
184
</td>
<td>
184
</td>
</tr>
<tr>
<td style="text-align:left">
Log Likelihood
</td>
<td>
-202.887
</td>
<td>
-203.646
</td>
</tr>
<tr>
<td style="text-align:left">
theta
</td>
<td>
</td>
<td>
10.327 (16.120)
</td>
</tr>
<tr>
<td style="text-align:left">
Akaike Inf. Crit.
</td>
<td>
421.773
</td>
<td>
423.292
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td colspan="2" style="text-align:right">
<sup><em></em></sup><em>p&lt;0.1; <sup><strong></strong></sup><strong>p&lt;0.05; <sup></sup></strong></em>p&lt;0.01
</td>
</tr>
</tbody></table>
</div>
<p>Recall the dispersion parameter is given by</p>
<p><span class="math display">\[
\alpha = \frac{1}{\hat{\theta}} \nonumber
\]</span></p>
<p>In this case, 0.097 - very small in magnitude, and not statistically different from zero, indicating the Poisson is the correct model. Despite the abundance of zeros, the count variable does not have much in the way of outliers at its upper bound, constraining the variance.</p>
<p>Here are predictions from the Poisson regression similar to what he reports:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#predict uses of force over unemp from min to max; all other variables at medians</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>predictiondatadem <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">unemp=</span><span class="fu">seq</span>(<span class="fu">min</span>(fordham<span class="sc">$</span>unemp), <span class="fu">max</span>(fordham<span class="sc">$</span>unemp), <span class="at">length.out=</span><span class="dv">100</span>), <span class="at">cpi=</span><span class="fu">median</span>(fordham<span class="sc">$</span>cpi), <span class="at">war=</span><span class="dv">0</span>, <span class="at">wecycle=</span><span class="dv">0</span>, <span class="at">pecycle=</span><span class="dv">0</span>, <span class="at">demunemp=</span><span class="fu">seq</span>(<span class="fu">min</span>(fordham<span class="sc">$</span>unemp), <span class="fu">max</span>(fordham<span class="sc">$</span>unemp), <span class="at">length.out=</span><span class="dv">100</span>), <span class="at">demcpi=</span><span class="fu">median</span>(fordham<span class="sc">$</span>demcpi))</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>predictiondatarep <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">unemp=</span><span class="fu">seq</span>(<span class="fu">min</span>(fordham<span class="sc">$</span>unemp), <span class="fu">max</span>(fordham<span class="sc">$</span>unemp), <span class="at">length.out=</span><span class="dv">100</span>), <span class="at">cpi=</span><span class="fu">median</span>(fordham<span class="sc">$</span>cpi), <span class="at">war=</span><span class="dv">0</span>, <span class="at">wecycle=</span><span class="dv">0</span>, <span class="at">pecycle=</span><span class="dv">0</span>, <span class="at">demunemp=</span><span class="dv">0</span>, <span class="at">demcpi=</span><span class="dv">0</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">predict</span>(mod1, <span class="at">newdata=</span>predictiondatadem, <span class="at">type=</span><span class="st">"response"</span>, <span class="at">se=</span><span class="cn">TRUE</span>))</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(preds, <span class="fu">predict</span>(mod1, <span class="at">newdata=</span>predictiondatarep, <span class="at">type=</span><span class="st">"response"</span>, <span class="at">se=</span><span class="cn">TRUE</span>), <span class="at">unemp=</span>predictiondatadem<span class="sc">$</span>unemp)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">&lt;-</span> preds <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">dem=</span>fit, <span class="at">demse=</span>se.fit, <span class="at">rep=</span>fit<span class="fl">.1</span>, <span class="at">repse=</span>se.fit<span class="fl">.1</span>)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(preds, <span class="fu">aes</span>(<span class="at">x=</span>unemp, <span class="at">y=</span>dem, <span class="at">ymin=</span>dem<span class="sc">-</span>demse, <span class="at">ymax=</span>dem<span class="sc">+</span>demse)) <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="at">color=</span><span class="st">"blue"</span>) <span class="sc">+</span> <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>dem<span class="sc">-</span>demse, <span class="at">ymax=</span>dem<span class="sc">+</span>demse), <span class="at">fill=</span><span class="st">"blue"</span>, <span class="at">alpha=</span>.<span class="dv">2</span>) <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>unemp, <span class="at">y=</span>rep), <span class="at">color=</span><span class="st">"red"</span>) <span class="sc">+</span> <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>rep<span class="sc">-</span>repse, <span class="at">ymax=</span>rep<span class="sc">+</span>repse), <span class="at">fill=</span><span class="st">"red"</span>, <span class="at">alpha=</span>.<span class="dv">2</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Uses of Force"</span>, <span class="at">x=</span><span class="st">"Unemployment"</span>, <span class="at">y=</span><span class="st">"Expected Uses of Force"</span>) <span class="sc">+</span> <span class="fu">theme_minimal</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="countB24_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Consistent with Fordham’s expectations, Democratic presidents are less reactive to unemployment in terms of using force abroad than are Republicans. As unemployment mounts, Republican presidents are more likely to use force abroad, while Democrats may be more likely to use macroeconomic policy because they can do so while satisfying their core constituents.</p>
<section id="opportunities-to-use-force-abroad" class="level2">
<h2 class="anchored" data-anchor-id="opportunities-to-use-force-abroad">Opportunities to use force abroad</h2>
<p>One of the enduring problems in studies examining this very question is whether the opportunity to use force is always present or if it varies in some way. Some formal work argues that, because potential US targets (scapegoats) can observe when the US president is in need of a rally of some sort, those targets can behave uncontroversially in order to avoid becoming targets. As a result, just when US presidents most need a target, they are least likely to find one - thus, opportunities are not constant and they are not randomly determined.</p>
<p>In other words, opportunities to use force may be endogenous to the same variables that determine the likelihood of using force.</p>
<p>Taking a look at Fordham’s dependent variable, we can find some evidence that a second process (determining opportunities) might be at work:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># kableextra table of force frequency and percentages rounded to 2 decimal places</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>fordham <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(force) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">n=</span><span class="fu">n</span>(), <span class="at">percent=</span><span class="fu">round</span>(<span class="fu">n</span>()<span class="sc">/</span><span class="fu">nrow</span>(fordham)<span class="sc">*</span><span class="dv">100</span>, <span class="dv">2</span>)) <span class="sc">%&gt;%</span> <span class="fu">kable</span>(<span class="st">"html"</span>) <span class="sc">%&gt;%</span> <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>, <span class="st">"responsive"</span>), <span class="at">full_width =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="table-responsive">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">force</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">n</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">percent</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">95</td>
<td style="text-align: right;">51.63</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">57</td>
<td style="text-align: right;">30.98</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">11.41</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">4.89</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.54</td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.54</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>More than 50% of the observations are zeros - is this because US leaders <strong>choose</strong> not to use force more than half the time, or because they <strong>cannot</strong> use force? This is unobserved, but regardless, the overabundance of zeros is likely to pull the mean down relative to the variance and thus produce over-dispersion.</p>
<p>Suppose we model these two processes even though they are unobserved. According to existing work, some of the same variables that make presidents use force abroad (the economy, etc.) will also influence the availability of opportunities to use force, and thus will influence the likelihood of a zero. Consider the following model:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># zero inflated poisson model using pscl</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pscl)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span> <span class="fu">zeroinfl</span>(force <span class="sc">~</span> unemp <span class="sc">+</span> cpi <span class="sc">+</span> war <span class="sc">+</span> wecycle <span class="sc">+</span> pecycle <span class="sc">+</span> demunemp <span class="sc">+</span> demcpi  <span class="sc">|</span> unemp  <span class="sc">+</span> war <span class="sc">+</span> wecycle <span class="sc">+</span> pecycle <span class="sc">+</span> demunemp <span class="sc">+</span>approval <span class="sc">+</span>vietsynd   , <span class="at">data=</span>fordham, <span class="at">dist=</span><span class="st">"poisson"</span>, <span class="at">link=</span><span class="st">"logit"</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelsummary)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(mod2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<!-- preamble start -->

    <script>
      function styleCell_eik87tse655x8y4um8on(i, j, css_id) {
        var table = document.getElementById("tinytable_eik87tse655x8y4um8on");
        table.rows[i].cells[j].classList.add(css_id);
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_eik87tse655x8y4um8on');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_eik87tse655x8y4um8on(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_eik87tse655x8y4um8on");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(0, 0, 'tinytable_css_id4sh9z27vokap6ywb2oog') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(0, 1, 'tinytable_css_iddsu0d2kx08q9foc7m8vm') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(1, 0, 'tinytable_css_idrr1l8jrohlk8y0jglshb') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(1, 1, 'tinytable_css_id37ylyuftu522pb8mn40l') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(2, 0, 'tinytable_css_idrr1l8jrohlk8y0jglshb') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(2, 1, 'tinytable_css_id37ylyuftu522pb8mn40l') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(3, 0, 'tinytable_css_idrr1l8jrohlk8y0jglshb') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(3, 1, 'tinytable_css_id37ylyuftu522pb8mn40l') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(4, 0, 'tinytable_css_idrr1l8jrohlk8y0jglshb') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(4, 1, 'tinytable_css_id37ylyuftu522pb8mn40l') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(5, 0, 'tinytable_css_idrr1l8jrohlk8y0jglshb') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(5, 1, 'tinytable_css_id37ylyuftu522pb8mn40l') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(6, 0, 'tinytable_css_idrr1l8jrohlk8y0jglshb') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(6, 1, 'tinytable_css_id37ylyuftu522pb8mn40l') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(7, 0, 'tinytable_css_idrr1l8jrohlk8y0jglshb') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(7, 1, 'tinytable_css_id37ylyuftu522pb8mn40l') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(8, 0, 'tinytable_css_idrr1l8jrohlk8y0jglshb') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(8, 1, 'tinytable_css_id37ylyuftu522pb8mn40l') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(9, 0, 'tinytable_css_idrr1l8jrohlk8y0jglshb') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(9, 1, 'tinytable_css_id37ylyuftu522pb8mn40l') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(10, 0, 'tinytable_css_idrr1l8jrohlk8y0jglshb') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(10, 1, 'tinytable_css_id37ylyuftu522pb8mn40l') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(11, 0, 'tinytable_css_idrr1l8jrohlk8y0jglshb') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(11, 1, 'tinytable_css_id37ylyuftu522pb8mn40l') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(12, 0, 'tinytable_css_idrr1l8jrohlk8y0jglshb') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(12, 1, 'tinytable_css_id37ylyuftu522pb8mn40l') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(13, 0, 'tinytable_css_idrr1l8jrohlk8y0jglshb') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(13, 1, 'tinytable_css_id37ylyuftu522pb8mn40l') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(14, 0, 'tinytable_css_idrr1l8jrohlk8y0jglshb') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(14, 1, 'tinytable_css_id37ylyuftu522pb8mn40l') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(15, 0, 'tinytable_css_idrr1l8jrohlk8y0jglshb') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(15, 1, 'tinytable_css_id37ylyuftu522pb8mn40l') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(16, 0, 'tinytable_css_idrr1l8jrohlk8y0jglshb') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(16, 1, 'tinytable_css_id37ylyuftu522pb8mn40l') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(17, 0, 'tinytable_css_idrr1l8jrohlk8y0jglshb') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(17, 1, 'tinytable_css_id37ylyuftu522pb8mn40l') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(18, 0, 'tinytable_css_idrr1l8jrohlk8y0jglshb') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(18, 1, 'tinytable_css_id37ylyuftu522pb8mn40l') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(19, 0, 'tinytable_css_idrr1l8jrohlk8y0jglshb') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(19, 1, 'tinytable_css_id37ylyuftu522pb8mn40l') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(20, 0, 'tinytable_css_idrr1l8jrohlk8y0jglshb') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(20, 1, 'tinytable_css_id37ylyuftu522pb8mn40l') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(21, 0, 'tinytable_css_idrr1l8jrohlk8y0jglshb') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(21, 1, 'tinytable_css_id37ylyuftu522pb8mn40l') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(22, 0, 'tinytable_css_idrr1l8jrohlk8y0jglshb') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(22, 1, 'tinytable_css_id37ylyuftu522pb8mn40l') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(23, 0, 'tinytable_css_idrr1l8jrohlk8y0jglshb') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(23, 1, 'tinytable_css_id37ylyuftu522pb8mn40l') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(24, 0, 'tinytable_css_idrr1l8jrohlk8y0jglshb') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(24, 1, 'tinytable_css_id37ylyuftu522pb8mn40l') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(25, 0, 'tinytable_css_idrr1l8jrohlk8y0jglshb') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(25, 1, 'tinytable_css_id37ylyuftu522pb8mn40l') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(26, 0, 'tinytable_css_idrr1l8jrohlk8y0jglshb') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(26, 1, 'tinytable_css_id37ylyuftu522pb8mn40l') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(27, 0, 'tinytable_css_idrr1l8jrohlk8y0jglshb') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(27, 1, 'tinytable_css_id37ylyuftu522pb8mn40l') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(28, 0, 'tinytable_css_idrr1l8jrohlk8y0jglshb') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(28, 1, 'tinytable_css_id37ylyuftu522pb8mn40l') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(29, 0, 'tinytable_css_idrr1l8jrohlk8y0jglshb') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(29, 1, 'tinytable_css_id37ylyuftu522pb8mn40l') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(30, 0, 'tinytable_css_idrr1l8jrohlk8y0jglshb') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(30, 1, 'tinytable_css_id37ylyuftu522pb8mn40l') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(31, 0, 'tinytable_css_idrr1l8jrohlk8y0jglshb') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(31, 1, 'tinytable_css_id37ylyuftu522pb8mn40l') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(32, 0, 'tinytable_css_iduak0henrn0kfgpxmsxbt') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(32, 1, 'tinytable_css_idh418c7vfpac532mm7iio') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(33, 0, 'tinytable_css_idrr1l8jrohlk8y0jglshb') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(33, 1, 'tinytable_css_id37ylyuftu522pb8mn40l') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(34, 0, 'tinytable_css_idrr1l8jrohlk8y0jglshb') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(34, 1, 'tinytable_css_id37ylyuftu522pb8mn40l') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(35, 0, 'tinytable_css_idrr1l8jrohlk8y0jglshb') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(35, 1, 'tinytable_css_id37ylyuftu522pb8mn40l') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(36, 0, 'tinytable_css_idrr1l8jrohlk8y0jglshb') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(36, 1, 'tinytable_css_id37ylyuftu522pb8mn40l') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(37, 0, 'tinytable_css_idrr1l8jrohlk8y0jglshb') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(37, 1, 'tinytable_css_id37ylyuftu522pb8mn40l') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(38, 0, 'tinytable_css_idrr1l8jrohlk8y0jglshb') })
window.addEventListener('load', function () { styleCell_eik87tse655x8y4um8on(38, 1, 'tinytable_css_id37ylyuftu522pb8mn40l') })
    </script>

    <style>
    .table td.tinytable_css_id4sh9z27vokap6ywb2oog, .table th.tinytable_css_id4sh9z27vokap6ywb2oog {  text-align: left;  border-bottom: solid 0.1em #d3d8dc; }
    .table td.tinytable_css_iddsu0d2kx08q9foc7m8vm, .table th.tinytable_css_iddsu0d2kx08q9foc7m8vm {  text-align: center;  border-bottom: solid 0.1em #d3d8dc; }
    .table td.tinytable_css_idrr1l8jrohlk8y0jglshb, .table th.tinytable_css_idrr1l8jrohlk8y0jglshb {  text-align: left; }
    .table td.tinytable_css_id37ylyuftu522pb8mn40l, .table th.tinytable_css_id37ylyuftu522pb8mn40l {  text-align: center; }
    .table td.tinytable_css_iduak0henrn0kfgpxmsxbt, .table th.tinytable_css_iduak0henrn0kfgpxmsxbt {  border-bottom: solid 0.05em black;  text-align: left; }
    .table td.tinytable_css_idh418c7vfpac532mm7iio, .table th.tinytable_css_idh418c7vfpac532mm7iio {  border-bottom: solid 0.05em black;  text-align: center; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_eik87tse655x8y4um8on" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col"> </th>
                <th scope="col">(1)</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>count_(Intercept)</td>
                  <td>-1.263   </td>
                </tr>
                <tr>
                  <td>                 </td>
                  <td>(0.466)  </td>
                </tr>
                <tr>
                  <td>count_unemp      </td>
                  <td>0.223    </td>
                </tr>
                <tr>
                  <td>                 </td>
                  <td>(0.066)  </td>
                </tr>
                <tr>
                  <td>count_cpi        </td>
                  <td>-0.078   </td>
                </tr>
                <tr>
                  <td>                 </td>
                  <td>(0.040)  </td>
                </tr>
                <tr>
                  <td>count_war        </td>
                  <td>-0.614   </td>
                </tr>
                <tr>
                  <td>                 </td>
                  <td>(0.285)  </td>
                </tr>
                <tr>
                  <td>count_wecycle    </td>
                  <td>0.881    </td>
                </tr>
                <tr>
                  <td>                 </td>
                  <td>(0.306)  </td>
                </tr>
                <tr>
                  <td>count_pecycle    </td>
                  <td>0.001    </td>
                </tr>
                <tr>
                  <td>                 </td>
                  <td>(0.244)  </td>
                </tr>
                <tr>
                  <td>count_demunemp   </td>
                  <td>-0.037   </td>
                </tr>
                <tr>
                  <td>                 </td>
                  <td>(0.054)  </td>
                </tr>
                <tr>
                  <td>count_demcpi     </td>
                  <td>0.127    </td>
                </tr>
                <tr>
                  <td>                 </td>
                  <td>(0.056)  </td>
                </tr>
                <tr>
                  <td>zero_(Intercept) </td>
                  <td>-15.845  </td>
                </tr>
                <tr>
                  <td>                 </td>
                  <td>(12.166) </td>
                </tr>
                <tr>
                  <td>zero_unemp       </td>
                  <td>2.101    </td>
                </tr>
                <tr>
                  <td>                 </td>
                  <td>(1.357)  </td>
                </tr>
                <tr>
                  <td>zero_war         </td>
                  <td>-7.129   </td>
                </tr>
                <tr>
                  <td>                 </td>
                  <td>(706.556)</td>
                </tr>
                <tr>
                  <td>zero_wecycle     </td>
                  <td>-3.442   </td>
                </tr>
                <tr>
                  <td>                 </td>
                  <td>(242.892)</td>
                </tr>
                <tr>
                  <td>zero_pecycle     </td>
                  <td>-3.636   </td>
                </tr>
                <tr>
                  <td>                 </td>
                  <td>(3.309)  </td>
                </tr>
                <tr>
                  <td>zero_demunemp    </td>
                  <td>1.431    </td>
                </tr>
                <tr>
                  <td>                 </td>
                  <td>(0.821)  </td>
                </tr>
                <tr>
                  <td>zero_approval    </td>
                  <td>-0.153   </td>
                </tr>
                <tr>
                  <td>                 </td>
                  <td>(0.083)  </td>
                </tr>
                <tr>
                  <td>zero_vietsynd    </td>
                  <td>2.268    </td>
                </tr>
                <tr>
                  <td>                 </td>
                  <td>(1.458)  </td>
                </tr>
                <tr>
                  <td>Num.Obs.         </td>
                  <td>184      </td>
                </tr>
                <tr>
                  <td>R2               </td>
                  <td>0.133    </td>
                </tr>
                <tr>
                  <td>R2 Adj.          </td>
                  <td>0.093    </td>
                </tr>
                <tr>
                  <td>AIC              </td>
                  <td>417.4    </td>
                </tr>
                <tr>
                  <td>BIC              </td>
                  <td>468.8    </td>
                </tr>
                <tr>
                  <td>RMSE             </td>
                  <td>0.86     </td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
<p>Interpretation, as usual, is relatively straightforward in terms of direction and significance, but there is one important twist. Recall that <span class="math inline">\(\psi\)</span> is the <strong>probability of not making the transition</strong>. In other words, <span class="math inline">\(\psi\)</span> is the probability of observing a zero - this is exactly backwards from how we’d normally interpret logit or probit coefficients (note the default in <code>pscl</code> is the logit link). So, as unemployment increases, so does the likelihood of observing a zero for Republican presidents - for Democrats, the effect is even greater. This may be evidence that foreign states seek to avoid trouble with the US when unemployment goes up - opportunities to use force become more scarce.</p>
<p>As usual, we want to interpret the magnitudes of these effects and, as is the case in any event count, we might want to predict <span class="math inline">\(E[Y]\)</span> or <span class="math inline">\(P(Y=y_{i})\)</span>. You’ll be happy to know that the computing the expected value is very simple:</p>
<p><span class="math display">\[
E[Y] = \lambda - \lambda \psi \nonumber \\ \nonumber \\
= e^{X_{i}\beta_{i}} - e^{X_{i}\beta_{i}} \psi \nonumber
\]</span></p>
<p>and computing <span class="math inline">\(P(Y=y_{i})\)</span> is also straightforward:</p>
<p><span class="math display">\[
P(y_{i}=0|x_{i})=\psi_{i}+(1-\psi_{i})e^{-\lambda_{i}} \nonumber \\ \nonumber \\
P(Y=y_{i}|x_{i})=(1-\psi_{i})\frac{e^{-\lambda_{i}}\lambda_{i}^{y_{i}}}{y_{i}!}~
\mbox{for}~ y_{i}&gt;0  \nonumber
\]</span> Let’s generate predictions for the expected uses of force using the zero inflated model.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># predict expected uses of force using predictiondatadem and predictiondatarep</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>predictiondatadem <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(predictiondatadem, <span class="at">approval=</span><span class="dv">55</span>, <span class="at">vietsynd=</span><span class="dv">0</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>predictiondatarep <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(predictiondatarep, <span class="at">approval=</span><span class="dv">55</span>, <span class="at">vietsynd=</span><span class="dv">0</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>preds2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">demforce =</span><span class="fu">predict</span>(mod2, <span class="at">newdata=</span>predictiondatadem, <span class="at">type=</span><span class="st">"response"</span>))</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>preds2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(preds2, <span class="at">repforce=</span><span class="fu">predict</span>(mod2, <span class="at">newdata=</span>predictiondatarep, <span class="at">type=</span><span class="st">"response"</span>), <span class="at">unemp=</span>predictiondatadem<span class="sc">$</span>unemp)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(preds2, <span class="fu">aes</span>(<span class="at">x=</span>unemp, <span class="at">y=</span>demforce)) <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="at">color=</span><span class="st">"blue"</span>) <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>unemp, <span class="at">y=</span>repforce), <span class="at">color=</span><span class="st">"red"</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Uses of Force"</span>, <span class="at">x=</span><span class="st">"Unemployment"</span>, <span class="at">y=</span><span class="st">"Expected Uses of Force"</span>) <span class="sc">+</span> <span class="fu">theme_minimal</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="countB24_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>As unemployment increases, uses of force diverge between the two parties even more than in Fordham’s original model. Foreign states may avoid trouble with the US when unemployment goes up, making opportunities to use force more scarce, though Republican presidents, unable to use macroeconomic policy to address unemployment, seem to seek out opportunities to use force. Democrats, both because there are fewer opportunities and fewer incentives to use force under growing unemployment, see uses of force decline.</p>
</section>
<section id="comment" class="level2">
<h2 class="anchored" data-anchor-id="comment">Comment</h2>
<p>The zero altered models are mainly estimatable in R using either <code>pscl</code> or <code>glmmTMB</code>. The former is written by political scientists including Simon Jackman. The latter is a package aimed at multi-level estimation (e.g.&nbsp;random effects). Results from the two do not always correspond. Moreover, models that converge easily in Stata do not always converge in R - I’m making no judgment regarding what’s right here.</p>
<p><img src="skewyou.jpeg" class="img-fluid"></p>



</section>
</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a><div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-fordhamjcr" class="csl-entry" role="listitem">
Fordham, Benjamin. 1998. <span>“Partisanship, Macroeconomic Policy, and u.s. Uses of Force, 1949-1994.”</span> <em>Journal of Conflict Resolution</em> 42 (4): 418–39.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>