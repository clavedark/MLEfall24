<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Dave Clark">
<meta name="dcterms.date" content="2024-10-15">

<title>Binomial Topics: Ordered y, non-constant variance – MLE - Fall 2024</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="site_libs/kePrint/kePrint.js"></script>
<link href="site_libs/lightable/lightable.css" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">MLE - Fall 2024</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./slides.html"> 
<span class="menu-text">Slides</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./mlesyllabus24.html"> 
<span class="menu-text">MLE Syllabus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./code.html"> 
<span class="menu-text">Code</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools tools-wide">
    <div class="dropdown">
      <a href="" title="" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label=""><i class="bi bi-github"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://github.com/clavedark/MLEfall24">
            repo
            </a>
          </li>
      </ul>
    </div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Binomial Topics: Ordered <span class="math inline">\(y\)</span>, non-constant variance</h1>
                      </div>
  </div>
    
  <div class="quarto-title-meta-author">
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-heading">Affiliation</div>
    
      <div class="quarto-title-meta-contents">
      <p class="author">Dave Clark </p>
    </div>
    <div class="quarto-title-meta-contents">
          <p class="affiliation">
              Binghamton University
            </p>
        </div>
    </div>

  <div class="quarto-title-meta">

        
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">October 15, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#choice-models-and-theory" id="toc-choice-models-and-theory" class="nav-link active" data-scroll-target="#choice-models-and-theory">Choice models and theory</a></li>
  <li><a href="#independence-of-irrelevant-alternatives-iia" id="toc-independence-of-irrelevant-alternatives-iia" class="nav-link" data-scroll-target="#independence-of-irrelevant-alternatives-iia">Independence of Irrelevant Alternatives (IIA)</a></li>
  <li><a href="#what-is-iia" id="toc-what-is-iia" class="nav-link" data-scroll-target="#what-is-iia">What is IIA?</a></li>
  <li><a href="#iia-in-the-mnl" id="toc-iia-in-the-mnl" class="nav-link" data-scroll-target="#iia-in-the-mnl">IIA in the MNL</a></li>
  <li><a href="#related-to-preference-transitivity" id="toc-related-to-preference-transitivity" class="nav-link" data-scroll-target="#related-to-preference-transitivity">Related to Preference Transitivity</a></li>
  <li><a href="#redblue-busses" id="toc-redblue-busses" class="nav-link" data-scroll-target="#redblue-busses">Red/Blue Busses</a></li>
  <li><a href="#empirical-implication" id="toc-empirical-implication" class="nav-link" data-scroll-target="#empirical-implication">Empirical implication</a></li>
  <li><a href="#relating-iia-to-i.i.d." id="toc-relating-iia-to-i.i.d." class="nav-link" data-scroll-target="#relating-iia-to-i.i.d.">Relating IIA to i.i.d.</a></li>
  <li><a href="#iia-in-reality" id="toc-iia-in-reality" class="nav-link" data-scroll-target="#iia-in-reality">IIA in reality</a></li>
  <li><a href="#how-to-relax-iia-by-relaxing-i.i.d." id="toc-how-to-relax-iia-by-relaxing-i.i.d." class="nav-link" data-scroll-target="#how-to-relax-iia-by-relaxing-i.i.d.">How to relax IIA? By relaxing i.i.d.</a></li>
  <li><a href="#multivariate-probit" id="toc-multivariate-probit" class="nav-link" data-scroll-target="#multivariate-probit">Multivariate probit</a></li>
  <li><a href="#closing-out-choice-models" id="toc-closing-out-choice-models" class="nav-link" data-scroll-target="#closing-out-choice-models">Closing out Choice Models</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<!-- rm(list=ls()) -->
<section id="choice-models-and-theory" class="level2">
<h2 class="anchored" data-anchor-id="choice-models-and-theory">Choice models and theory</h2>
<p>Models for nominal variables are interesting because they derive so neatly from utility theory - this is the ideal of EITM. But it also means that we have to consider how assumptions from theory manifest themselves in econometric models. This alone is an interesting topic, because we’d want theory assumptions accurately reflected in the statistical model.</p>
</section>
<section id="independence-of-irrelevant-alternatives-iia" class="level2">
<h2 class="anchored" data-anchor-id="independence-of-irrelevant-alternatives-iia">Independence of Irrelevant Alternatives (IIA)</h2>
<ul>
<li>Both of the MNL and CL models assume IIA.</li>
<li>IIA is a rationality assumption about individual behavior rather than an econometric assumption.</li>
<li>The econometric realization of IIA is i.i.d. - we assume the errors surrounding each value of <span class="math inline">\(Y=j\)</span> for <span class="math inline">\(j-1\)</span> alternatives are i.i.d</li>
<li>This means we do make an econometric assumption about homogeneity of choices and individuals.</li>
</ul>
</section>
<section id="what-is-iia" class="level2">
<h2 class="anchored" data-anchor-id="what-is-iia">What is IIA?</h2>
<p>Ordeshook (1986) has a well-known example.</p>
<ul>
<li>A diner goes into a restaurant and wants to order soup. He is offered either Chicken or Vegetable and he chooses chicken - thus, his preference ordering must be <em>Chicken p Vegetable</em>.</li>
<li>Soon, the waiter returns to say they also have noodle soup; the diner changes his order from Chicken to Vegetable.<br>
</li>
<li>You can see that the introduction of noodle soup should have no effect on his ranking of Chicken above Vegetable.</li>
<li>He might prefer <em>Chicken p Vegetable p Noodle</em> or <em>Chicken p Noodle p Vegetable</em>, but the original ranking of <em>Chicken p Vegetable</em> must remain unaffected.</li>
<li>The addition of Noodle cannot change his pairwise ordering of Chicken and Vegetable.</li>
</ul>
</section>
<section id="iia-in-the-mnl" class="level2">
<h2 class="anchored" data-anchor-id="iia-in-the-mnl">IIA in the MNL</h2>
<p>If the introduction of new alternatives changes the order of individual preferences, then IIA fails. In estimation, we consider the ratio of the probabilities of outcomes <span class="math inline">\(j\)</span> to <span class="math inline">\(k\)</span> where these are two categories in <span class="math inline">\(Y\)</span>; note how this relies explicitly on the notion that MNL is a set of binary logits, pairwise comparisons:</p>
<p><span class="math display">\[
\frac{Pr(Y=j)}{Pr(Y=k)} = \frac{ \frac{e^{x_{i}\beta_{j}}}{\sum\limits_{j=1}^{J}e^{x_{i}\beta_{j}}}}{\frac{e^{x_{i}\beta_{j}'}}{\sum\limits_{j=1}^{J}e^{x_{i}\beta_{j}}}}
=\frac{e^{x_{i}\beta_{j}'}}{{e^{x_{i}\beta_{j}'}}} \nonumber
\]</span></p>
<p>Consideration of another outcome, <span class="math inline">\(l\)</span>, cannot influence this ratio. This ratio is the ratio of preferences for <span class="math inline">\(j\)</span> to <span class="math inline">\(k\)</span>, all other options irrelevant.</p>
</section>
<section id="related-to-preference-transitivity" class="level2">
<h2 class="anchored" data-anchor-id="related-to-preference-transitivity">Related to Preference Transitivity</h2>
<p>Think of this in terms of the transitivity requirement:</p>
<p>Suppose alternatives <span class="math inline">\(a,b,c\)</span> where <span class="math inline">\(a&gt;b\)</span> – any of the following can be true: <span class="math display">\[\begin{aligned}
c&gt;a&gt;b \nonumber \\
a&gt;c&gt;b \nonumber \\
a&gt;b&gt;c \nonumber
\end{aligned}\]</span></p>
<p>…because all retain <span class="math inline">\(a&gt;b\)</span>. Consideration of <span class="math inline">\(c\)</span> cannot upset the relation of <span class="math inline">\(a&gt;b\)</span>.</p>
<p>So the ratio of <span class="math inline">\(Pr(Y=j)\)</span> to <span class="math inline">\(Pr(Y=k)\)</span> must be entirely independent of other alternatives; adding other choices to the outcome variable cannot change this ratio or IIA is violated.</p>
<p>To link this to the soup example above, if introducing noodle soup to the menu changes the ratio of <span class="math inline">\(\frac{P(chicken)}{P(vegetable)}\)</span>, then it must do so by taking probability away disproportionately from one choice rather than the other. If the probability of one shifts while the other does not, then introducing noodle soup shifts the diner’s preference order.</p>
</section>
<section id="redblue-busses" class="level2">
<h2 class="anchored" data-anchor-id="redblue-busses">Red/Blue Busses</h2>
<p>Here’s another example that appears in virtually every econometrics book. Suppose we want to study the how individuals are transported to work. Half of our sample takes a car, the other half takes a red bus from the Red Bus Co.&nbsp;Thus,</p>
<p><span class="math display">\[\begin{aligned}
Pr(car)=.5 , Pr(red ~bus) = .5 \nonumber \\~\\
\frac{Pr(car)=.5 }{Pr(red~ bus) = .5 } = 1 \nonumber
\end{aligned}\]</span></p>
<p>The ratio of the probability of driving a car to the probability of taking the red bus is 1. So no matter what, we cannot introduce another alternative that changes this ratio.</p>
<p>A new bus company comes to town, the Blue Bus Co.&nbsp;It’s unlikely the car drivers will switch to the blue bus company - they’d have been riding the red bus all along. Thus, the Blue Bus Co.&nbsp;is going to compete with the Red Bus Co.&nbsp;and will draw customers disproportionately from the Red Bus Co.&nbsp;So,</p>
<p><span class="math display">\[\begin{aligned}
Pr(car)=.5 , Pr(red~ bus) = .25,   Pr(blue ~bus) = .25 \nonumber \\~\\
\frac{Pr(car)=.5 }{Pr(red ~bus) = .25 } = 2 \nonumber
\end{aligned}\]</span></p>
<p>The Blue Bus Co.&nbsp;drew from the probability of taking a red bus, but not from the probability of taking a car, so the ratio of the probability of taking a car to the probability of taking the red bus changed. Introducing the Blue Bus alternative violated IIA. In order not to have violated IIA, Blue Bus Co.&nbsp;would have had to have taken probability equally from both categories, car and red bus.</p>
<p>If we were estimating <span class="math inline">\(Pr(Blue Bus|X)\)</span>, the effects of <span class="math inline">\(X\)</span> would have to increase or decrease the chances of choosing the Blue Bus proportionally to increasing or decreasing the chances of Red Busses or cars or rickshaws, or whatever, so that the ratio of the expected conditional probabilities would remain constant.</p>
<p>For this to happen, the unobservables that influence these choices would have to be independent of one another.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
An important implication
</div>
</div>
<div class="callout-body-container callout-body">
<p>If an alternative <span class="math inline">\(j\)</span> is a near substitute for alternative <span class="math inline">\(k\)</span>, but not for alternatives <span class="math inline">\(l,m, \ldots z\)</span>, then the alternative <span class="math inline">\(j\)</span> is neither independent nor irrelevant. In other words, MNL and CL models may be inappropriate for questions about substitution because of the IIA assumption. This would be unfortunate since a lot of models of substitution are MNL.</p>
</div>
</div>
</section>
<section id="empirical-implication" class="level2">
<h2 class="anchored" data-anchor-id="empirical-implication">Empirical implication</h2>
<ul>
<li><p>The error terms of outcomes <span class="math inline">\(j\)</span> and <span class="math inline">\(k\)</span> are not correlated by assumption. If the IIA assumption fails, then the error terms are correlated and probably heteroskedastic as well (so neither independent nor identically distributed).</p></li>
<li><p>Moreover, the model is misspecified; we assume individuals making decision behave according to IIA but they don’t, so our model does not represent their behavior. In the end, estimates are biased and can be inefficient as well.</p></li>
</ul>
</section>
<section id="relating-iia-to-i.i.d." class="level2">
<h2 class="anchored" data-anchor-id="relating-iia-to-i.i.d.">Relating IIA to i.i.d.</h2>
<p>In the 1996 Presidential election, the public faced a choice among three candidates, Bill Clinton, Bob Dole and Ross Perot. Lucky voters ranked these three fine gentlemen and cast their votes. Suppose the distribution of preferences just between Clinton and Dole prior to Perot’s entry looked like this:</p>
<p>Clinton = .6 Dole = .4</p>
<p>Voters preferred Clinton by a 3:2 ratio over Dole.</p>
<p>Suppose, however, that once Ross Perot entered the race, he offered a morally founded and liberal platform such that he took virtually all of Clinton’s support, leaving Clinton with just 10% of the voters, so</p>
<p>Clinton = .1 Dole = .4 Perot = .5</p>
<p>Consistent with the rational choice requirement, voters have shifted from one of the original alternatives to the new alterative, not to the other original choice. Inconsistent with the econometric requirement, the ratio of Clinton to Dole is not the same once Perot is in the race - it was originally 3:2, and now it is 1:4. So on the surface, it appears as if we have maintained the formal requirement and violated the econometric one.</p>
<p>But look more closely.</p>
<p>It is also true that voters now prefer Dole to Clinton by a 4 to 1 ratio, so in fact, the formal requirement also fails. Thus, it appears as if the formal and econometric versions of the requirement have some equivalence.</p>
<p>The choice between Clinton and Dole is correlated with the Perot option. The fact that Perot is an option shifts the probabilities for Clinton and Dole unevenly - to be clear, if Perot took the same proportion of the vote from each such that the ratio of Clinton to Dole was still 3:2, then IIA would be intact.</p>
<p>The factors that make voters choose Perot are correlated with the factors that make voters choose Clinton or Dole. If we include those factors in the model (instead of having them in the errors), we reduce the correlation of the errors. This is a specification problem.</p>
</section>
<section id="iia-in-reality" class="level2">
<h2 class="anchored" data-anchor-id="iia-in-reality">IIA in reality</h2>
<p>As Long &amp; Freese point out, testing IIA is anything but straightfoward - they essentially advise against trusting tests. <a href="https://statisticalhorizons.com/iia/">Paul Allison</a> expresses similar skepticism of IIA tests.</p>
<p>My intuition is models violating IIA often don’t have different estimates than models accounting for it. why account for it? To be sure estimates are stable, and to evaluate model specification. correlation of the errors around the outcomes indicate some common factors predict those outcomes; they’re in the error because they’re excluded from the model.</p>
</section>
<section id="how-to-relax-iia-by-relaxing-i.i.d." class="level2">
<h2 class="anchored" data-anchor-id="how-to-relax-iia-by-relaxing-i.i.d.">How to relax IIA? By relaxing i.i.d.</h2>
<p>multinomial probit (choice specific variables like CL) - structured like CL, but probit, so normal, but the multivariate normal distribution with j-1 dimensions; estimates the correlation of the errors, thereby permitting non-independence. multivariate probit (case specific variables like MNL) - a set of simultaneous probit equations, <span class="math inline">\(x\)</span> variables can differ across outcomes; measures correlations among errors, permitting non-independence. mixed logit - (choice or choice by case specific variables) - estimates fixed and random parameters; the latter estimates effects across individuals, permitting variation, and estimates that variation.</p>
<p>Here’s an account of how different methods impose IIA or i.i.d. restrictions.</p>
<div class="tiny">
<div class="center">
<div id="tab:methods">
<table class="caption-top table">
<caption>Models &amp; Assumptions</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span><strong>Model</strong></span></td>
<td style="text-align: center;"><span><strong>IIA</strong></span></td>
<td style="text-align: center;"><span><strong>i. i. d.</strong></span></td>
<td style="text-align: left;"><span><strong>Comment</strong></span></td>
<td style="text-align: left;"><span><strong>Independent ariables</strong></span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">MNL/CL</td>
<td style="text-align: center;">Yes</td>
<td style="text-align: center;">Yes</td>
<td style="text-align: left;">i.i.d Logistic</td>
<td style="text-align: left;"><span class="math inline">\(X ~\forall~ Y_i\)</span>; CL varies</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MNP</td>
<td style="text-align: center;">No</td>
<td style="text-align: center;">No</td>
<td style="text-align: left;">not independent, but identical</td>
<td style="text-align: left;"><span class="math inline">\(X ~\forall ~Y_i\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">MVP</td>
<td style="text-align: center;">No</td>
<td style="text-align: center;">Partial</td>
<td style="text-align: left;">not independent, but identical</td>
<td style="text-align: left;"><span class="math inline">\(X_i ~\text{for each} ~ Y_i\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>There are several approaches to relaxing the IIA assumption including the multinomial probit, the heteroskedastic extreme value model, and the multivariate probit. The two probit models, rooted in the standard normal distribution, take advantage of the multivariate normal distribution to allow for correlation among the errors. The HEV model allows the variance of the errors to vary across the choices, so relaxes the “identically distributed” assumption, though still requires the errors are independent. Let’s look at the multinomial probit and the multivariate probit in more detail.</p>
</section>
<section id="multivariate-probit" class="level2">
<h2 class="anchored" data-anchor-id="multivariate-probit">Multivariate probit</h2>
<p>The idea here is to estimate a system of equations, one for each outcome. The errors in these equations can be correlated, so the outcomes are not assumed independent. The model is a set of <span class="math inline">\(J\)</span> probit equations, one for each outcome, <span class="math inline">\(j\)</span>. The <span class="math inline">\(x\)</span> variables can vary across the equations, so the <span class="math inline">\(x\)</span> variables for <span class="math inline">\(y_1\)</span> can be different from the <span class="math inline">\(x\)</span> variables for <span class="math inline">\(y_2\)</span>. The errors are correlated across the equations, so the errors for <span class="math inline">\(y_1\)</span> are correlated with the errors for <span class="math inline">\(y_2\)</span>. The model estimates the correlation of the errors, <span class="math inline">\(\rho\)</span>. This both measures the extent to which the outcomes are correlated and relaxes the IIA (i.i.d.) assumption by “explaining” the correlation.</p>
<p>Thinking of the foreign policy choice data we’ve been working with, we have so far conceived of the <span class="math inline">\(y\)</span> variable as a single, categorical but unordered variable:</p>
<ul>
<li>0 = no action</li>
<li>1 = MID only</li>
<li>2 = GATT only</li>
<li>3 = both MID and GATT</li>
</ul>
<p>Instead, we could define 2 dummy variables this way:</p>
<ul>
<li>Militarized Interstate Dispute - 0=no, 1=yes</li>
<li>GATT dispute - 0=no, 1=yes</li>
</ul>
<p>such that both variables can equal zero at the same time (indicating neither a MID nor a GATT dispute occurred) or they can both equal one at the same time (indicating both types of dispute occur at the same time). Note these represent the same information as the categorical variable. Now, we’ve got two <span class="math inline">\(y\)</span> variables and we could estimate two probit equations:</p>
<p><span class="math display">\[
P(MID=1) = \Phi(\beta_m x_i) \nonumber \\
P(GATT=1) = \Phi(\beta_g x_i) \nonumber
\]</span></p>
<ul>
<li>The binary variables option is an elegant way to capture all these possibilities.</li>
<li>Having two dependent variables implies two equations. -If we estimate the two equations as individual regressions, their errors are uncorrelated by construction; we impose i.i.d. by treating the alternatives as zero.</li>
<li>If we estimate these equations simultaneously, that is as a system, we must say something specific about their errors and the relationship among their errors.</li>
<li>As a set of equations, we can (perhaps should?) have different sets of <span class="math inline">\(X\)</span> variables predicting the outcomes; <span class="math inline">\(X\)</span> is restricted across outcomes in most of the choice models we’ve talked about.</li>
</ul>
<p>Why probit? We take advantage of the dimensionality of the normal distribution, and use the multivariate (in this case, bivariate) normal distribution - so the outcomes are jointly determined, and the unobservables are correlated, <span class="math inline">\(\rho\)</span>. In the single equation probit, we assume the errors are univariate normal.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvProbit)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>fpdata <span class="ot">&lt;-</span> <span class="fu">read_dta</span>(<span class="st">"/Users/dave/Documents/teaching/606J-mle/2024/topics/choicemodels/nominaldata.dta"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>fpmvp <span class="ot">&lt;-</span> <span class="fu">filter</span>(fpdata, <span class="sc">!</span><span class="fu">is.na</span>(unemp2) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(pressupp) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(pelect) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(approval))</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>mvp <span class="ot">&lt;-</span> mvProbit <span class="ot">&lt;-</span> <span class="fu">mvProbit</span>(<span class="fu">cbind</span>(mid, gatt) <span class="sc">~</span> unemp2 <span class="sc">+</span>pressupp <span class="sc">+</span>pelect , <span class="at">data =</span> <span class="fu">as.data.frame</span>(fpmvp), <span class="at">iterlim =</span> <span class="dv">20</span>, <span class="at">nGHK =</span> <span class="dv">100</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract coefficients and standard errors</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>coef_table <span class="ot">&lt;-</span> <span class="fu">summary</span>(mvp)<span class="sc">$</span>estimate</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>coef_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(coef_table)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Add column for p-values</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>coef_df<span class="sc">$</span>p_value <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="fu">abs</span>(coef_df<span class="sc">$</span><span class="st">`</span><span class="at">t value</span><span class="st">`</span>)))</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>n_cols <span class="ot">&lt;-</span> <span class="fu">ncol</span>(coef_df)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Create appropriate column names based on the number of columns</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (n_cols <span class="sc">==</span> <span class="dv">3</span>) {</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>  col_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Estimate"</span>, <span class="st">"Std. Error"</span>, <span class="st">"z value"</span>)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span> (n_cols <span class="sc">==</span> <span class="dv">4</span>) {</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>  col_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Estimate"</span>, <span class="st">"Std. Error"</span>, <span class="st">"z value"</span>, <span class="st">"Pr(&gt;|z|)"</span>)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>  col_names <span class="ot">&lt;-</span> <span class="fu">colnames</span>(coef_df)  <span class="co"># Use existing column names if structure is unexpected</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the table</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(coef_df, </span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="st">"html"</span>,</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">digits =</span> <span class="dv">3</span>,</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">col.names =</span> col_names,</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"MVP Model Results"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>),</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>                <span class="at">full_width =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">" "</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">"Coefficients"</span> <span class="ot">=</span> (n_cols ))) <span class="sc">%&gt;%</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="dv">0</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>MVP Model Results</caption>
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; empty-cells: hide; border-bottom: hidden;"></th>
<th colspan="5" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Coefficients
</div></th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold;"></th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Estimate</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Std. error</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">t value</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Pr(&gt; t)</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">p_value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">b_1_0</td>
<td style="text-align: right;">-1.433</td>
<td style="text-align: right;">0.486</td>
<td style="text-align: right;">-2.948</td>
<td style="text-align: right;">0.003</td>
<td style="text-align: right;">0.003</td>
</tr>
<tr class="even">
<td style="text-align: left;">b_1_1</td>
<td style="text-align: right;">0.062</td>
<td style="text-align: right;">0.039</td>
<td style="text-align: right;">1.576</td>
<td style="text-align: right;">0.115</td>
<td style="text-align: right;">0.115</td>
</tr>
<tr class="odd">
<td style="text-align: left;">b_1_2</td>
<td style="text-align: right;">0.008</td>
<td style="text-align: right;">0.005</td>
<td style="text-align: right;">1.605</td>
<td style="text-align: right;">0.108</td>
<td style="text-align: right;">0.108</td>
</tr>
<tr class="even">
<td style="text-align: left;">b_1_3</td>
<td style="text-align: right;">-0.014</td>
<td style="text-align: right;">0.147</td>
<td style="text-align: right;">-0.096</td>
<td style="text-align: right;">0.924</td>
<td style="text-align: right;">0.924</td>
</tr>
<tr class="odd">
<td style="text-align: left;">b_2_0</td>
<td style="text-align: right;">-0.331</td>
<td style="text-align: right;">0.523</td>
<td style="text-align: right;">-0.633</td>
<td style="text-align: right;">0.527</td>
<td style="text-align: right;">0.527</td>
</tr>
<tr class="even">
<td style="text-align: left;">b_2_1</td>
<td style="text-align: right;">0.155</td>
<td style="text-align: right;">0.043</td>
<td style="text-align: right;">3.609</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">b_2_2</td>
<td style="text-align: right;">-0.023</td>
<td style="text-align: right;">0.006</td>
<td style="text-align: right;">-3.993</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">b_2_3</td>
<td style="text-align: right;">-0.024</td>
<td style="text-align: right;">0.171</td>
<td style="text-align: right;">-0.142</td>
<td style="text-align: right;">0.887</td>
<td style="text-align: right;">0.887</td>
</tr>
<tr class="odd">
<td style="text-align: left;">R_1_2</td>
<td style="text-align: right;">-0.023</td>
<td style="text-align: right;">0.094</td>
<td style="text-align: right;">-0.245</td>
<td style="text-align: right;">0.806</td>
<td style="text-align: right;">0.806</td>
</tr>
</tbody>
</table>


</div>
<p>Interestingly, the main results from the multinomial models hold in general, but as the hypothesis test on <span class="math inline">\(\rho\)</span> (which is the correlation between the disturbance terms in the two equations) shows, the errors in the two equations are correlated significantly. Some interpret this as evidence IIA does not hold (see Alvarez &amp; Nagler’s paper) and some economists suggest this is evidence of substitution.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvProbit)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>mvp <span class="ot">&lt;-</span> mvProbit <span class="ot">&lt;-</span> <span class="fu">mvProbit</span>(<span class="fu">cbind</span>(mid, gatt) <span class="sc">~</span> unemp2 <span class="sc">+</span>pressupp <span class="sc">+</span>pelect , <span class="at">data =</span> <span class="fu">as.data.frame</span>(fpmvp), <span class="at">iterlim =</span> <span class="dv">20</span>, <span class="at">nGHK =</span> <span class="dv">10</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">expand.grid</span>(</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">intercept=</span> <span class="dv">1</span>, </span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">unemp2 =</span> <span class="fu">median</span>(fpdata<span class="sc">$</span>unemp2, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">pressupp =</span> <span class="fu">seq</span>(<span class="dv">43</span>,<span class="dv">93</span>, <span class="at">length.out =</span> <span class="dv">50</span>),</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">pelect =</span> <span class="dv">0</span>,</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">approval =</span> <span class="fu">median</span>(fpdata<span class="sc">$</span>approval, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate expectations and marginal effects</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>effects <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">mvProbitExp</span>(<span class="sc">~</span> unemp2 <span class="sc">+</span>pressupp <span class="sc">+</span>pelect , <span class="at">coef=</span>mvp<span class="sc">$</span>estimate, <span class="at">data=</span><span class="fu">as.data.frame</span>(X)), X)</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="co"># plot V1 V2 over pressupp</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(effects, <span class="fu">aes</span>(<span class="at">x=</span>pressupp, <span class="at">y=</span>V1)) <span class="sc">+</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>V2), <span class="at">color=</span><span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Marginal Effects of Press Support on MID and GATT Disputes"</span>,</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">"Press Support"</span>, <span class="at">y=</span><span class="st">"Marginal Effect"</span>) <span class="sc">+</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="choiceB24_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="closing-out-choice-models" class="level2">
<h2 class="anchored" data-anchor-id="closing-out-choice-models">Closing out Choice Models</h2>
<ul>
<li><p>MNL is essentially a collection of simultaneous binary logits.</p></li>
<li><p>MNL and CL are identical models.</p></li>
<li><p>Only the data structure and what we can measure vary between MNL/CL.</p></li>
<li><p>MNL has <span class="math inline">\(n\)</span> observations, data only on characteristics of <span class="math inline">\(i\)</span>.</p></li>
<li><p>CL has <span class="math inline">\(n*j\)</span> observations, data on attributes of <span class="math inline">\(j\)</span> (and perhaps of <span class="math inline">\(i\)</span> as well).</p></li>
<li><p>both require IIA</p></li>
<li><p>IIA requires that, for any pairwise comparison of outcomes, <span class="math inline">\(i, j\)</span>, the ratio of <span class="math inline">\(Pr(i)/Pr(j)\)</span> must not change due to the existence of any other option, <span class="math inline">\(k\)</span>.</p></li>
<li><p>In the model, the ratio of those probabilities conditional on the <span class="math inline">\(X_i\)</span> must be consistent.</p></li>
<li><p>Any time we can conceive of the choice outcomes as substitutes, the ratio will certainly change; so IIA fails.</p></li>
<li><p>In the econometric model, we assume the disturbances around outcome <span class="math inline">\(j\)</span> are uncorrelated with the disturbances around outcome <span class="math inline">\(k\)</span>. If IIA fails, this fails, and the errors are not i.i.d.</p></li>
<li><p>Solutions usually involve relaxing the independence assumption.</p></li>
<li><p>Simplest is to use the n-variate normal, dimensions correlated by <span class="math inline">\(\rho_{j,k}\)</span>.</p></li>
<li><p>One model using this is the multinomial probit. It restricts the <span class="math inline">\(x\)</span> to be the same across the outcomes (just like MNL).</p></li>
<li><p>Another using the normal is the multivariate probit (a set of simultaneous probit equations); the <span class="math inline">\(x\)</span> can vary across outcomes.</p></li>
<li><p>In either case, computation on the n-variate normal gets very difficult with higher dimensions ($&gt;$2 or 3 outcomes). Usually done with simulations (this is what Stata does).</p></li>
<li><p>Either model resolves IIA problem by permitting correlation of errors such that shifts in the ratio of probabilities is permissible.</p></li>
</ul>
<p>You should have the idea that substitution is a major concept lurking beneath all these choice models, or certainly beneath all their applications.</p>
<ul>
<li>Imagine that two choices, A and B. A is more expensive, but comes in lots of colors. B is cheaper, but only comes in black. Individuals will substitute one for the other based on how they evaluate the tradeoff between price and color.</li>
<li>Those who really prefer color will choose A; those that really respond to price will choose B.</li>
<li>If a new alternative, C, were introduced and it was identical to A, it would draw entirely from individuals who preferred A in the first place, and would draw nothing from B.</li>
</ul>
<p>This would violate IIA - the ratio</p>
<p><span class="math display">\[\frac{\partial(Pr(y_i))/\partial(x)}{\partial(Pr(y_j))/\partial(x)} \neq 1\]</span></p>
<p>But suppose new alternative C offers some limited color options, and is cheaper than A. - Will C draw equally from A and B? Not necessarily. - Will C draw from A and B for different reasons? Yes.</p>
<p>In other words, an alternative, C, alters the (pairwise) choice probabilities between A and B at different rates, and for heterogeneous reasons. Some substitution to C occurs because of price, some because of color - there is no reason to believe movement to C is at equal rates with respect to price {<em>and</em>} with respect to color. If the rate of substitution from A to C is different from the rate of substitution from B to C, then IIA fails. If the rate of substitution from A to C is different between those who substitute based on price and those who substitute based on color, we have a different problem.</p>
<p>This restriction is known as the <strong>Invariant Proportion of Substitution</strong> (IPS), due to Steenburgh (2008).</p>
<p>IPS: the restriction in essentially every choice model that:</p>
<p><span class="math display">\[
\frac{\partial(Pr(y_i))/\partial(x_{i,a})}{\partial(Pr(y_j))/\partial(x_{i,a})} = \Psi_{i, a}  ~~\forall a  \nonumber
\]</span></p>
<p>The rate of substitution between <span class="math inline">\(i,j\)</span> in this example does not depend at all on which attribute, <span class="math inline">\(a\)</span> is changed or improved. Change in attribute <span class="math inline">\(x_{i, a}\)</span> produces a constant rate of substitution, <span class="math inline">\(\Psi\)</span> regardless of which attribute actually changed.</p>
<p>How significant a restriction is IPS? Conceptually, perhaps it is quite restrictive - the rates of substitution cannot vary across attributes in any standard choice model (GEV, correlated normal). If we believe individual choices among A, B, and C are driven in different directions by different attributes of A, B, and C, then assuming this cannot happen is a problem.</p>
<p>Solutions - few practical ones exist. The “mother” logit or “universal” logit (McFadden 1975) is possible, but some suggest it departs random utility conditions in other ways. One innovation is the “flexible substitution logit.” (Liu, Steenburgh, and Gupta 2011)</p>
<p>The punch lines are these:</p>
<ul>
<li>choice models are very flexible.</li>
<li>choice models appeal because they arise so directly from random utility models.</li>
<li>IIA is a significant restriction, but fairly easy to relax.</li>
<li>IPS is a newly recognized restriction - how consequential it is is not really known.</li>
</ul>


</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>