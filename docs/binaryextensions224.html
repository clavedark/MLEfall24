<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Dave Clark">
<meta name="dcterms.date" content="2024-09-17">

<title>Binomial Topics: Ordered y, non-constant variance – MLE - Fall 2024</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="site_libs/htmltools-fill/fill.css" rel="stylesheet">
<script src="site_libs/htmlwidgets/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding/plotly.js"></script>
<script src="site_libs/typedarray/typedarray.min.js"></script>
<script src="site_libs/jquery/jquery.min.js"></script>
<link href="site_libs/crosstalk/css/crosstalk.min.css" rel="stylesheet">
<script src="site_libs/crosstalk/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css/plotly-htmlwidgets.css" rel="stylesheet">
<script src="site_libs/plotly-main/plotly-latest.min.js"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">MLE - Fall 2024</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./slides.html"> 
<span class="menu-text">Slides</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./mlesyllabus24.html"> 
<span class="menu-text">MLE Syllabus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./code.html"> 
<span class="menu-text">Code</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools tools-wide">
    <div class="dropdown">
      <a href="" title="" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label=""><i class="bi bi-github"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://github.com/clavedark/MLEfall24">
            repo
            </a>
          </li>
      </ul>
    </div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Binomial Topics: Ordered <span class="math inline">\(y\)</span>, non-constant variance</h1>
                      </div>
  </div>
    
  <div class="quarto-title-meta-author">
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-heading">Affiliation</div>
    
      <div class="quarto-title-meta-contents">
      <p class="author">Dave Clark </p>
    </div>
    <div class="quarto-title-meta-contents">
          <p class="affiliation">
              Binghamton University
            </p>
        </div>
    </div>

  <div class="quarto-title-meta">

        
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">September 17, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#extensions-of-the-binary-model" id="toc-extensions-of-the-binary-model" class="nav-link active" data-scroll-target="#extensions-of-the-binary-model">Extensions of the Binary Model</a></li>
  <li><a href="#ordered-y-variables" id="toc-ordered-y-variables" class="nav-link" data-scroll-target="#ordered-y-variables">Ordered <span class="math inline">\(y\)</span> Variables</a>
  <ul class="collapse">
  <li><a href="#revisiting-continuous-v.-discrete-measures" id="toc-revisiting-continuous-v.-discrete-measures" class="nav-link" data-scroll-target="#revisiting-continuous-v.-discrete-measures">Revisiting continuous v. discrete measures</a></li>
  <li><a href="#discrete-ordered-variables" id="toc-discrete-ordered-variables" class="nav-link" data-scroll-target="#discrete-ordered-variables">Discrete Ordered Variables</a></li>
  <li><a href="#latent-variable-motivation" id="toc-latent-variable-motivation" class="nav-link" data-scroll-target="#latent-variable-motivation">Latent Variable Motivation</a></li>
  <li><a href="#cut-points" id="toc-cut-points" class="nav-link" data-scroll-target="#cut-points">Cut points</a>
  <ul class="collapse">
  <li><a href="#aside-on-link-functions" id="toc-aside-on-link-functions" class="nav-link" data-scroll-target="#aside-on-link-functions">Aside on Link Functions</a></li>
  </ul></li>
  <li><a href="#example" id="toc-example" class="nav-link" data-scroll-target="#example">Example</a></li>
  <li><a href="#cumulative-probabilities" id="toc-cumulative-probabilities" class="nav-link" data-scroll-target="#cumulative-probabilities">Cumulative Probabilities</a></li>
  <li><a href="#estimation" id="toc-estimation" class="nav-link" data-scroll-target="#estimation">Estimation</a>
  <ul class="collapse">
  <li><a href="#probit" id="toc-probit" class="nav-link" data-scroll-target="#probit">Probit …</a></li>
  </ul></li>
  <li><a href="#example-1" id="toc-example-1" class="nav-link" data-scroll-target="#example-1">Example</a></li>
  <li><a href="#parallel-regression-assumption" id="toc-parallel-regression-assumption" class="nav-link" data-scroll-target="#parallel-regression-assumption">Parallel Regression Assumption</a></li>
  <li><a href="#relaxing-parallel-regression" id="toc-relaxing-parallel-regression" class="nav-link" data-scroll-target="#relaxing-parallel-regression">Relaxing Parallel Regression</a></li>
  <li><a href="#use-ordered-models-with-caution" id="toc-use-ordered-models-with-caution" class="nav-link" data-scroll-target="#use-ordered-models-with-caution">Use Ordered Models with Caution …</a></li>
  </ul></li>
  <li><a href="#constant-variance-in-binary-response-models" id="toc-constant-variance-in-binary-response-models" class="nav-link" data-scroll-target="#constant-variance-in-binary-response-models">Constant Variance in Binary Response Models</a>
  <ul class="collapse">
  <li><a href="#parameterizing-sigma2" id="toc-parameterizing-sigma2" class="nav-link" data-scroll-target="#parameterizing-sigma2">Parameterizing <span class="math inline">\(\sigma^2\)</span></a></li>
  <li><a href="#heteroskedastic-probit-llf" id="toc-heteroskedastic-probit-llf" class="nav-link" data-scroll-target="#heteroskedastic-probit-llf">Heteroskedastic Probit LLF</a></li>
  <li><a href="#link-distribution-for-sigma2" id="toc-link-distribution-for-sigma2" class="nav-link" data-scroll-target="#link-distribution-for-sigma2">Link Distribution for <span class="math inline">\(\sigma^2\)</span></a></li>
  <li><a href="#what-if-variance-is-not-constant" id="toc-what-if-variance-is-not-constant" class="nav-link" data-scroll-target="#what-if-variance-is-not-constant">What if variance is not constant?</a></li>
  <li><a href="#thinking-about-the-variance" id="toc-thinking-about-the-variance" class="nav-link" data-scroll-target="#thinking-about-the-variance">Thinking about the variance</a></li>
  <li><a href="#variance-of-epsilon" id="toc-variance-of-epsilon" class="nav-link" data-scroll-target="#variance-of-epsilon">Variance of <span class="math inline">\(\epsilon\)</span></a></li>
  <li><a href="#a-framework-for-theory-about-variance" id="toc-a-framework-for-theory-about-variance" class="nav-link" data-scroll-target="#a-framework-for-theory-about-variance">A Framework for Theory about Variance</a></li>
  <li><a href="#variance-framework" id="toc-variance-framework" class="nav-link" data-scroll-target="#variance-framework">Variance Framework</a></li>
  <li><a href="#example-2" id="toc-example-2" class="nav-link" data-scroll-target="#example-2">Example</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<!-- rm(list=ls()) -->
<section id="extensions-of-the-binary-model" class="level1">
<h1>Extensions of the Binary Model</h1>
<p>The binary model serves as the root, or really a special case, of many other models. More generally, the binomial distribution informs many models beyond the binary variable ones.</p>
<ul>
<li>instead of a binary choice, we can consider multiple choices simply by extending the utility model logic, and expanding the on/off switches in the LLF (weeks 8, 9).</li>
<li>we can consider multiple ordered choices (we’ll look at this today).</li>
<li>we can relax the assumption observations are independent over time, that the DGP has no memory (discrete hazards - last time).</li>
<li>we can relax the constant variance assumption (today).</li>
<li>we can relax the symmetry assumption in the link function (2 weeks ago).</li>
<li>we can take binary events, binomially distributed, count them up over time, and treat them as discrete (Poisson) event counts (week 10).</li>
</ul>
<p>Today, we’ll discuss models for ordered <span class="math inline">\(y\)</span> variables, and how to address non-constant variance in the probit model.</p>
</section>
<section id="ordered-y-variables" class="level1">
<h1>Ordered <span class="math inline">\(y\)</span> Variables</h1>
<p>So far, we’ve considered the binary dependent variable. One straightforward extension of this model is the ordered regression - where <span class="math inline">\(y\)</span> takes on more than 2 values, and we assume those values are ordered. This is a significant assumption. But it’s useful to show how easily these models simply extend the binary models.</p>
<section id="revisiting-continuous-v.-discrete-measures" class="level2">
<h2 class="anchored" data-anchor-id="revisiting-continuous-v.-discrete-measures">Revisiting continuous v. discrete measures</h2>
<ul>
<li>Continuous variables (interval, ratio level) have meaningful distances between discrete observations and can be infinitely divided.<br>
</li>
<li>We could, for instance, infinitely divide a measure of income into finer and finer units. The distances between these units would be equal and meaningful in some fashion.<br>
</li>
<li>Discrete variables, on the other hand, only take on certain values.</li>
<li>Those values may or may not indicate order, value or magnitude, and the intervals between values generally are not meaningful nor are they equal.<br>
</li>
<li>Discrete indicators cannot reasonably be subdivided in meaningful ways as a general rule.</li>
</ul>
<p>In spite of this distinction, it is not uncommon for scholars to use a continuous data model (e.g.&nbsp;OLS) to examine data that are by their nature discrete. While the results of doing so are not always awful, they are suboptimal. If we treat a discrete ordered variable as if it is continuous, we are explicitly assuming that the distances between categories are equal. If this assumption is met, our estimates of <span class="math inline">\(\beta\)</span> might be unbiased (though the errors will be heteroskedastic and nonnormal); if this assumption is not met, then even the <span class="math inline">\(\beta\)</span>s are biased.</p>
</section>
<section id="discrete-ordered-variables" class="level2">
<h2 class="anchored" data-anchor-id="discrete-ordered-variables">Discrete Ordered Variables</h2>
<p>When we are interested in predicting an ordered (discrete) variable, we can turn to the ordered logit and probit models - these are natural extensions of the binary models we’ve already discussed and are not that much more complicated. I will focus on the ordered probit because it is more common in the literature, and because it can be easily extended to accommodate non constant errors.</p>
<p>What sorts of measures are ordinal? Likert scales, ranks, survey responses, eg. how much do you trust government to protect you from terrorists?</p>
<ul>
<li>not at all.</li>
<li>somewhat.</li>
<li>substantially.</li>
<li>completely.</li>
</ul>
<p>We can receive 4 meaningful responses (the fifth less meaningful response would be “no opinion, don’t know”) - we’d need this category for exhaustiveness.</p>
<p>These observed responses represent some latent variable, <em>trust in government</em>. We cannot directly observe this variable but can measure and observe these discrete manifestations of the unobserved variable.</p>
<p>When we estimate and interpret the discrete variable model, we are interested in the effect of <span class="math inline">\(x_i\)</span> on the underlying latent variable <span class="math inline">\(y^{*}\)</span>, though we only measure <span class="math inline">\(y_{i}\)</span>. We are really interested in the probability of any given level of trust in government, not in whether the mean of <span class="math inline">\(y\)</span> is 2.3 or 2.6; in fact, is this mean even meaningful? Given the latent variable motivation, no. This is part of the problem with linear regression on such variables.</p>
</section>
<section id="latent-variable-motivation" class="level2">
<h2 class="anchored" data-anchor-id="latent-variable-motivation">Latent Variable Motivation</h2>
<p>Begin with the binary case - assume a latent quantity we’re interested, denoted <span class="math inline">\(y^*\)</span>, but our observations of <span class="math inline">\(y\)</span> are limited to successes (<span class="math inline">\(y_i=1\)</span>) and failures (<span class="math inline">\(y_i=0\)</span>).</p>
<p><span class="math display">\[\begin{aligned}
y^{*}=\mathbf{x_i \beta}+\epsilon_i \nonumber
\end{aligned}\]</span></p>
<p>for <span class="math inline">\(y^{*}\)</span>, the latent variable,</p>
<p><span class="math display">\[ y_{i} = \left\{ \begin{array}{ll}
         0, &amp; \mbox{if $-\infty &lt; y^{*}_{i} \leq \tau_1 $} \\
         1, &amp; \mbox{if $\tau_1 &lt; y^{*}_{i} \leq \infty$}
         \end{array}
     \right. \]</span></p>
<p>where <span class="math inline">\(\tau_1\)</span> is an unobserved threshold.</p>
<p>Make probabilities statements, and let <span class="math inline">\(\tau_1=0\)</span>,</p>
<p><span class="math display">\[\begin{aligned}
Pr(y_i=1) = Pr(y^{*}_{1}&gt;0) \nonumber \\ \nonumber \\
=Pr(\mathbf{x_i \beta}+\epsilon_i&gt;0) \nonumber \\ \nonumber \\
=Pr(\epsilon_i&gt;-\mathbf{x_i \beta}) \nonumber
\end{aligned}\]</span></p>
<p>If <span class="math inline">\(F(\cdot)\)</span> is symmetric, then</p>
<p><span class="math display">\[\begin{aligned}
Pr(y_i=1)= Pr(\epsilon_i&lt;\mathbf{x_i \beta}) \nonumber
\end{aligned}\]</span></p>
<p><span class="math display">\[\begin{aligned}
Pr(y_i=1)=Pr(\epsilon_i&lt;\mathbf{x_i \beta}) \nonumber \\ \nonumber \\
=F(\mathbf{x_i \beta}) \nonumber
\end{aligned}\]</span></p>
<p>Relate to the binomial:</p>
<p><span class="math display">\[\begin{aligned}
\pi_i= Pr(y_i=1)=  F(\mathbf{x_i \beta})    \nonumber \\
1-\pi_i=Pr(y_i=0)= 1-F(\mathbf{x_i \beta}) \nonumber
\end{aligned}\]</span></p>
<p>Let <span class="math inline">\(\tau_1=0\)</span> (as above); let <span class="math inline">\(-\infty = \tau_0\)</span>; let <span class="math inline">\(\infty=\tau_2\)</span>. We now have <span class="math inline">\(j\)</span> categories of <span class="math inline">\(y\)</span> (<span class="math inline">\(j=2\)</span> in the binary case above), and we have <span class="math inline">\(j+1=3\)</span> unobserved thresholds, <span class="math inline">\(\tau_0, \tau_1, \tau_2\)</span>:</p>
<p><span class="math display">\[ y_{i} = \left\{ \begin{array}{ll}
         0, &amp; \mbox{if $\tau_0 &lt; y^{*}_{i} \leq \tau_1 $} \\
         1, &amp; \mbox{if $\tau_1 &lt; y^{*}_{i} \leq \tau_2$}
         \end{array}
     \right. \]</span></p>
<p>and extending,</p>
<p><span class="math display">\[ y_{i} = \left\{ \begin{array}{ll}
         0, &amp; \mbox{if $\tau_0 &lt; y^{*}_{i} \leq \tau_1 $} \\
         1, &amp; \mbox{if $\tau_1 &lt; y^{*}_{i} \leq \tau_2$} \\
         2, &amp; \mbox{if $\tau_2 &lt; y^{*}_{i} \leq \tau_3$} \\
         3, &amp; \mbox{if $\tau_3 &lt; y^{*}_{i} \leq \tau_4 $} \\
          &amp;$\ldots$ \\
          j, &amp; \mbox{if $\tau_{j-1} &lt; y^{*}_{i} \leq \tau_j $} \\
         \end{array}
     \right. \]</span></p>
<p>As before, let <span class="math inline">\(\tau_0= -\infty\)</span>, <span class="math inline">\(\tau_j=\infty\)</span>, and <span class="math inline">\(\tau_1=0\)</span>; so we need to estimate <span class="math inline">\(j-3\)</span> thresholds or values of <span class="math inline">\(\tau\)</span>.</p>
<p>Let’s relate the formal statement of what we observe (<span class="math inline">\(y_i=  j, \mbox{if }  \tau_{j-1} \leq y^{*}\)</span> etc.) to the survey example.</p>
<p>What are the <span class="math inline">\(\tau\)</span>s? These are the cutpoints or dividing thresholds between categories of our observed variable, <span class="math inline">\(y\)</span>. Thus, <span class="math inline">\(\tau_{1}\)</span> is the threshold between respondents that fall in the zero category and those that fall in the one category; <span class="math inline">\(\tau_{2}\)</span> is the threshold between one and two, etc.</p>
<p>These thresholds represent an important link between our underlying latent variable and the observed variable insofar as the thresholds measure the probability on the normal curve where we make the transition from one category to the other.</p>
<p>Recall where we started with the latent variable as a linear function of systematic and random components:</p>
<p><span class="math display">\[\begin{aligned}
y^{*}=\mathbf{x_i \beta}+\epsilon_i \nonumber
\end{aligned}\]</span></p>
<p>Substitute:</p>
<p><span class="math display">\[y_{i} = \left\{ \begin{array}{ll}
         0, &amp; \mbox{if $\tau_0 &lt; x_i \beta+\epsilon_i \leq \tau_1 $} \\
         1, &amp; \mbox{if $\tau_1 &lt; x_i \beta+\epsilon_i \leq \tau_2$} \\
         2, &amp; \mbox{if $\tau_2 &lt; x_i \beta+\epsilon_i \leq \tau_3$} \\
         3, &amp; \mbox{if $\tau_3 &lt; x_i \beta+\epsilon_i \leq \tau_4 $} \\
          &amp;$\ldots$ \\
          j, &amp; \mbox{if $\tau_{j-1} &lt; x_i \beta+\epsilon_i\leq \tau_j $} \\
         \end{array}
     \right. \]</span></p>
<p>If we had a survey question asking “How secure do you feel personally given the Department of Homeland Security’s handling of terrorist threats?” with the following results,</p>
<ul>
<li>not secure at all, I hide under the bed most days - 32%</li>
<li>somewhat secure, i’ve got lots of duct tape - 12%</li>
<li>very secure, i like the color charts a lot - 22%</li>
<li>more secure than I’ve ever felt, bring it on big daddy - 30%</li>
</ul>
<p>then these percentages represent the probability at which we shift from one category to the next. So these probabilities divide the normal (in the probit model) into 4 regions each containing the correct mass.</p>
<p><span class="math display">\[\begin{aligned}
\tau_1 = \Phi^{-1} (.32) = z(.32) = -.47  \nonumber
\end{aligned}\]</span></p>
<p>so the cutpoint or threshold is at -.47. The second threshold (<span class="math inline">\(\tau_2\)</span>) would be at</p>
<p><span class="math display">\[\begin{aligned}
\tau_2 = \Phi^{-1} (.32 + .12) =  -.15 \nonumber \\
\tau_3 = \Phi^{-1} (.32 + .12 + .22) =  .52  \nonumber
\end{aligned}\]</span></p>
</section>
<section id="cut-points" class="level2">
<h2 class="anchored" data-anchor-id="cut-points">Cut points</h2>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># normal pdf with vertical lines at -0.47, -.15, .52</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">100</span>, <span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span> )</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>pz <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(z)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>z, <span class="at">y=</span>pz), <span class="at">color=</span><span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="sc">-</span><span class="fl">0.47</span>, <span class="at">color=</span><span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="sc">-</span><span class="fl">0.15</span>, <span class="at">color=</span><span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">0.52</span>, <span class="at">color=</span><span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Normal Distribution with Cutpoints"</span>) <span class="sc">+</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="binaryextensions224_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>As a general rule, the probability <span class="math inline">\(y_i=j\)</span> is given by:</p>
<p><span class="math display">\[\begin{aligned}
Pr(y_i=j)= F(\tau_{j} -x_i\beta) - F(\tau_{j-1} - x_i\beta) \nonumber
\end{aligned}\]</span></p>
<p>so in the survey, the probability <span class="math inline">\(y_i=1\)</span> is the area between the two thresholds that delineate <span class="math inline">\(y_i=1\)</span>; so the area beneath <span class="math inline">\(\tau_1\)</span> and <span class="math inline">\(\tau_0=-\infty=0\)</span></p>
<p><span class="math display">\[\begin{aligned}
Pr(y_i=1)= F(\tau_{1} - x_i\beta) - 0 \nonumber \\
\mbox{or in the probit model} \nonumber \\
Pr(y_i=1)= \Phi(\tau_{1} - x_i\beta)  \nonumber
\end{aligned}\]</span></p>
<p>This formulation gives us the probability any observation falls in the area between thresholds, and thus provides us estimates of the probability of observing any particular value of the dependent variable.</p>
<p><span class="math display">\[\begin{aligned}
Pr(y_i=1)= \Phi(\tau_{1} - x_i\beta)  \nonumber \\
Pr(y_i=2)= \Phi(\tau_{2} - x_i\beta) - \Phi(\tau_{1} - x_i\beta)  \nonumber \\
Pr(y_i=3)= \Phi(\tau_{3} - x_i\beta) -\Phi(\tau_{2} - x_i\beta)  \nonumber \\
Pr(y_i=4)= 1- \Phi(\tau_{4} - x_i\beta) \nonumber
\end{aligned}\]</span></p>
<p>because <span class="math inline">\(\tau_4 = \infty = 1\)</span>.</p>
<section id="aside-on-link-functions" class="level3">
<h3 class="anchored" data-anchor-id="aside-on-link-functions">Aside on Link Functions</h3>
<p>I’ve only written this with a Normal (probit) link but the logit is just as easy:</p>
<p><span class="math display">\[\begin{aligned}
Pr(y_i=1)= F(\tau_{1} - x_i\beta) - 0 \nonumber \\
Pr(y_i=1)= \Lambda(\tau_{1} - x_i\beta) \\ \nonumber
Pr(y_i=1)= 1/(1+exp(-(\tau_{1} - x_i\beta)))  \nonumber
\end{aligned}\]</span></p>
</section>
</section>
<section id="example" class="level2">
<h2 class="anchored" data-anchor-id="example">Example</h2>
<p>Recall our survey questions:</p>
<ul>
<li>not secure at all.</li>
<li>somewhat secure.</li>
<li>very secure.</li>
<li>more secure than I’ve ever felt, bring it on big daddy.</li>
</ul>
<p>And imagine we also have data on respondents’</p>
<ul>
<li>years of education (0-16)</li>
<li>gender (0 = female; 1 = male)</li>
<li>party id (0 = democrat; 1 = republican)</li>
</ul>
<p>Suppose we use an ordered probit to regress survey response (increasing in security), on education, gender, and party:</p>
<div class="center">
<div id="tab:security">
<table class="caption-top table">
<caption>Fake Estimates: Perceptions of Security</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">X</td>
<td style="text-align: center;"><span class="math inline">\(\widehat{\beta}\)</span></td>
<td style="text-align: center;">s.e.</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">gender</td>
<td style="text-align: center;">-1.0</td>
<td style="text-align: center;">(.22)</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">party id</td>
<td style="text-align: center;">+2.0</td>
<td style="text-align: center;">(.034)</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">education</td>
<td style="text-align: center;">+0.6</td>
<td style="text-align: center;">(.11)</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">constant</td>
<td style="text-align: center;">-4.0</td>
<td style="text-align: center;">(1.2)</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\tau_2\)</span></td>
<td style="text-align: center;">+1.5</td>
<td style="text-align: center;">(.51)</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\tau_3\)</span></td>
<td style="text-align: center;">+3</td>
<td style="text-align: center;">(.42)</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Recall that <span class="math inline">\(\tau_0=-\infty\)</span>; <span class="math inline">\(\tau_1=0\)</span>; and <span class="math inline">\(\tau_4=+\infty =1\)</span>; the constant shifts <span class="math inline">\(\tau_1\)</span>.</p>
<p>Shifting <span class="math inline">\(x\beta\)</span> shifts the curve left and right …</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load required libraries</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Set seed for reproducibility</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">10</span>, <span class="at">length.out =</span> n)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate normal densities</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(z, <span class="at">mean =</span> <span class="fl">4.2</span>, <span class="at">sd =</span> <span class="fu">sqrt</span>(<span class="dv">12</span>))</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(z, <span class="at">mean =</span> <span class="fl">5.2</span>, <span class="at">sd =</span> <span class="fu">sqrt</span>(<span class="dv">12</span>))</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Define thresholds</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>t1 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>t2 <span class="ot">&lt;-</span> <span class="fl">1.5</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>t3 <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data frame</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">z =</span> z, <span class="at">a =</span> a, <span class="at">b =</span> b)</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to create plots</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>create_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(data, y_var, title, x_beta) {</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> z)) <span class="sc">+</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes_string</span>(<span class="at">y =</span> y_var)) <span class="sc">+</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(t1, t2, t3), <span class="at">linetype =</span> <span class="st">"dotted"</span>) <span class="sc">+</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="fl">0.014</span>, <span class="at">label =</span> <span class="st">"τ[1]"</span>), <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">hjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="fl">0.014</span>, <span class="at">label =</span> <span class="st">"τ[2]"</span>), <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">hjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">4</span>, <span class="at">y =</span> <span class="fl">0.014</span>, <span class="at">label =</span> <span class="st">"τ[3]"</span>), <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">hjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">y =</span> <span class="fl">0.057</span>, <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"xβ="</span>, x_beta)), <span class="at">hjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="sc">-</span><span class="dv">4</span>, <span class="at">y =</span> <span class="fl">0.072</span>, <span class="at">label =</span> title), <span class="at">hjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>    <span class="co">#theme_minimal() +</span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(), <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title =</span> <span class="fu">element_blank</span>(), <span class="at">legend.position =</span> <span class="st">"none"</span>)  </span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plots</span></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">create_plot</span>(df, <span class="st">"a"</span>, <span class="st">"Male, Republican, HS grad"</span>, <span class="fl">4.2</span>)</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">create_plot</span>(df, <span class="st">"b"</span>, <span class="st">"Female, Republican, HS grad"</span>, <span class="fl">5.2</span>)</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Combined plot</span></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> z)) <span class="sc">+</span></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> a), <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> b), <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(t1, t2, t3), <span class="at">linetype =</span> <span class="st">"dotted"</span>) <span class="sc">+</span></span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="fl">0.014</span>, <span class="at">label =</span> <span class="st">"τ[1]"</span>), <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">hjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="fl">0.014</span>, <span class="at">label =</span> <span class="st">"τ[2]"</span>), <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">hjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">4</span>, <span class="at">y =</span> <span class="fl">0.014</span>, <span class="at">label =</span> <span class="st">"τ[3]"</span>), <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">hjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">y =</span> <span class="fl">0.05</span>, <span class="at">label =</span> <span class="st">"xβ=4.2"</span>), <span class="at">hjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">6.0</span>, <span class="at">y =</span> <span class="fl">0.099</span>, <span class="at">label =</span> <span class="st">"Female, Republican, HS grad"</span>), <span class="at">hjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">6.5</span>, <span class="at">y =</span> <span class="fl">0.08</span>, <span class="at">label =</span> <span class="st">"xβ=5.2"</span>), <span class="at">hjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="sc">-</span><span class="dv">4</span>, <span class="at">y =</span> <span class="fl">0.067</span>, <span class="at">label =</span> <span class="st">"Male, Republican, HS grad"</span>), <span class="at">hjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_text(aes(x = -4, y = 0.072, label = "Shift in latent variable given change in xβ. Difference is estimate on Gender (β=-1)"), hjust = 0) +</span></span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(), <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_blank</span>(), <span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">caption=</span><span class="st">"Shift in latent variable given change in xβ. Difference is estimate on Gender (β=-1)"</span>)</span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a>p1<span class="sc">/</span>p2<span class="sc">/</span>p3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="binaryextensions224_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load required libraries</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Set seed for reproducibility</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">10</span>, <span class="at">length.out =</span> n)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate normal densities</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(z, <span class="at">mean =</span> <span class="fl">4.2</span>, <span class="at">sd =</span> <span class="fu">sqrt</span>(<span class="dv">12</span>))</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(z, <span class="at">mean =</span> <span class="fl">5.2</span>, <span class="at">sd =</span> <span class="fu">sqrt</span>(<span class="dv">12</span>))</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Define thresholds</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>t1 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>t2 <span class="ot">&lt;-</span> <span class="fl">1.5</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>t3 <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data frame</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">z =</span> z, <span class="at">a =</span> a, <span class="at">b =</span> b)</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the interactive plot</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>() <span class="sc">%&gt;%</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_lines</span>(<span class="at">x =</span> <span class="sc">~</span>z, <span class="at">y =</span> <span class="sc">~</span>a, <span class="at">data =</span> df, <span class="at">name =</span> <span class="st">"Male"</span>, <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"#005A43"</span>), <span class="at">visible =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_lines</span>(<span class="at">x =</span> <span class="sc">~</span>z, <span class="at">y =</span> <span class="sc">~</span>b, <span class="at">data =</span> df, <span class="at">name =</span> <span class="st">"Female"</span>, <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"#6CC24A"</span>), <span class="at">visible =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_segments</span>(<span class="at">x =</span> t1, <span class="at">xend =</span> t1, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> <span class="fl">0.045</span>, <span class="at">line =</span> <span class="fu">list</span>(<span class="at">dash =</span> <span class="st">"solid"</span>,<span class="at">color =</span> <span class="st">"#6CC24A"</span>), <span class="at">showlegend =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_segments</span>(<span class="at">x =</span> t2, <span class="at">xend =</span> t2, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> <span class="fl">0.045</span>, <span class="at">line =</span> <span class="fu">list</span>(<span class="at">dash =</span> <span class="st">"solid"</span>,<span class="at">color =</span> <span class="st">"#6CC24A"</span>), <span class="at">showlegend =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_segments</span>(<span class="at">x =</span> t3, <span class="at">xend =</span> t3, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> <span class="fl">0.045</span>, <span class="at">line =</span> <span class="fu">list</span>(<span class="at">dash =</span> <span class="st">"solid"</span>, <span class="at">color =</span> <span class="st">"#6CC24A"</span>), <span class="at">showlegend =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_annotations</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.5</span>, <span class="dv">4</span>), <span class="at">y =</span> <span class="fl">0.014</span>, <span class="at">text =</span> <span class="fu">c</span>(<span class="st">"τ[1]"</span>, <span class="st">"τ[2]"</span>, <span class="st">"τ[3]"</span>), <span class="at">showarrow =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">showlegend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">""</span>, <span class="at">range =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">10</span>)),</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">""</span>, <span class="at">showticklabels =</span> <span class="cn">FALSE</span>),</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">annotations =</span> <span class="fu">list</span>(</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(<span class="at">x =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">y =</span> <span class="fl">0.05</span>, <span class="at">text =</span> <span class="st">"xβ=4.2"</span>, <span class="at">showarrow =</span> <span class="cn">FALSE</span>, <span class="at">visible =</span> <span class="cn">TRUE</span>),</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(<span class="at">x =</span> <span class="sc">-</span><span class="dv">4</span>, <span class="at">y =</span> <span class="fl">0.059</span>, <span class="at">text =</span> <span class="st">"Male, Republican, HS grad"</span>, <span class="at">showarrow =</span> <span class="cn">FALSE</span>, <span class="at">visible =</span> <span class="cn">TRUE</span>),</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(<span class="at">x =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">y =</span> <span class="fl">0.01</span>, <span class="at">text =</span> <span class="st">"xβ=5.2"</span>, <span class="at">showarrow =</span> <span class="cn">FALSE</span>, <span class="at">visible =</span> <span class="cn">FALSE</span>),</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(<span class="at">x =</span> <span class="sc">-</span><span class="dv">4</span>, <span class="at">y =</span> <span class="fl">0.059</span>, <span class="at">text =</span> <span class="st">"Female, Republican, HS grad"</span>, <span class="at">showarrow =</span> <span class="cn">FALSE</span>, <span class="at">visible =</span> <span class="cn">FALSE</span>),</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(<span class="at">x =</span> <span class="sc">-</span><span class="dv">4</span>, <span class="at">y =</span> <span class="fl">0.028</span>, <span class="at">text =</span> <span class="st">"Shift in latent variable given change in xβ.&lt;br&gt;Difference is estimate on Gender (β=-1)"</span>, <span class="at">showarrow =</span> <span class="cn">FALSE</span>, <span class="at">visible =</span> <span class="cn">FALSE</span>)</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">updatemenus =</span> <span class="fu">list</span>(</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(</span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">type =</span> <span class="st">"buttons"</span>,</span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">direction =</span> <span class="st">"right"</span>,</span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="fl">0.1</span>,</span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="fl">1.2</span>,</span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">buttons =</span> <span class="fu">list</span>(</span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>          <span class="fu">list</span>(<span class="at">method =</span> <span class="st">"update"</span>,</span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>               <span class="at">args =</span> <span class="fu">list</span>(</span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">list</span>(<span class="at">visible =</span> <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span>)),</span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Male, Republican, HS grad"</span>,</span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>                      <span class="at">annotations =</span> <span class="fu">list</span>(</span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">list</span>(<span class="at">x =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">y =</span> <span class="fl">0.05</span>, <span class="at">text =</span> <span class="st">"xβ=4.2"</span>, <span class="at">showarrow =</span> <span class="cn">FALSE</span>, <span class="at">visible =</span> <span class="cn">TRUE</span>),</span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">list</span>(<span class="at">x =</span> <span class="sc">-</span><span class="dv">4</span>, <span class="at">y =</span> <span class="fl">0.059</span>, <span class="at">text =</span> <span class="st">"Male, Republican, HS grad"</span>, <span class="at">showarrow =</span> <span class="cn">FALSE</span>, <span class="at">visible =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>                      ))</span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>               ),</span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>               <span class="at">label =</span> <span class="st">"Figure 1"</span>),</span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a>          <span class="fu">list</span>(<span class="at">method =</span> <span class="st">"update"</span>,</span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>               <span class="at">args =</span> <span class="fu">list</span>(</span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">list</span>(<span class="at">visible =</span> <span class="fu">c</span>(<span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span>)),</span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Female, Republican, HS grad"</span>,</span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>                      <span class="at">annotations =</span> <span class="fu">list</span>(</span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">list</span>(<span class="at">x =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">y =</span> <span class="fl">0.05</span>, <span class="at">text =</span> <span class="st">"xβ=5.2"</span>, <span class="at">showarrow =</span> <span class="cn">FALSE</span>, <span class="at">visible =</span> <span class="cn">TRUE</span>),</span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">list</span>(<span class="at">x =</span> <span class="sc">-</span><span class="dv">4</span>, <span class="at">y =</span> <span class="fl">0.059</span>, <span class="at">text =</span> <span class="st">"Female, Republican, HS grad"</span>, <span class="at">showarrow =</span> <span class="cn">FALSE</span>, <span class="at">visible =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a>                      ))</span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a>               ),</span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a>               <span class="at">label =</span> <span class="st">"Figure 2"</span>),</span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a>          <span class="fu">list</span>(<span class="at">method =</span> <span class="st">"update"</span>,</span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a>               <span class="at">args =</span> <span class="fu">list</span>(</span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">list</span>(<span class="at">visible =</span> <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span>)),</span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Combined Plot"</span>,</span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a>                      <span class="at">annotations =</span> <span class="fu">list</span>(</span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">list</span>(<span class="at">x =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">y =</span> <span class="fl">0.05</span>, <span class="at">text =</span> <span class="st">"xβ=4.2"</span>, <span class="at">showarrow =</span> <span class="cn">FALSE</span>, <span class="at">visible =</span> <span class="cn">TRUE</span>),</span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">list</span>(<span class="at">x =</span> <span class="sc">-</span><span class="dv">4</span>, <span class="at">y =</span> <span class="fl">0.059</span>, <span class="at">text =</span> <span class="st">"Male, Republican, HS grad"</span>, <span class="at">showarrow =</span> <span class="cn">FALSE</span>, <span class="at">visible =</span> <span class="cn">TRUE</span>),</span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">list</span>(<span class="at">x =</span> <span class="fl">6.5</span>, <span class="at">y =</span> <span class="fl">0.059</span>, <span class="at">text =</span> <span class="st">"Female, Republican, HS grad"</span>, <span class="at">showarrow =</span> <span class="cn">FALSE</span>, <span class="at">visible =</span> <span class="cn">TRUE</span>),</span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">list</span>(<span class="at">x =</span> <span class="fl">6.5</span>, <span class="at">y =</span> <span class="fl">0.05</span>, <span class="at">text =</span> <span class="st">"xβ=5.2"</span>, <span class="at">showarrow =</span> <span class="cn">FALSE</span>, <span class="at">visible =</span> <span class="cn">TRUE</span>),</span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">list</span>(<span class="at">x =</span> <span class="sc">-</span><span class="dv">4</span>, <span class="at">y =</span> <span class="fl">0.028</span>, <span class="at">text =</span> <span class="st">"Shift in latent variable given change in xβ.&lt;br&gt;Difference is estimate on Gender (β=-1)"</span>, <span class="at">showarrow =</span> <span class="cn">FALSE</span>, <span class="at">visible =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a>                      ))</span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true" tabindex="-1"></a>               ),</span>
<span id="cb3-81"><a href="#cb3-81" aria-hidden="true" tabindex="-1"></a>               <span class="at">label =</span> <span class="st">"Figure 3"</span>)</span>
<span id="cb3-82"><a href="#cb3-82" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb3-83"><a href="#cb3-83" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb3-84"><a href="#cb3-84" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb3-85"><a href="#cb3-85" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb3-86"><a href="#cb3-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-87"><a href="#cb3-87" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the plot as an HTML file</span></span>
<span id="cb3-88"><a href="#cb3-88" aria-hidden="true" tabindex="-1"></a>htmlwidgets<span class="sc">::</span><span class="fu">saveWidget</span>(plot, <span class="st">"interactive_ordered_probit_plot.html"</span>)</span>
<span id="cb3-89"><a href="#cb3-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-90"><a href="#cb3-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-91"><a href="#cb3-91" aria-hidden="true" tabindex="-1"></a>plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-f30d7598595affc4f25a" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-f30d7598595affc4f25a">{"x":{"visdat":{"871c1b79a300":["function () ","plotlyVisDat"],"871c4ebc6317":["function () ","data"],"871c320da363":["function () ","data"]},"cur_data":"871c320da363","attrs":{"871c4ebc6317":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"type":"scatter","mode":"lines","name":"Male","line":{"color":"#005A43"},"visible":true,"inherit":true},"871c320da363":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"type":"scatter","mode":"lines","name":"Female","line":{"color":"#6CC24A"},"visible":false,"inherit":true},"871c320da363.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":0,"y":0,"xend":0,"yend":0.044999999999999998,"type":"scatter","mode":"lines","line":{"dash":"solid","color":"#6CC24A"},"showlegend":false,"inherit":true},"871c320da363.2":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":1.5,"y":0,"xend":1.5,"yend":0.044999999999999998,"type":"scatter","mode":"lines","line":{"dash":"solid","color":"#6CC24A"},"showlegend":false,"inherit":true},"871c320da363.3":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":4,"y":0,"xend":4,"yend":0.044999999999999998,"type":"scatter","mode":"lines","line":{"dash":"solid","color":"#6CC24A"},"showlegend":false,"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"annotations":[{"text":"τ[1]","x":0,"y":0.014,"showarrow":false},{"text":"τ[2]","x":1.5,"y":0.014,"showarrow":false},{"text":"τ[3]","x":4,"y":0.014,"showarrow":false},{"x":-3,"y":0.050000000000000003,"text":"xβ=4.2","showarrow":false,"visible":true},{"x":-4,"y":0.058999999999999997,"text":"Male, Republican, HS grad","showarrow":false,"visible":true},{"x":-3,"y":0.01,"text":"xβ=5.2","showarrow":false,"visible":false},{"x":-4,"y":0.058999999999999997,"text":"Female, Republican, HS grad","showarrow":false,"visible":false},{"x":-4,"y":0.028000000000000001,"text":"Shift in latent variable given change in xβ.<br>Difference is estimate on Gender (β=-1)","showarrow":false,"visible":false}],"showlegend":false,"xaxis":{"domain":[0,1],"automargin":true,"title":"","range":[-5,10]},"yaxis":{"domain":[0,1],"automargin":true,"title":"","showticklabels":false},"updatemenus":[{"type":"buttons","direction":"right","x":0.10000000000000001,"y":1.2,"buttons":[{"method":"update","args":[{"visible":[true,false,true,true,true,true,true]},{"title":"Male, Republican, HS grad","annotations":[{"x":-3,"y":0.050000000000000003,"text":"xβ=4.2","showarrow":false,"visible":true},{"x":-4,"y":0.058999999999999997,"text":"Male, Republican, HS grad","showarrow":false,"visible":true}]}],"label":"Figure 1"},{"method":"update","args":[{"visible":[false,true,true,true,true,true,true]},{"title":"Female, Republican, HS grad","annotations":[{"x":-3,"y":0.050000000000000003,"text":"xβ=5.2","showarrow":false,"visible":true},{"x":-4,"y":0.058999999999999997,"text":"Female, Republican, HS grad","showarrow":false,"visible":true}]}],"label":"Figure 2"},{"method":"update","args":[{"visible":[true,true,true,true,true,true,true]},{"title":"Combined Plot","annotations":[{"x":-3,"y":0.050000000000000003,"text":"xβ=4.2","showarrow":false,"visible":true},{"x":-4,"y":0.058999999999999997,"text":"Male, Republican, HS grad","showarrow":false,"visible":true},{"x":6.5,"y":0.058999999999999997,"text":"Female, Republican, HS grad","showarrow":false,"visible":true},{"x":6.5,"y":0.050000000000000003,"text":"xβ=5.2","showarrow":false,"visible":true},{"x":-4,"y":0.028000000000000001,"text":"Shift in latent variable given change in xβ.<br>Difference is estimate on Gender (β=-1)","showarrow":false,"visible":true}]}],"label":"Figure 3"}]}],"hovermode":"closest"},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[-5,-4.984984984984985,-4.96996996996997,-4.954954954954955,-4.93993993993994,-4.924924924924925,-4.9099099099099099,-4.8948948948948949,-4.8798798798798799,-4.8648648648648649,-4.8498498498498499,-4.8348348348348349,-4.8198198198198199,-4.8048048048048049,-4.7897897897897899,-4.7747747747747749,-4.7597597597597598,-4.7447447447447448,-4.7297297297297298,-4.7147147147147148,-4.6996996996996998,-4.6846846846846848,-4.6696696696696698,-4.6546546546546548,-4.6396396396396398,-4.6246246246246248,-4.6096096096096097,-4.5945945945945947,-4.5795795795795797,-4.5645645645645647,-4.5495495495495497,-4.5345345345345347,-4.5195195195195197,-4.5045045045045047,-4.4894894894894897,-4.4744744744744747,-4.4594594594594597,-4.4444444444444446,-4.4294294294294296,-4.4144144144144146,-4.3993993993993996,-4.3843843843843846,-4.3693693693693696,-4.3543543543543546,-4.3393393393393396,-4.3243243243243246,-4.3093093093093096,-4.2942942942942945,-4.2792792792792795,-4.2642642642642645,-4.2492492492492495,-4.2342342342342345,-4.2192192192192195,-4.2042042042042045,-4.1891891891891895,-4.1741741741741745,-4.1591591591591595,-4.1441441441441444,-4.1291291291291294,-4.1141141141141144,-4.0990990990990994,-4.0840840840840844,-4.0690690690690694,-4.0540540540540544,-4.0390390390390394,-4.0240240240240244,-4.0090090090090094,-3.9939939939939939,-3.9789789789789789,-3.9639639639639639,-3.9489489489489489,-3.9339339339339339,-3.9189189189189189,-3.9039039039039038,-3.8888888888888888,-3.8738738738738738,-3.8588588588588588,-3.8438438438438438,-3.8288288288288288,-3.8138138138138138,-3.7987987987987988,-3.7837837837837838,-3.7687687687687688,-3.7537537537537538,-3.7387387387387387,-3.7237237237237237,-3.7087087087087087,-3.6936936936936937,-3.6786786786786787,-3.6636636636636637,-3.6486486486486487,-3.6336336336336337,-3.6186186186186187,-3.6036036036036037,-3.5885885885885886,-3.5735735735735736,-3.5585585585585586,-3.5435435435435436,-3.5285285285285286,-3.5135135135135136,-3.4984984984984986,-3.4834834834834836,-3.4684684684684686,-3.4534534534534536,-3.4384384384384385,-3.4234234234234235,-3.4084084084084085,-3.3933933933933931,-3.3783783783783781,-3.3633633633633631,-3.348348348348348,-3.333333333333333,-3.318318318318318,-3.303303303303303,-3.288288288288288,-3.273273273273273,-3.258258258258258,-3.243243243243243,-3.228228228228228,-3.213213213213213,-3.198198198198198,-3.1831831831831829,-3.1681681681681679,-3.1531531531531529,-3.1381381381381379,-3.1231231231231229,-3.1081081081081079,-3.0930930930930929,-3.0780780780780779,-3.0630630630630629,-3.0480480480480479,-3.0330330330330328,-3.0180180180180178,-3.0030030030030028,-2.9879879879879878,-2.9729729729729728,-2.9579579579579578,-2.9429429429429428,-2.9279279279279278,-2.9129129129129128,-2.8978978978978978,-2.8828828828828827,-2.8678678678678677,-2.8528528528528527,-2.8378378378378377,-2.8228228228228227,-2.8078078078078077,-2.7927927927927927,-2.7777777777777777,-2.7627627627627627,-2.7477477477477477,-2.7327327327327327,-2.7177177177177176,-2.7027027027027026,-2.6876876876876876,-2.6726726726726726,-2.6576576576576576,-2.6426426426426426,-2.6276276276276276,-2.6126126126126126,-2.5975975975975976,-2.5825825825825826,-2.5675675675675675,-2.5525525525525525,-2.5375375375375375,-2.5225225225225225,-2.5075075075075075,-2.4924924924924925,-2.4774774774774775,-2.4624624624624625,-2.4474474474474475,-2.4324324324324325,-2.4174174174174174,-2.4024024024024024,-2.3873873873873874,-2.3723723723723724,-2.3573573573573574,-2.3423423423423424,-2.3273273273273274,-2.3123123123123124,-2.2972972972972974,-2.2822822822822824,-2.2672672672672673,-2.2522522522522523,-2.2372372372372373,-2.2222222222222223,-2.2072072072072073,-2.1921921921921923,-2.1771771771771773,-2.1621621621621623,-2.1471471471471473,-2.1321321321321323,-2.1171171171171173,-2.1021021021021022,-2.0870870870870872,-2.0720720720720722,-2.0570570570570572,-2.0420420420420422,-2.0270270270270272,-2.0120120120120122,-1.9969969969969972,-1.9819819819819822,-1.9669669669669672,-1.9519519519519521,-1.9369369369369371,-1.9219219219219221,-1.9069069069069071,-1.8918918918918921,-1.8768768768768771,-1.8618618618618621,-1.8468468468468471,-1.8318318318318321,-1.8168168168168171,-1.801801801801802,-1.7867867867867866,-1.7717717717717716,-1.7567567567567566,-1.7417417417417416,-1.7267267267267266,-1.7117117117117115,-1.6966966966966965,-1.6816816816816815,-1.6666666666666665,-1.6516516516516515,-1.6366366366366365,-1.6216216216216215,-1.6066066066066065,-1.5915915915915915,-1.5765765765765765,-1.5615615615615615,-1.5465465465465464,-1.5315315315315314,-1.5165165165165164,-1.5015015015015014,-1.4864864864864864,-1.4714714714714714,-1.4564564564564564,-1.4414414414414414,-1.4264264264264264,-1.4114114114114114,-1.3963963963963963,-1.3813813813813813,-1.3663663663663663,-1.3513513513513513,-1.3363363363363363,-1.3213213213213213,-1.3063063063063063,-1.2912912912912913,-1.2762762762762763,-1.2612612612612613,-1.2462462462462462,-1.2312312312312312,-1.2162162162162162,-1.2012012012012012,-1.1861861861861862,-1.1711711711711712,-1.1561561561561562,-1.1411411411411412,-1.1261261261261262,-1.1111111111111112,-1.0960960960960962,-1.0810810810810811,-1.0660660660660661,-1.0510510510510511,-1.0360360360360361,-1.0210210210210211,-1.0060060060060061,-0.99099099099099064,-0.97597597597597563,-0.96096096096096062,-0.94594594594594561,-0.9309309309309306,-0.91591591591591559,-0.90090090090090058,-0.88588588588588557,-0.87087087087087056,-0.85585585585585555,-0.84084084084084054,-0.82582582582582553,-0.81081081081081052,-0.79579579579579551,-0.7807807807807805,-0.76576576576576549,-0.75075075075075048,-0.73573573573573547,-0.72072072072072046,-0.70570570570570545,-0.69069069069069045,-0.67567567567567544,-0.66066066066066043,-0.64564564564564542,-0.63063063063063041,-0.6156156156156154,-0.60060060060060039,-0.58558558558558538,-0.57057057057057037,-0.55555555555555536,-0.54054054054054035,-0.52552552552552534,-0.51051051051051033,-0.49549549549549532,-0.48048048048048031,-0.4654654654654653,-0.45045045045045029,-0.43543543543543528,-0.42042042042042027,-0.40540540540540526,-0.39039039039039025,-0.37537537537537524,-0.36036036036036023,-0.34534534534534522,-0.33033033033033021,-0.3153153153153152,-0.30030030030030019,-0.28528528528528518,-0.27027027027027017,-0.25525525525525516,-0.24024024024024015,-0.22522522522522515,-0.21021021021021014,-0.19519519519519513,-0.18018018018018012,-0.16516516516516511,-0.1501501501501501,-0.13513513513513509,-0.12012012012012008,-0.10510510510510507,-0.090090090090090058,-0.075075075075075048,-0.060060060060060039,-0.045045045045045029,-0.030030030030030019,-0.01501501501501501,0,0.01501501501501501,0.030030030030030019,0.045045045045045029,0.060060060060060039,0.075075075075075048,0.090090090090090058,0.10510510510510507,0.12012012012012008,0.13513513513513509,0.1501501501501501,0.16516516516516511,0.18018018018018012,0.19519519519519513,0.21021021021021014,0.22522522522522515,0.24024024024024015,0.25525525525525516,0.27027027027027017,0.28528528528528518,0.30030030030030019,0.3153153153153152,0.33033033033033021,0.34534534534534522,0.36036036036036023,0.37537537537537524,0.39039039039039025,0.40540540540540526,0.42042042042042027,0.43543543543543528,0.45045045045045029,0.4654654654654653,0.48048048048048031,0.49549549549549532,0.51051051051051033,0.52552552552552534,0.54054054054054035,0.55555555555555536,0.57057057057057037,0.58558558558558538,0.60060060060060039,0.6156156156156154,0.63063063063063041,0.64564564564564542,0.66066066066066043,0.67567567567567544,0.69069069069069045,0.70570570570570545,0.72072072072072046,0.73573573573573547,0.75075075075075048,0.76576576576576549,0.7807807807807805,0.79579579579579551,0.81081081081081052,0.82582582582582553,0.84084084084084054,0.85585585585585555,0.87087087087087056,0.88588588588588557,0.90090090090090058,0.91591591591591559,0.9309309309309306,0.94594594594594561,0.96096096096096062,0.97597597597597563,0.99099099099099064,1.0060060060060056,1.0210210210210207,1.0360360360360357,1.0510510510510507,1.0660660660660657,1.0810810810810807,1.0960960960960957,1.1111111111111107,1.1261261261261257,1.1411411411411407,1.1561561561561557,1.1711711711711708,1.1861861861861858,1.2012012012012008,1.2162162162162158,1.2312312312312308,1.2462462462462458,1.2612612612612608,1.2762762762762758,1.2912912912912908,1.3063063063063058,1.3213213213213209,1.3363363363363359,1.3513513513513509,1.3663663663663659,1.3813813813813809,1.3963963963963959,1.4114114114114118,1.4264264264264268,1.4414414414414418,1.4564564564564568,1.4714714714714718,1.4864864864864868,1.5015015015015019,1.5165165165165169,1.5315315315315319,1.5465465465465469,1.5615615615615619,1.5765765765765769,1.5915915915915919,1.6066066066066069,1.6216216216216219,1.6366366366366369,1.651651651651652,1.666666666666667,1.681681681681682,1.696696696696697,1.711711711711712,1.726726726726727,1.741741741741742,1.756756756756757,1.771771771771772,1.786786786786787,1.801801801801802,1.8168168168168171,1.8318318318318321,1.8468468468468471,1.8618618618618621,1.8768768768768771,1.8918918918918921,1.9069069069069071,1.9219219219219221,1.9369369369369371,1.9519519519519521,1.9669669669669672,1.9819819819819822,1.9969969969969972,2.0120120120120122,2.0270270270270272,2.0420420420420422,2.0570570570570572,2.0720720720720722,2.0870870870870872,2.1021021021021022,2.1171171171171173,2.1321321321321323,2.1471471471471473,2.1621621621621623,2.1771771771771773,2.1921921921921923,2.2072072072072073,2.2222222222222223,2.2372372372372373,2.2522522522522523,2.2672672672672673,2.2822822822822824,2.2972972972972974,2.3123123123123124,2.3273273273273274,2.3423423423423424,2.3573573573573574,2.3723723723723724,2.3873873873873874,2.4024024024024024,2.4174174174174174,2.4324324324324325,2.4474474474474475,2.4624624624624625,2.4774774774774775,2.4924924924924925,2.5075075075075075,2.5225225225225225,2.5375375375375375,2.5525525525525525,2.5675675675675675,2.5825825825825826,2.5975975975975976,2.6126126126126126,2.6276276276276276,2.6426426426426426,2.6576576576576576,2.6726726726726726,2.6876876876876876,2.7027027027027026,2.7177177177177176,2.7327327327327327,2.7477477477477477,2.7627627627627627,2.7777777777777777,2.7927927927927927,2.8078078078078077,2.8228228228228227,2.8378378378378377,2.8528528528528527,2.8678678678678677,2.8828828828828827,2.8978978978978978,2.9129129129129128,2.9279279279279278,2.9429429429429428,2.9579579579579578,2.9729729729729728,2.9879879879879878,3.0030030030030037,3.0180180180180187,3.0330330330330337,3.0480480480480487,3.0630630630630638,3.0780780780780788,3.0930930930930938,3.1081081081081088,3.1231231231231238,3.1381381381381388,3.1531531531531538,3.1681681681681688,3.1831831831831838,3.1981981981981988,3.2132132132132138,3.2282282282282289,3.2432432432432439,3.2582582582582589,3.2732732732732739,3.2882882882882889,3.3033033033033039,3.3183183183183189,3.3333333333333339,3.3483483483483489,3.3633633633633639,3.378378378378379,3.393393393393394,3.408408408408409,3.423423423423424,3.438438438438439,3.453453453453454,3.468468468468469,3.483483483483484,3.498498498498499,3.513513513513514,3.5285285285285291,3.5435435435435441,3.5585585585585591,3.5735735735735741,3.5885885885885891,3.6036036036036041,3.6186186186186191,3.6336336336336341,3.6486486486486491,3.6636636636636641,3.6786786786786791,3.6936936936936942,3.7087087087087092,3.7237237237237242,3.7387387387387392,3.7537537537537542,3.7687687687687692,3.7837837837837842,3.7987987987987992,3.8138138138138142,3.8288288288288292,3.8438438438438443,3.8588588588588593,3.8738738738738743,3.8888888888888893,3.9039039039039043,3.9189189189189193,3.9339339339339343,3.9489489489489493,3.9639639639639643,3.9789789789789793,3.9939939939939944,4.0090090090090094,4.0240240240240244,4.0390390390390394,4.0540540540540544,4.0690690690690694,4.0840840840840844,4.0990990990990994,4.1141141141141144,4.1291291291291294,4.1441441441441444,4.1591591591591595,4.1741741741741745,4.1891891891891895,4.2042042042042045,4.2192192192192195,4.2342342342342345,4.2492492492492495,4.2642642642642645,4.2792792792792795,4.2942942942942945,4.3093093093093096,4.3243243243243246,4.3393393393393396,4.3543543543543546,4.3693693693693696,4.3843843843843846,4.3993993993993996,4.4144144144144146,4.4294294294294296,4.4444444444444446,4.4594594594594597,4.4744744744744747,4.4894894894894897,4.5045045045045047,4.5195195195195197,4.5345345345345347,4.5495495495495497,4.5645645645645647,4.5795795795795797,4.5945945945945947,4.6096096096096097,4.6246246246246248,4.6396396396396398,4.6546546546546548,4.6696696696696698,4.6846846846846848,4.6996996996996998,4.7147147147147148,4.7297297297297298,4.7447447447447448,4.7597597597597598,4.7747747747747749,4.7897897897897899,4.8048048048048049,4.8198198198198199,4.8348348348348349,4.8498498498498499,4.8648648648648649,4.8798798798798799,4.8948948948948949,4.9099099099099099,4.924924924924925,4.93993993993994,4.954954954954955,4.96996996996997,4.984984984984985,5,5.015015015015015,5.03003003003003,5.045045045045045,5.06006006006006,5.075075075075075,5.0900900900900901,5.1051051051051051,5.1201201201201201,5.1351351351351351,5.1501501501501501,5.1651651651651651,5.1801801801801801,5.1951951951951951,5.2102102102102101,5.2252252252252251,5.2402402402402402,5.2552552552552552,5.2702702702702702,5.2852852852852852,5.3003003003003002,5.3153153153153152,5.3303303303303302,5.3453453453453452,5.3603603603603602,5.3753753753753752,5.3903903903903903,5.4054054054054053,5.4204204204204203,5.4354354354354353,5.4504504504504503,5.4654654654654653,5.4804804804804803,5.4954954954954953,5.5105105105105103,5.5255255255255253,5.5405405405405403,5.5555555555555554,5.5705705705705704,5.5855855855855854,5.6006006006006004,5.6156156156156154,5.6306306306306304,5.6456456456456454,5.6606606606606604,5.6756756756756754,5.6906906906906904,5.7057057057057055,5.7207207207207205,5.7357357357357355,5.7507507507507505,5.7657657657657655,5.7807807807807805,5.7957957957957955,5.8108108108108105,5.8258258258258255,5.8408408408408405,5.8558558558558556,5.8708708708708706,5.8858858858858856,5.9009009009009006,5.9159159159159156,5.9309309309309306,5.9459459459459456,5.9609609609609606,5.9759759759759756,5.9909909909909906,6.0060060060060056,6.0210210210210207,6.0360360360360357,6.0510510510510507,6.0660660660660657,6.0810810810810807,6.0960960960960957,6.1111111111111107,6.1261261261261257,6.1411411411411407,6.1561561561561557,6.1711711711711708,6.1861861861861858,6.2012012012012008,6.2162162162162158,6.2312312312312308,6.2462462462462458,6.2612612612612608,6.2762762762762758,6.2912912912912908,6.3063063063063058,6.3213213213213209,6.3363363363363359,6.3513513513513509,6.3663663663663659,6.3813813813813809,6.3963963963963959,6.4114114114114109,6.4264264264264259,6.4414414414414409,6.4564564564564559,6.4714714714714709,6.486486486486486,6.501501501501501,6.516516516516516,6.531531531531531,6.546546546546546,6.561561561561561,6.576576576576576,6.591591591591591,6.606606606606606,6.621621621621621,6.6366366366366361,6.6516516516516511,6.6666666666666661,6.6816816816816811,6.6966966966966961,6.7117117117117111,6.7267267267267261,6.7417417417417411,6.7567567567567561,6.7717717717717711,6.7867867867867862,6.8018018018018012,6.8168168168168162,6.8318318318318312,6.8468468468468462,6.8618618618618612,6.8768768768768762,6.8918918918918912,6.9069069069069062,6.9219219219219212,6.9369369369369362,6.9519519519519513,6.9669669669669663,6.9819819819819813,6.9969969969969963,7.0120120120120113,7.0270270270270263,7.0420420420420413,7.0570570570570563,7.0720720720720713,7.0870870870870863,7.1021021021021014,7.1171171171171164,7.1321321321321314,7.1471471471471464,7.1621621621621614,7.1771771771771764,7.1921921921921914,7.2072072072072064,7.2222222222222214,7.2372372372372364,7.2522522522522515,7.2672672672672665,7.2822822822822815,7.2972972972972965,7.3123123123123115,7.3273273273273265,7.3423423423423415,7.3573573573573565,7.3723723723723715,7.3873873873873865,7.4024024024024015,7.4174174174174166,7.4324324324324316,7.4474474474474466,7.4624624624624616,7.4774774774774766,7.4924924924924916,7.5075075075075066,7.5225225225225216,7.5375375375375366,7.5525525525525516,7.5675675675675667,7.5825825825825817,7.5975975975975967,7.6126126126126117,7.6276276276276267,7.6426426426426417,7.6576576576576567,7.6726726726726717,7.6876876876876867,7.7027027027027017,7.7177177177177168,7.7327327327327318,7.7477477477477468,7.7627627627627618,7.7777777777777768,7.7927927927927918,7.8078078078078068,7.8228228228228236,7.8378378378378386,7.8528528528528536,7.8678678678678686,7.8828828828828836,7.8978978978978986,7.9129129129129137,7.9279279279279287,7.9429429429429437,7.9579579579579587,7.9729729729729737,7.9879879879879887,8.0030030030030037,8.0180180180180187,8.0330330330330337,8.0480480480480487,8.0630630630630638,8.0780780780780788,8.0930930930930938,8.1081081081081088,8.1231231231231238,8.1381381381381388,8.1531531531531538,8.1681681681681688,8.1831831831831838,8.1981981981981988,8.2132132132132138,8.2282282282282289,8.2432432432432439,8.2582582582582589,8.2732732732732739,8.2882882882882889,8.3033033033033039,8.3183183183183189,8.3333333333333339,8.3483483483483489,8.3633633633633639,8.378378378378379,8.393393393393394,8.408408408408409,8.423423423423424,8.438438438438439,8.453453453453454,8.468468468468469,8.483483483483484,8.498498498498499,8.513513513513514,8.5285285285285291,8.5435435435435441,8.5585585585585591,8.5735735735735741,8.5885885885885891,8.6036036036036041,8.6186186186186191,8.6336336336336341,8.6486486486486491,8.6636636636636641,8.6786786786786791,8.6936936936936942,8.7087087087087092,8.7237237237237242,8.7387387387387392,8.7537537537537542,8.7687687687687692,8.7837837837837842,8.7987987987987992,8.8138138138138142,8.8288288288288292,8.8438438438438443,8.8588588588588593,8.8738738738738743,8.8888888888888893,8.9039039039039043,8.9189189189189193,8.9339339339339343,8.9489489489489493,8.9639639639639643,8.9789789789789793,8.9939939939939944,9.0090090090090094,9.0240240240240244,9.0390390390390394,9.0540540540540544,9.0690690690690694,9.0840840840840844,9.0990990990990994,9.1141141141141144,9.1291291291291294,9.1441441441441444,9.1591591591591595,9.1741741741741745,9.1891891891891895,9.2042042042042045,9.2192192192192195,9.2342342342342345,9.2492492492492495,9.2642642642642645,9.2792792792792795,9.2942942942942945,9.3093093093093096,9.3243243243243246,9.3393393393393396,9.3543543543543546,9.3693693693693696,9.3843843843843846,9.3993993993993996,9.4144144144144146,9.4294294294294296,9.4444444444444446,9.4594594594594597,9.4744744744744747,9.4894894894894897,9.5045045045045047,9.5195195195195197,9.5345345345345347,9.5495495495495497,9.5645645645645647,9.5795795795795797,9.5945945945945947,9.6096096096096097,9.6246246246246248,9.6396396396396398,9.6546546546546548,9.6696696696696698,9.6846846846846848,9.6996996996996998,9.7147147147147148,9.7297297297297298,9.7447447447447448,9.7597597597597598,9.7747747747747749,9.7897897897897899,9.8048048048048049,9.8198198198198199,9.8348348348348349,9.8498498498498499,9.8648648648648649,9.8798798798798799,9.8948948948948949,9.9099099099099099,9.924924924924925,9.93993993993994,9.954954954954955,9.96996996996997,9.984984984984985,10],"y":[0.0033861607389479736,0.0034253336120548348,0.0034648945598708836,0.0035048465693942026,0.0035451926399247607,0.0035859357829795321,0.0036270790222055456,0.0036686253932907346,0.0037105779438726802,0.0037529397334451109,0.0037957138332623194,0.0038389033262412131,0.0038825113068613488,0.0039265408810625225,0.0039709951661403235,0.0040158772906392238,0.0040611903942435997,0.0041069376276662546,0.0041531221525348619,0.0041997471412758714,0.0042468157769963259,0.0042943312533630824,0.0043422967744799557,0.0043907155547622447,0.0044395908188090746,0.004488925801273227,0.0045387237467286647,0.0045889879095355511,0.0046397215537029622,0.0046909279527490048,0.0047426103895587008,0.0047947721562391805,0.0048474165539726414,0.0049005468928666005,0.0049541664918018999,0.0050082786782779569,0.0050628867882557792,0.0051179941659981881,0.0051736041639077832,0.0052297201423621145,0.0052863454695465479,0.0053434835212843781,0.00540113768086453,0.005459311338866582,0.0055180078929832977,0.0055772307478404908,0.0056369833148143889,0.0056972690118462822,0.0057580912632547217,0.005819453499544886,0.0058813591572156061,0.0059438116785634574,0.0060068145114845258,0.0060703711092732404,0.0061344849304188591,0.0061991594383990004,0.0062643981014708413,0.0063302043924593392,0.0063965817885430999,0.0064635337710373091,0.0065310638251742147,0.0065991754398807816,0.0066678721075537749,0.0067371573238320945,0.0068070345873665165,0.0068775073995866352,0.0069485792644652855,0.0070202536882800768,0.0070925341793724606,0.0071654242479039475,0.0072389274056097463,0.0073130471655496413,0.0073877870418562613,0.0074631505494805938,0.0075391412039348951,0.0076157625210328426,0.0076930180166270932,0.0077709112063440722,0.0078494456053161965,0.0079286247279113688,0.0080084520874597626,0.008088931195978092,0.0081700655638910404,0.0082518586997502325,0.0083343141099503585,0.0084174352984428477,0.00850122576644677,0.0085856890121571924,0.0086708285304508623,0.008756647812589299,0.0088431503459193116,0.0089303396135708389,0.0090182190941522928,0.0091067922614432428,0.0091960625840846032,0.0092860335252661578,0.0093767085424116652,0.0094680910868613268,0.0095601846035517236,0.0096529925306933183,0.0097465182994453531,0.0098407653335883475,0.0099357370491939979,0.010031436854292784,0.010127868148538907,0.010225034322872984,0.010322938759182224,0.010421584829958152,0.010520975897952067,0.010621115315827998,0.010722006425813394,0.010823652559347384,0.010926057036726814,0.011029223166749844,0.011133154246357409,0.011237853560272288,0.011343324380635945,0.01144956996664322,0.011556593564174676,0.011664398405426898,0.011772987708540485,0.011882364677226039,0.011992532500387874,0.012103494351745788,0.012215253389454577,0.012327812755721687,0.012441175576422707,0.012555344960714818,0.012670324000648478,0.012786115770776842,0.012902723327763595,0.013020149709988537,0.013138397937151609,0.013257471009874844,0.01337737190930263,0.013498103596700131,0.013619669013049925,0.013742071078647028,0.013865312692692023,0.01398939673288274,0.014114326055004114,0.014240103492516573,0.014366731856142729,0.014494213933452654,0.014622552488447561,0.014751750261142001,0.014881809967144752,0.01501273429723806,0.015144525916955831,0.015277187466160136,0.015410721558616754,0.015545130781569171,0.015680417695311578,0.015816584832760511,0.015953634699025453,0.016091569770978281,0.016230392496821636,0.016370105295656311,0.016510710557047573,0.016652210640590595,0.016794607875474956,0.016937904560048282,0.01708210296137903,0.017227205314818538,0.0173732138235623,0.01752013065821055,0.017667957956328185,0.01781669782200412,0.017966352325410016,0.01811692350235853,0.01826841335386108,0.018420823845685184,0.018574156907911425,0.018728414434490057,0.01888359828279737,0.019039710273191731,0.019196752188569598,0.019354725773921139,0.019513632735886036,0.019673474742309034,0.019834253421795602,0.019995970363267643,0.020158627115519249,0.020322225186772718,0.020486766044234671,0.020652251113652514,0.020818681778871178,0.020986059381390233,0.021154385219921405,0.021323660549946628,0.021493886583276525,0.021665064487609575,0.021837195386091839,0.02201028035687741,0.022184320432689621,0.022359316600383039,0.02253526980050629,0.022712180926865857,0.022890050826090805,0.023068880297198568,0.023248670091161775,0.023429420910476253,0.023611133408730244,0.023793808190174823,0.023977445809295707,0.024162046770386386,0.024347611527122677,0.02453414048213886,0.024721633986605242,0.024910092339807455,0.025099515788727322,0.025289904527625567,0.025481258697626168,0.025673578386302746,0.025866863627266722,0.026061114399757526,0.026256330628234788,0.026452512181972729,0.026649658874656573,0.026847770463981294,0.027046846651252617,0.027246887080990333,0.027447891340534037,0.027649858959651413,0.027852789410148893,0.028056682105485092,0.028261536400386759,0.028467351590467534,0.028674126911849479,0.028881861540787424,0.029090554593296257,0.029300205124781164,0.029510812129670976,0.029722374541054492,0.029934891230320067,0.030148361006798449,0.030362782617408789,0.030578154746308133,0.03079447601454428,0.031011744979712094,0.031229960135613431,0.03144911991192062,0.031669222673843658,0.031890266721801112,0.032112250291094824,0.032335171551588507,0.032559028607390267,0.032783819496539079,0.033009542190695344,0.033236194594835587,0.033463774546951229,0.033692279817751851,0.033921708110372387,0.034152057060085055,0.034383324234015473,0.034615507130863379,0.0348486031806279,0.035082609744337398,0.03531752411378402,0.035553343511262936,0.035790065089316606,0.036027685930483479,0.036266203047052047,0.036505613380819653,0.036745913802856398,0.036987101113274155,0.037229172041000742,0.037472123243559301,0.037715951306853041,0.037960652744955171,0.038206223999904428,0.038452661441505907,0.038699961367137478,0.038948120001561747,0.039197133496743676,0.03944699793167393,0.039697709312197821,0.039949263570850269,0.040201656566696435,0.04045488408517834,0.040708941837967451,0.040963825462823372,0.041219530523458392,0.041476052509408348,0.041733386835909665,0.041991528843782502,0.042250473799320343,0.042510216894185777,0.042770753245312786,0.043032077894815397,0.043294185809902894,0.043557071882801467,0.043820730930682526,0.044085157695597642,0.044350346844420178,0.044616292968793575,0.044882990585086539,0.045150434134354954,0.045418617982310665,0.045687536419297278,0.045957183660272745,0.046227553844799131,0.046498641037039275,0.046770439225760629,0.047042942324346179,0.047316144170812556,0.047590038527835304,0.047864619082781487,0.048139879447749438,0.048415813159616045,0.048692413680091098,0.048969674395779331,0.049247588618249689,0.049526149584112118,0.049805350455101934,0.050085184318171543,0.05036564418558994,0.050646722995049631,0.050928413609781294,0.05121070881867594,0.051493601336414993,0.051777083803607869,0.052061148786937406,0.052345788779313,0.05263099620003165,0.052916763394946595,0.053203082636644007,0.05348994612462752,0.053777345985510421,0.054065274273216092,0.054353722969186044,0.054642683982596155,0.054932149150580707,0.055222110238464461,0.055512558940002732,0.055803486877629455,0.056094885602713265,0.056386746595821713,0.056679061266993333,0.056971820956017966,0.057265016932725087,0.057558640397280141,0.057852682480489095,0.058147134244110998,0.058441986681178656,0.058737230716327429,0.059032857206132196,0.059328856939452279,0.059625220637784644,0.059921938955625129,0.06021900248083787,0.060516401735032692,0.060814127173950808,0.06111216918785848,0.061410518101948829,0.061709164176751881,0.062008097608552352,0.062307308529815961,0.062606787009623494,0.062906523054113123,0.063206506606930599,0.063506727549687753,0.063807175702428748,0.06410784082410452,0.064408712613055169,0.064709780707500414,0.065011034686037833,0.06531246406814914,0.065614058314714591,0.065915806828534887,0.066217698954861376,0.066519723981933815,0.066821871141526129,0.067124129609499886,0.06742648850636572,0.067728936897852268,0.068031463795482999,0.068334058157160718,0.068636708887759676,0.068939404839725424,0.069242134813682105,0.069544887559047433,0.069847651774655184,0.070150416109385091,0.070453169162800366,0.070755899485792348,0.071058595581232897,0.071361245904633733,0.071663838864813353,0.071966362824571042,0.072268806101368099,0.072571156968016318,0.072873403653373386,0.073175534343045426,0.073477537180096697,0.073779400265765877,0.074081111660189741,0.074382659383133154,0.074684031414726293,0.074985215696208404,0.075286200130678202,0.075586972583851025,0.075887520884822535,0.076187832826838719,0.076487896168072694,0.076787698632407572,0.077087227910225764,0.07738647165920462,0.077685417505118051,0.077984053042644622,0.078282365836181159,0.078580343420662987,0.078877973302389562,0.07917524295985616,0.079472139844591436,0.079768651382000455,0.080064764972213584,0.080360467990940737,0.080655747790331231,0.080950591699838967,0.081244987027093041,0.081538921058773473,0.081832381061492085,0.082125354282678711,0.082417827951472011,0.082709789279615614,0.083001225462358788,0.083292123679362021,0.083582471095607222,0.083872254862312506,0.084161462117851471,0.084450079988676929,0.08473809559024878,0.085025496027966344,0.08531226839810474,0.085598399788755178,0.085883877280769391,0.086168687948707814,0.086452818861791597,0.086736257084858187,0.087018989679320591,0.08730100370413002,0.08758228621674205,0.087862824274085816,0.088142604933536706,0.088421615253891875,0.088699842296348835,0.088977273125487061,0.089253894810252019,0.089529694424942352,0.089804659050199145,0.090078775773998171,0.090352031692643914,0.09062441391176651,0.0908959095473202,0.091166505726584371,0.091436189589166161,0.091704948288005114,0.091972768990379483,0.092239638878914149,0.09250554515259006,0.092770475027755012,0.093034415739135998,0.093297354540852181,0.093559278707429569,0.093820175534816197,0.094080032341398293,0.094338836469017306,0.094596575283987294,0.094853236178113101,0.095108806569708659,0.095363273904615811,0.095616625657223064,0.095868849331484665,0.096119932461939298,0.096369862614728921,0.09661862738861704,0.096866214416006707,0.097112611363958004,0.09735780593520485,0.097601785869170982,0.097844538942985226,0.098086052972495563,0.098326315813282286,0.098565315361669806,0.098803039555737118,0.099039476376326915,0.099274613848053,0.099508440040305984,0.099740943068257384,0.099972111093861504,0.10020193232685543,0.10043039502575689,0.10065748749885968,0.10088319810522686,0.10110751525568133,0.10133042741379371,0.10155192309686761,0.101771990876922,0.10199061938167048,0.10220779729549749,0.10242351336043143,0.10263775637711427,0.10285051520576773,0.103061778767156,0.10327153604354468,0.10347977607965586,0.10368648798361942,0.10389166092792025,0.10409528415034125,0.10429734695490207,0.1044978387127936,0.10469674886330786,0.10489406691476326,0.10508978244542518,0.10528388510442177,0.10547636461265474,0.10566721076370503,0.10585641342473351,0.10604396253737619,0.10622984811863412,0.10641406026175781,0.10659658913712614,0.10677742499311918,0.10695655815698567,0.10713397903570426,0.10730967811683871,0.10748364596938711,0.10765587324462468,0.10782635067694027,0.10799506908466648,0.10816201937090297,0.10832719252433347,0.10849057962003561,0.10865217182028412,0.10881196037534709,0.10896993662427489,0.10912609199568223,0.10928041800852267,0.10943290627285601,0.10958354849060792,0.10973233645632224,0.10987926205790557,0.11002431727736399,0.11016749419153203,0.11030878497279369,0.11044818188979534,0.11058567730815062,0.11072126369113704,0.11085493360038425,0.110986679696554,0.11111649474001158,0.11124437159148862,0.11137030321273743,0.11149428266717634,0.11161630312052649,0.11173635784143947,0.11185444020211617,0.1119705436789165,0.11208466185295995,0.11219678841071699,0.11230691714459108,0.11241504195349135,0.112521156843396,0.11262525592790588,0.11272733342878875,0.11282738367651371,0.11292540111077609,0.11302138028101226,0.11311531584690492,0.11320720257887815,0.11329703535858271,0.11338480917937116,0.11347051914676283,0.1135541604788988,0.11363572850698643,0.1137152186757337,0.11379262654377319,0.11386794778407568,0.11394117818435323,0.11401231364745185,0.1140813501917334,0.1141482839514472,0.11421311117709068,0.11427582823575942,0.11433643161148657,0.11439491790557123,0.11445128383689621,0.11450552624223478,0.11455764207654649,0.11460762841326218,0.11465548244455773,0.11470120148161704,0.11474478295488379,0.1147862244143021,0.11482552352954616,0.11486267809023855,0.1148976860061575,0.11493054530743287,0.11496125414473081,0.11498981078942734,0.1150162136337704,0.1150404611910309,0.11506255209564202,0.11508248510332751,0.11510025909121856,0.11511587305795903,0.11512932612379966,0.11514061753068056,0.11514974664230251,0.11515671294418663,0.11516151604372271,0.11516415567020617,0.11516463167486338,0.1151629440308657,0.11515909283333202,0.11515307829931976,0.1151449007678045,0.11513456069964817,0.11512205867755576,0.11510739540602057,0.11509057171125801,0.1150715885411281,0.11505044696504642,0.11502714817388363,0.11500169347985383,0.11497408431639121,0.11494432223801572,0.11491240892018691,0.11487834615914702,0.11484213587175235,0.11480378009529339,0.11476328098730396,0.11472064082535882,0.11467586200686027,0.11462894704881339,0.11457989858759035,0.11452871937868347,0.11447541229644721,0.11441998033382909,0.11436242660208967,0.11430275433051149,0.11424096686609711,0.11417706767325622,0.11411106033348183,0.11404294854501586,0.11397273612250361,0.11390042699663787,0.11382602521379208,0.11374953493564303,0.1136709604387828,0.11359030611432036,0.11350757646747248,0.11342277611714442,0.11333590979550016,0.11324698234752222,0.11315599873056133,0.1130629640138759,0.11296788337816129,0.11287076211506897,0.1127716056267159,0.11267041942518349,0.11256720913200725,0.11246198047765603,0.11235473930100207,0.11224549154878082,0.11213424327504161,0.11202100064058847,0.11190576991241155,0.11178855746310931,0.11166936977030105,0.11154821341603048,0.11142509508615997,0.11130002156975584,0.11117299975846442,0.1110440366458794,0.11091313932690008,0.11078031499708117,0.11064557095197355,0.11050891458645673,0.11037035339406258,0.11022989496629063,0.11008754699191534,0.10994331725628456,0.10979721364061039,0.10964924412125156,0.109499416768988,0.10934773974828756,0.10919422131656474,0.10903886982343196,0.10888169370994299,0.10872270150782903,0.1085619018387273,0.10839930341340229,0.10823491503095987,0.10806874557805424,0.10790080402808773,0.10773109944040392,0.10755964095947375,0.10738643781407502,0.10721149931646518,0.10703483486154765,0.10685645392603181,0.1066763660675866,0.10649458092398788,0.10631110821225982,0.10612595772781028,0.1059391393435602,0.10575066300906734,0.10556053874964443,0.10536877666547154,0.10517538693070315,0.10498037979256999,0.10478376557047551,0.10458555465508719,0.1043857575074231,0.1041843846579333,0.10398144670557675,0.10377695431689328,0.10357091822507121,0.10336334922901048,0.10315425819238147,0.10294365604267958,0.1027315537702758,0.10251796242746328,0.10230289312749999,0.10208635704364766,0.10186836540820723,0.10164892951155056,0.10142806070114899,0.10120577038059837,0.10098207000864121,0.10075697109818553,0.100530485215321,0.10030262397833219,0.10007339905670895,0.099842822170154638,0.099610905087591461,0.099377659626163753,0.099143097650238932,0.098907231070406318,0.098670071842474172,0.098431631966464497,0.0981919234856065,0.097950958485328171,0.097708749092246389,0.097465307473155682,0.097220645834015657,0.096974776418937411,0.096727711509168576,0.09647946342207786,0.096230044510138418,0.095979467159910695,0.095727743791024736,0.095474886855161867,0.095220908835036228,0.094965822243375922,0.094709639621904096,0.094452373540320059,0.094194036595280445,0.093934641409380709,0.093674200630136845,0.093412726928967668,0.093150233000177524,0.092886731559939914,0.092622235345281648,0.092356757113068122,0.092090309638989468,0.091822905716547873,0.091554558156046295,0.091285279783578213,0.091015083440019129,0.090743981980019511,0.090471988270999434,0.090199115192144963,0.089925375633406551,0.08965078249449937,0.089375348683905606,0.089099087117879297,0.088822010719453157,0.088544132417448088,0.088265465145485,0.087986021840999393,0.087705815444258664,0.087424858897382274,0.08714316514336469,0.086860747125101639,0.08657761778441915,0.086293790061106226,0.086009276891950578,0.085724091209777822,0.085438245942494301,0.085151754012133513,0.084864628333906178,0.08457688181525419,0.084288527354908493,0.083999577841950945,0.083710046154880161,0.083419945160681755,0.083129287713902753,0.082838086655730253,0.082546354813074763,0.082254104997657895,0.081961350005104849,0.081668102614041393,0.081374375585195904,0.081080181660506082,0.080785533562230755,0.080490443992066604,0.080194925630270267,0.079898991134785255,0.079602653140374596,0.079305924257758481,0.079008817072757628,0.078711344145442022,0.078413518009285116,0.078115351170324143,0.077816856106325688,0.077518045265957278,0.077218931067965013,0.076919525900356764,0.076619842119591886,0.076319892049776544,0.07601968798186555,0.075719242172870238,0.075418566845072726,0.075117674185246508,0.074816576343883334,0.074515285434426884,0.074213813532512538,0.073912172675214188,0.073610374860297437,0.07330843204547953,0.073006356147696155,0.072704159042374969,0.072401852562716126,0.072099448498979563,0.071796958597779431,0.071494394561385441,0.071191768047031354,0.070889090666230628,0.070586373984099088,0.070283629518685081,0.069980868740306582,0.069678103070895905,0.069375343883351537,0.069072602500897542,0.068769890196450273,0.068467218191992613,0.068164597657955711,0.067862039712608291,0.067559555421453532,0.06725715579663348,0.066954851796341294,0.066652654324240987,0.066350574228895079,0.066048622303199661,0.065746809283827687,0.065445145850679606,0.065143642626342202,0.064842310175555015,0.064541159004684795,0.064240199561207786,0.063939442233199875,0.063638897348834836,0.063338575175890408,0.063038485921262336,0.062738639730486517,0.062439046687269059,0.062139716813024409,0.061840660066421499,0.061541886342937946,0.061243405474422342,0.060945227228664613,0.060647361308974385,0.06034981735376755,0.060052604936160825,0.059755733563574609,0.059459212677343609,0.05916305165233595,0.058867259796580147,0.058571846350900264,0.058276820488559297,0.057982191314910489,0.057687967867056864,0.057394159113518937,0.057100773953910361,0.056807821218621851,0.056515309668513085,0.056223247994612813,0.055931644817826899,0.05564050868865459,0.055349848086912762,0.055059671421468198,0.054769987029978061,0.054480803178638168,0.054192128061939501,0.053903969802432568,0.053616336450499832,0.053329235984136046,0.053042676308736623,0.052756665256893848,0.052471210588201068,0.052186319989064783,0.051902001072524469,0.05161826137808051,0.051335108371529686,0.051052549444808665,0.050770591915845133,0.05048924302841673,0.050208509952017762,0.04992839978173351,0.049648919538122269,0.049370076167105037,0.049091876539862703,0.048814327452740995,0.048537435627162839,0.04826120770954824,0.047985650271241694,0.047710769808446969,0.047436572742169433,0.04716306541816561,0.046890254106900127,0.046618145003509949,0.046346744227775953,0.046076057824101624,0.045806091761498982,0.045536851933581632,0.045268344158564976,0.045000574179273355,0.04473354766315437,0.044467270202300083,0.044201747313475169,0.043936984438151909,0.043672986942552151,0.043409760117695942,0.043147309179456979,0.042885639268624723,0.042624755450973204,0.042364662717336417,0.042105365983690302,0.041846870091241196,0.041589179806520729,0.041332299821487228,0.04107623475363345,0.040820989146100502,0.040566567467798145,0.040312974113531339,0.040060213404132745,0.039808289586601577,0.039557206834248335,0.039306969246845486,0.039057580850784299,0.038809045599237341,0.038561367372326925,0.038314549977299259,0.038068597148704343,0.037823512548581573,0.037579299766650781,0.037335962320509071,0.037093503655832874,0.03685192714658559,0.036611236095230579,0.036371433732949467,0.036132523219865612,0.035894507645272876,0.035657390027869475,0.035421173315996854,0.035185860387883724,0.034951454051894905,0.034717957046784993,0.034485372041957188,0.034253701637726494,0.034022948365587856,0.033793114688488897,0.033564203001107198,0.033336215630132185,0.033109154834551319,0.032883022805940902,0.032657821668760946,0.03243355348065461,0.032210220232751614,0.031987823849975873,0.031766366191357275,0.03154584905034738,0.031326274155139125,0.031107643168990427,0.030889957690551601,0.030673219254196568,0.030457429330357645,0.030242589325864228,0.030028700584284779,0.029815764386272467,0.029603781949914254,0.029392754431083315,0.029182682923794816,0.028973568460564945,0.028765412012773141,0.02855821449102736,0.028351976745532633],"type":"scatter","mode":"lines","name":"Male","line":{"color":"#005A43"},"visible":true,"marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[-5,-4.984984984984985,-4.96996996996997,-4.954954954954955,-4.93993993993994,-4.924924924924925,-4.9099099099099099,-4.8948948948948949,-4.8798798798798799,-4.8648648648648649,-4.8498498498498499,-4.8348348348348349,-4.8198198198198199,-4.8048048048048049,-4.7897897897897899,-4.7747747747747749,-4.7597597597597598,-4.7447447447447448,-4.7297297297297298,-4.7147147147147148,-4.6996996996996998,-4.6846846846846848,-4.6696696696696698,-4.6546546546546548,-4.6396396396396398,-4.6246246246246248,-4.6096096096096097,-4.5945945945945947,-4.5795795795795797,-4.5645645645645647,-4.5495495495495497,-4.5345345345345347,-4.5195195195195197,-4.5045045045045047,-4.4894894894894897,-4.4744744744744747,-4.4594594594594597,-4.4444444444444446,-4.4294294294294296,-4.4144144144144146,-4.3993993993993996,-4.3843843843843846,-4.3693693693693696,-4.3543543543543546,-4.3393393393393396,-4.3243243243243246,-4.3093093093093096,-4.2942942942942945,-4.2792792792792795,-4.2642642642642645,-4.2492492492492495,-4.2342342342342345,-4.2192192192192195,-4.2042042042042045,-4.1891891891891895,-4.1741741741741745,-4.1591591591591595,-4.1441441441441444,-4.1291291291291294,-4.1141141141141144,-4.0990990990990994,-4.0840840840840844,-4.0690690690690694,-4.0540540540540544,-4.0390390390390394,-4.0240240240240244,-4.0090090090090094,-3.9939939939939939,-3.9789789789789789,-3.9639639639639639,-3.9489489489489489,-3.9339339339339339,-3.9189189189189189,-3.9039039039039038,-3.8888888888888888,-3.8738738738738738,-3.8588588588588588,-3.8438438438438438,-3.8288288288288288,-3.8138138138138138,-3.7987987987987988,-3.7837837837837838,-3.7687687687687688,-3.7537537537537538,-3.7387387387387387,-3.7237237237237237,-3.7087087087087087,-3.6936936936936937,-3.6786786786786787,-3.6636636636636637,-3.6486486486486487,-3.6336336336336337,-3.6186186186186187,-3.6036036036036037,-3.5885885885885886,-3.5735735735735736,-3.5585585585585586,-3.5435435435435436,-3.5285285285285286,-3.5135135135135136,-3.4984984984984986,-3.4834834834834836,-3.4684684684684686,-3.4534534534534536,-3.4384384384384385,-3.4234234234234235,-3.4084084084084085,-3.3933933933933931,-3.3783783783783781,-3.3633633633633631,-3.348348348348348,-3.333333333333333,-3.318318318318318,-3.303303303303303,-3.288288288288288,-3.273273273273273,-3.258258258258258,-3.243243243243243,-3.228228228228228,-3.213213213213213,-3.198198198198198,-3.1831831831831829,-3.1681681681681679,-3.1531531531531529,-3.1381381381381379,-3.1231231231231229,-3.1081081081081079,-3.0930930930930929,-3.0780780780780779,-3.0630630630630629,-3.0480480480480479,-3.0330330330330328,-3.0180180180180178,-3.0030030030030028,-2.9879879879879878,-2.9729729729729728,-2.9579579579579578,-2.9429429429429428,-2.9279279279279278,-2.9129129129129128,-2.8978978978978978,-2.8828828828828827,-2.8678678678678677,-2.8528528528528527,-2.8378378378378377,-2.8228228228228227,-2.8078078078078077,-2.7927927927927927,-2.7777777777777777,-2.7627627627627627,-2.7477477477477477,-2.7327327327327327,-2.7177177177177176,-2.7027027027027026,-2.6876876876876876,-2.6726726726726726,-2.6576576576576576,-2.6426426426426426,-2.6276276276276276,-2.6126126126126126,-2.5975975975975976,-2.5825825825825826,-2.5675675675675675,-2.5525525525525525,-2.5375375375375375,-2.5225225225225225,-2.5075075075075075,-2.4924924924924925,-2.4774774774774775,-2.4624624624624625,-2.4474474474474475,-2.4324324324324325,-2.4174174174174174,-2.4024024024024024,-2.3873873873873874,-2.3723723723723724,-2.3573573573573574,-2.3423423423423424,-2.3273273273273274,-2.3123123123123124,-2.2972972972972974,-2.2822822822822824,-2.2672672672672673,-2.2522522522522523,-2.2372372372372373,-2.2222222222222223,-2.2072072072072073,-2.1921921921921923,-2.1771771771771773,-2.1621621621621623,-2.1471471471471473,-2.1321321321321323,-2.1171171171171173,-2.1021021021021022,-2.0870870870870872,-2.0720720720720722,-2.0570570570570572,-2.0420420420420422,-2.0270270270270272,-2.0120120120120122,-1.9969969969969972,-1.9819819819819822,-1.9669669669669672,-1.9519519519519521,-1.9369369369369371,-1.9219219219219221,-1.9069069069069071,-1.8918918918918921,-1.8768768768768771,-1.8618618618618621,-1.8468468468468471,-1.8318318318318321,-1.8168168168168171,-1.801801801801802,-1.7867867867867866,-1.7717717717717716,-1.7567567567567566,-1.7417417417417416,-1.7267267267267266,-1.7117117117117115,-1.6966966966966965,-1.6816816816816815,-1.6666666666666665,-1.6516516516516515,-1.6366366366366365,-1.6216216216216215,-1.6066066066066065,-1.5915915915915915,-1.5765765765765765,-1.5615615615615615,-1.5465465465465464,-1.5315315315315314,-1.5165165165165164,-1.5015015015015014,-1.4864864864864864,-1.4714714714714714,-1.4564564564564564,-1.4414414414414414,-1.4264264264264264,-1.4114114114114114,-1.3963963963963963,-1.3813813813813813,-1.3663663663663663,-1.3513513513513513,-1.3363363363363363,-1.3213213213213213,-1.3063063063063063,-1.2912912912912913,-1.2762762762762763,-1.2612612612612613,-1.2462462462462462,-1.2312312312312312,-1.2162162162162162,-1.2012012012012012,-1.1861861861861862,-1.1711711711711712,-1.1561561561561562,-1.1411411411411412,-1.1261261261261262,-1.1111111111111112,-1.0960960960960962,-1.0810810810810811,-1.0660660660660661,-1.0510510510510511,-1.0360360360360361,-1.0210210210210211,-1.0060060060060061,-0.99099099099099064,-0.97597597597597563,-0.96096096096096062,-0.94594594594594561,-0.9309309309309306,-0.91591591591591559,-0.90090090090090058,-0.88588588588588557,-0.87087087087087056,-0.85585585585585555,-0.84084084084084054,-0.82582582582582553,-0.81081081081081052,-0.79579579579579551,-0.7807807807807805,-0.76576576576576549,-0.75075075075075048,-0.73573573573573547,-0.72072072072072046,-0.70570570570570545,-0.69069069069069045,-0.67567567567567544,-0.66066066066066043,-0.64564564564564542,-0.63063063063063041,-0.6156156156156154,-0.60060060060060039,-0.58558558558558538,-0.57057057057057037,-0.55555555555555536,-0.54054054054054035,-0.52552552552552534,-0.51051051051051033,-0.49549549549549532,-0.48048048048048031,-0.4654654654654653,-0.45045045045045029,-0.43543543543543528,-0.42042042042042027,-0.40540540540540526,-0.39039039039039025,-0.37537537537537524,-0.36036036036036023,-0.34534534534534522,-0.33033033033033021,-0.3153153153153152,-0.30030030030030019,-0.28528528528528518,-0.27027027027027017,-0.25525525525525516,-0.24024024024024015,-0.22522522522522515,-0.21021021021021014,-0.19519519519519513,-0.18018018018018012,-0.16516516516516511,-0.1501501501501501,-0.13513513513513509,-0.12012012012012008,-0.10510510510510507,-0.090090090090090058,-0.075075075075075048,-0.060060060060060039,-0.045045045045045029,-0.030030030030030019,-0.01501501501501501,0,0.01501501501501501,0.030030030030030019,0.045045045045045029,0.060060060060060039,0.075075075075075048,0.090090090090090058,0.10510510510510507,0.12012012012012008,0.13513513513513509,0.1501501501501501,0.16516516516516511,0.18018018018018012,0.19519519519519513,0.21021021021021014,0.22522522522522515,0.24024024024024015,0.25525525525525516,0.27027027027027017,0.28528528528528518,0.30030030030030019,0.3153153153153152,0.33033033033033021,0.34534534534534522,0.36036036036036023,0.37537537537537524,0.39039039039039025,0.40540540540540526,0.42042042042042027,0.43543543543543528,0.45045045045045029,0.4654654654654653,0.48048048048048031,0.49549549549549532,0.51051051051051033,0.52552552552552534,0.54054054054054035,0.55555555555555536,0.57057057057057037,0.58558558558558538,0.60060060060060039,0.6156156156156154,0.63063063063063041,0.64564564564564542,0.66066066066066043,0.67567567567567544,0.69069069069069045,0.70570570570570545,0.72072072072072046,0.73573573573573547,0.75075075075075048,0.76576576576576549,0.7807807807807805,0.79579579579579551,0.81081081081081052,0.82582582582582553,0.84084084084084054,0.85585585585585555,0.87087087087087056,0.88588588588588557,0.90090090090090058,0.91591591591591559,0.9309309309309306,0.94594594594594561,0.96096096096096062,0.97597597597597563,0.99099099099099064,1.0060060060060056,1.0210210210210207,1.0360360360360357,1.0510510510510507,1.0660660660660657,1.0810810810810807,1.0960960960960957,1.1111111111111107,1.1261261261261257,1.1411411411411407,1.1561561561561557,1.1711711711711708,1.1861861861861858,1.2012012012012008,1.2162162162162158,1.2312312312312308,1.2462462462462458,1.2612612612612608,1.2762762762762758,1.2912912912912908,1.3063063063063058,1.3213213213213209,1.3363363363363359,1.3513513513513509,1.3663663663663659,1.3813813813813809,1.3963963963963959,1.4114114114114118,1.4264264264264268,1.4414414414414418,1.4564564564564568,1.4714714714714718,1.4864864864864868,1.5015015015015019,1.5165165165165169,1.5315315315315319,1.5465465465465469,1.5615615615615619,1.5765765765765769,1.5915915915915919,1.6066066066066069,1.6216216216216219,1.6366366366366369,1.651651651651652,1.666666666666667,1.681681681681682,1.696696696696697,1.711711711711712,1.726726726726727,1.741741741741742,1.756756756756757,1.771771771771772,1.786786786786787,1.801801801801802,1.8168168168168171,1.8318318318318321,1.8468468468468471,1.8618618618618621,1.8768768768768771,1.8918918918918921,1.9069069069069071,1.9219219219219221,1.9369369369369371,1.9519519519519521,1.9669669669669672,1.9819819819819822,1.9969969969969972,2.0120120120120122,2.0270270270270272,2.0420420420420422,2.0570570570570572,2.0720720720720722,2.0870870870870872,2.1021021021021022,2.1171171171171173,2.1321321321321323,2.1471471471471473,2.1621621621621623,2.1771771771771773,2.1921921921921923,2.2072072072072073,2.2222222222222223,2.2372372372372373,2.2522522522522523,2.2672672672672673,2.2822822822822824,2.2972972972972974,2.3123123123123124,2.3273273273273274,2.3423423423423424,2.3573573573573574,2.3723723723723724,2.3873873873873874,2.4024024024024024,2.4174174174174174,2.4324324324324325,2.4474474474474475,2.4624624624624625,2.4774774774774775,2.4924924924924925,2.5075075075075075,2.5225225225225225,2.5375375375375375,2.5525525525525525,2.5675675675675675,2.5825825825825826,2.5975975975975976,2.6126126126126126,2.6276276276276276,2.6426426426426426,2.6576576576576576,2.6726726726726726,2.6876876876876876,2.7027027027027026,2.7177177177177176,2.7327327327327327,2.7477477477477477,2.7627627627627627,2.7777777777777777,2.7927927927927927,2.8078078078078077,2.8228228228228227,2.8378378378378377,2.8528528528528527,2.8678678678678677,2.8828828828828827,2.8978978978978978,2.9129129129129128,2.9279279279279278,2.9429429429429428,2.9579579579579578,2.9729729729729728,2.9879879879879878,3.0030030030030037,3.0180180180180187,3.0330330330330337,3.0480480480480487,3.0630630630630638,3.0780780780780788,3.0930930930930938,3.1081081081081088,3.1231231231231238,3.1381381381381388,3.1531531531531538,3.1681681681681688,3.1831831831831838,3.1981981981981988,3.2132132132132138,3.2282282282282289,3.2432432432432439,3.2582582582582589,3.2732732732732739,3.2882882882882889,3.3033033033033039,3.3183183183183189,3.3333333333333339,3.3483483483483489,3.3633633633633639,3.378378378378379,3.393393393393394,3.408408408408409,3.423423423423424,3.438438438438439,3.453453453453454,3.468468468468469,3.483483483483484,3.498498498498499,3.513513513513514,3.5285285285285291,3.5435435435435441,3.5585585585585591,3.5735735735735741,3.5885885885885891,3.6036036036036041,3.6186186186186191,3.6336336336336341,3.6486486486486491,3.6636636636636641,3.6786786786786791,3.6936936936936942,3.7087087087087092,3.7237237237237242,3.7387387387387392,3.7537537537537542,3.7687687687687692,3.7837837837837842,3.7987987987987992,3.8138138138138142,3.8288288288288292,3.8438438438438443,3.8588588588588593,3.8738738738738743,3.8888888888888893,3.9039039039039043,3.9189189189189193,3.9339339339339343,3.9489489489489493,3.9639639639639643,3.9789789789789793,3.9939939939939944,4.0090090090090094,4.0240240240240244,4.0390390390390394,4.0540540540540544,4.0690690690690694,4.0840840840840844,4.0990990990990994,4.1141141141141144,4.1291291291291294,4.1441441441441444,4.1591591591591595,4.1741741741741745,4.1891891891891895,4.2042042042042045,4.2192192192192195,4.2342342342342345,4.2492492492492495,4.2642642642642645,4.2792792792792795,4.2942942942942945,4.3093093093093096,4.3243243243243246,4.3393393393393396,4.3543543543543546,4.3693693693693696,4.3843843843843846,4.3993993993993996,4.4144144144144146,4.4294294294294296,4.4444444444444446,4.4594594594594597,4.4744744744744747,4.4894894894894897,4.5045045045045047,4.5195195195195197,4.5345345345345347,4.5495495495495497,4.5645645645645647,4.5795795795795797,4.5945945945945947,4.6096096096096097,4.6246246246246248,4.6396396396396398,4.6546546546546548,4.6696696696696698,4.6846846846846848,4.6996996996996998,4.7147147147147148,4.7297297297297298,4.7447447447447448,4.7597597597597598,4.7747747747747749,4.7897897897897899,4.8048048048048049,4.8198198198198199,4.8348348348348349,4.8498498498498499,4.8648648648648649,4.8798798798798799,4.8948948948948949,4.9099099099099099,4.924924924924925,4.93993993993994,4.954954954954955,4.96996996996997,4.984984984984985,5,5.015015015015015,5.03003003003003,5.045045045045045,5.06006006006006,5.075075075075075,5.0900900900900901,5.1051051051051051,5.1201201201201201,5.1351351351351351,5.1501501501501501,5.1651651651651651,5.1801801801801801,5.1951951951951951,5.2102102102102101,5.2252252252252251,5.2402402402402402,5.2552552552552552,5.2702702702702702,5.2852852852852852,5.3003003003003002,5.3153153153153152,5.3303303303303302,5.3453453453453452,5.3603603603603602,5.3753753753753752,5.3903903903903903,5.4054054054054053,5.4204204204204203,5.4354354354354353,5.4504504504504503,5.4654654654654653,5.4804804804804803,5.4954954954954953,5.5105105105105103,5.5255255255255253,5.5405405405405403,5.5555555555555554,5.5705705705705704,5.5855855855855854,5.6006006006006004,5.6156156156156154,5.6306306306306304,5.6456456456456454,5.6606606606606604,5.6756756756756754,5.6906906906906904,5.7057057057057055,5.7207207207207205,5.7357357357357355,5.7507507507507505,5.7657657657657655,5.7807807807807805,5.7957957957957955,5.8108108108108105,5.8258258258258255,5.8408408408408405,5.8558558558558556,5.8708708708708706,5.8858858858858856,5.9009009009009006,5.9159159159159156,5.9309309309309306,5.9459459459459456,5.9609609609609606,5.9759759759759756,5.9909909909909906,6.0060060060060056,6.0210210210210207,6.0360360360360357,6.0510510510510507,6.0660660660660657,6.0810810810810807,6.0960960960960957,6.1111111111111107,6.1261261261261257,6.1411411411411407,6.1561561561561557,6.1711711711711708,6.1861861861861858,6.2012012012012008,6.2162162162162158,6.2312312312312308,6.2462462462462458,6.2612612612612608,6.2762762762762758,6.2912912912912908,6.3063063063063058,6.3213213213213209,6.3363363363363359,6.3513513513513509,6.3663663663663659,6.3813813813813809,6.3963963963963959,6.4114114114114109,6.4264264264264259,6.4414414414414409,6.4564564564564559,6.4714714714714709,6.486486486486486,6.501501501501501,6.516516516516516,6.531531531531531,6.546546546546546,6.561561561561561,6.576576576576576,6.591591591591591,6.606606606606606,6.621621621621621,6.6366366366366361,6.6516516516516511,6.6666666666666661,6.6816816816816811,6.6966966966966961,6.7117117117117111,6.7267267267267261,6.7417417417417411,6.7567567567567561,6.7717717717717711,6.7867867867867862,6.8018018018018012,6.8168168168168162,6.8318318318318312,6.8468468468468462,6.8618618618618612,6.8768768768768762,6.8918918918918912,6.9069069069069062,6.9219219219219212,6.9369369369369362,6.9519519519519513,6.9669669669669663,6.9819819819819813,6.9969969969969963,7.0120120120120113,7.0270270270270263,7.0420420420420413,7.0570570570570563,7.0720720720720713,7.0870870870870863,7.1021021021021014,7.1171171171171164,7.1321321321321314,7.1471471471471464,7.1621621621621614,7.1771771771771764,7.1921921921921914,7.2072072072072064,7.2222222222222214,7.2372372372372364,7.2522522522522515,7.2672672672672665,7.2822822822822815,7.2972972972972965,7.3123123123123115,7.3273273273273265,7.3423423423423415,7.3573573573573565,7.3723723723723715,7.3873873873873865,7.4024024024024015,7.4174174174174166,7.4324324324324316,7.4474474474474466,7.4624624624624616,7.4774774774774766,7.4924924924924916,7.5075075075075066,7.5225225225225216,7.5375375375375366,7.5525525525525516,7.5675675675675667,7.5825825825825817,7.5975975975975967,7.6126126126126117,7.6276276276276267,7.6426426426426417,7.6576576576576567,7.6726726726726717,7.6876876876876867,7.7027027027027017,7.7177177177177168,7.7327327327327318,7.7477477477477468,7.7627627627627618,7.7777777777777768,7.7927927927927918,7.8078078078078068,7.8228228228228236,7.8378378378378386,7.8528528528528536,7.8678678678678686,7.8828828828828836,7.8978978978978986,7.9129129129129137,7.9279279279279287,7.9429429429429437,7.9579579579579587,7.9729729729729737,7.9879879879879887,8.0030030030030037,8.0180180180180187,8.0330330330330337,8.0480480480480487,8.0630630630630638,8.0780780780780788,8.0930930930930938,8.1081081081081088,8.1231231231231238,8.1381381381381388,8.1531531531531538,8.1681681681681688,8.1831831831831838,8.1981981981981988,8.2132132132132138,8.2282282282282289,8.2432432432432439,8.2582582582582589,8.2732732732732739,8.2882882882882889,8.3033033033033039,8.3183183183183189,8.3333333333333339,8.3483483483483489,8.3633633633633639,8.378378378378379,8.393393393393394,8.408408408408409,8.423423423423424,8.438438438438439,8.453453453453454,8.468468468468469,8.483483483483484,8.498498498498499,8.513513513513514,8.5285285285285291,8.5435435435435441,8.5585585585585591,8.5735735735735741,8.5885885885885891,8.6036036036036041,8.6186186186186191,8.6336336336336341,8.6486486486486491,8.6636636636636641,8.6786786786786791,8.6936936936936942,8.7087087087087092,8.7237237237237242,8.7387387387387392,8.7537537537537542,8.7687687687687692,8.7837837837837842,8.7987987987987992,8.8138138138138142,8.8288288288288292,8.8438438438438443,8.8588588588588593,8.8738738738738743,8.8888888888888893,8.9039039039039043,8.9189189189189193,8.9339339339339343,8.9489489489489493,8.9639639639639643,8.9789789789789793,8.9939939939939944,9.0090090090090094,9.0240240240240244,9.0390390390390394,9.0540540540540544,9.0690690690690694,9.0840840840840844,9.0990990990990994,9.1141141141141144,9.1291291291291294,9.1441441441441444,9.1591591591591595,9.1741741741741745,9.1891891891891895,9.2042042042042045,9.2192192192192195,9.2342342342342345,9.2492492492492495,9.2642642642642645,9.2792792792792795,9.2942942942942945,9.3093093093093096,9.3243243243243246,9.3393393393393396,9.3543543543543546,9.3693693693693696,9.3843843843843846,9.3993993993993996,9.4144144144144146,9.4294294294294296,9.4444444444444446,9.4594594594594597,9.4744744744744747,9.4894894894894897,9.5045045045045047,9.5195195195195197,9.5345345345345347,9.5495495495495497,9.5645645645645647,9.5795795795795797,9.5945945945945947,9.6096096096096097,9.6246246246246248,9.6396396396396398,9.6546546546546548,9.6696696696696698,9.6846846846846848,9.6996996996996998,9.7147147147147148,9.7297297297297298,9.7447447447447448,9.7597597597597598,9.7747747747747749,9.7897897897897899,9.8048048048048049,9.8198198198198199,9.8348348348348349,9.8498498498498499,9.8648648648648649,9.8798798798798799,9.8948948948948949,9.9099099099099099,9.924924924924925,9.93993993993994,9.954954954954955,9.96996996996997,9.984984984984985,10],"y":[0.0015088736131095961,0.0015282400663176759,0.001547826008586227,0.001567633512236597,0.0015876646635617682,0.0016079215628473106,0.0016284063243913918,0.0016491210765236114,0.0016700679616228464,0.0016912491361339064,0.0017126667705831555,0.0017343230495929208,0.0017562201718948213,0.0017783603503418728,0.0018007458119194677,0.0018233787977550984,0.0018462615631269228,0.0018693963774710431,0.0018927855243876112,0.0019164313016455685,0.0019403360211862363,0.0019645020091254703,0.0019889316057546329,0.0020136271655401277,0.0020385910571216878,0.0020638256633091997,0.002089333381078258,0.0021151166215642122,0.0021411778100549222,0.0021675193859819692,0.0021941438029105158,0.0022210535285276363,0.0022482510446292284,0.0022757388471053718,0.0023035194459242333,0.0023315953651143846,0.0023599691427456486,0.0023886433309082879,0.0024176204956907329,0.0024469032171555868,0.002476494089314153,0.0025063957200992001,0.0025366107313362176,0.0025671417587128718,0.0025979914517469276,0.0026291624737523277,0.0026606575018037169,0.002692479226699076,0.0027246303529207699,0.002757113598594704,0.002789931695447796,0.0028230873887635922,0.0028565834373361276,0.0028904226134219054,0.0029246077026900885,0.0029591415041707817,0.0029940268302015038,0.0030292665063716656,0.0030648633714652897,0.003100820277401634,0.003137140089174058,0.0031738256847867572,0.003210879955189695,0.003248305804211388,0.0032861061484898571,0.0033242839174013818,0.0033628420529874092,0.0034017835098792454,0.0034411112552207948,0.0034808282685892013,0.0035209375419133428,0.003561442079390297,0.0036023448973996094,0.0036436490244154962,0.0036853575009168139,0.0037274733792949481,0.0037699997237594565,0.0038129396102415322,0.0038562961262952897,0.0039000723709967707,0.0039442714548407736,0.0039888964996353717,0.0040339506383942304,0.0040794370152265743,0.0041253587852249389,0.0041717191143505411,0.0042185211793164049,0.0042657681674681076,0.0043134632766621793,0.0043616097151422031,0.0044102107014124658,0.0044592694641093118,0.0045087892418700258,0.0045587732831993853,0.0046092248463337265,0.0046601471991026544,0.0047115436187882562,0.0047634173919818799,0.0048157718144384966,0.0048686101909285098,0.0049219358350871762,0.0049757520692614472,0.0050300622243543893,0.0050848696396670161,0.0051401776627376747,0.0051959896491788476,0.0052523089625114219,0.0053091389739964561,0.0053664830624643202,0.0054243446141413422,0.0054827270224738116,0.0055416336879494802,0.0056010680179163835,0.0056610334263991618,0.0057215333339127048,0.0057825711672732094,0.0058441503594066557,0.0059062743491545885,0.0059689465810773626,0.0060321705052546522,0.0060959495770834251,0.006160287257073167,0.006225187010638563,0.0062906523078894378,0.0063566866234180727,0.0064232934360838895,0.0064904762287953961,0.0065582384882895564,0.0066265837049083887,0.0066955153723729953,0.0067650369875547987,0.0068351520502442174,0.0069058640629165811,0.0069771765304953628,0.0070490929601128068,0.007121616860867771,0.0071947517435809781,0.0072685011205474888,0.0073428685052866066,0.0074178574122889685,0.007493471356761097,0.0075697138543671209,0.0076465884209679681,0.0077240985723577736,0.007802247823997647,0.0078810396907468151,0.0079604776865909929,0.0080405653243682488,0.0081213061154920257,0.008202703569671687,0.0082847611946302597,0.008367482495819669,0.008450870976133229,0.0085349301356155479,0.0086196634711698372,0.0087050744762625139,0.0087911666406253215,0.0088779434499546925,0.0089654083856086902,0.009053564924301186,0.0091424165377936226,0.0092319666925841041,0.0093222188495939318,0.0094131764638516885,0.0095048429841746579,0.009597221852847844,0.0096903165053003459,0.009784130369779381,0.009878666867021664,0.0099739294099224513,0.010069921403202045,0.01016664624306983,0.010264107316885984,0.010362308002820618,0.010461251669510679,0.010560941675714308,0.010661381369962981,0.010762574090211125,0.010864523163483585,0.010967231905520625,0.011070703620420666,0.011174941600280826,0.011279949124835037,0.011385729461090104,0.011492285862959379,0.011599621570894333,0.011707739811513905,0.011816643797231716,0.011926336725881094,0.012036821780338075,0.012148102128142227,0.012260180921115403,0.012373061294978567,0.012486746368966406,0.012601239245440175,0.012716543009498329,0.012832660728585464,0.012949595452099089,0.01306735021099471,0.013185928017388986,0.013305331864160936,0.013425564724551567,0.013546629551761481,0.013668529278546965,0.013791266816814128,0.013914845057211604,0.014039266868721317,0.014164535098247912,0.014290652570206374,0.014417622086108145,0.014545446424145805,0.014674128338776092,0.014803670560301664,0.014934075794451196,0.015065346721958358,0.015197485998139146,0.015330496252468176,0.015464380088153477,0.01559914008171014,0.015734778782532734,0.015871298712466574,0.016008702365377842,0.016146992206722572,0.016286170673114626,0.016426240171892686,0.016567203080686176,0.016709061746980353,0.016851818487680418,0.016995475588674834,0.017140035304397821,0.01728549985739105,0.017431871437864694,0.017579152203257686,0.017727344277797458,0.017876449752058984,0.01802647068252336,0.018177409091135858,0.018329266964863467,0.01848204625525212,0.018635748877983478,0.018790376712431486,0.018945931601218532,0.019102415349771532,0.019259829725877718,0.019418176459240405,0.019577457241034615,0.019737673723462714,0.019898827519310051,0.020060920201500708,0.020223953302653312,0.020387928314637167,0.020552846688128401,0.020718709832166612,0.020885519113711691,0.021053275857201161,0.02122198134410783,0.02139163681249806,0.021562243456590482,0.021733802426315389,0.021906314826874787,0.022079781718303076,0.02225420411502857,0.022429582985435886,0.022605919251429081,0.022783213787995846,0.022961467422772653,0.023140680935610908,0.023320855058144321,0.023501990473357291,0.023684087815154665,0.023867147667932704,0.024051170566151366,0.024236156993908034,0.024422107384512712,0.024609022120064671,0.024796901531030754,0.024985745895825261,0.025175555440391559,0.025366330337785434,0.025558070707760276,0.02575077661635412,0.025944448075478653,0.026139085042510207,0.026334687419882808,0.026531255054683362,0.026728787738249046,0.026927285205766885,0.027126747135875661,0.027327173150270296,0.027528562813308496,0.027730915631619987,0.027934231053718336,0.028138508469615332,0.028343747210438079,0.028549946548048859,0.028757105694667745,0.028965223802498156,0.029174299963355282,0.029384333208297628,0.029595322507261452,0.029807266768698444,0.030020164839216618,0.030234015503224344,0.030448817482577818,0.030664569436231852,0.030881269959894111,0.03109891758568285,0.031317510781788335,0.031537047952137659,0.031757527436063533,0.031978947507976641,0.032201306377041945,0.032424602186858782,0.032648833015144998,0.032873996873425043,0.033100091706722179,0.033327115393254773,0.033555065744136948,0.03378394050308324,0.034013737346117866,0.034244453881288196,0.034476087648382767,0.034708636118653796,0.03494209669454424,0.035176466709419561,0.035411743427304153,0.035647924042622535,0.035885005679945403,0.036122985393740495,0.036361860168128486,0.036601626916643884,0.036842282482000922,0.037083823635864641,0.037326247078627188,0.037569549439189241,0.03781372727474696,0.038058777070583978,0.038304695239869166,0.038551478123459652,0.038799121989709424,0.039047623034283621,0.039296977379978379,0.039547181076546395,0.039798230100528326,0.040050120355089952,0.04030284766986527,0.040556407800805459,0.040810796430033845,0.041066009165706976,0.041322041541881745,0.041578889018388632,0.04183654698071123,0.042095010739871916,0.042354275532323946,0.042614336519849881,0.042875188789466286,0.043136827353335121,0.043399247148681437,0.043662443037717762,0.043926409807574993,0.044191142170240068,0.04445663476250019,0.0447228821458939,0.044989878806668979,0.045257619155747039,0.045526097528695172,0.045795308185704375,0.046065245311575131,0.046335903015709785,0.046607275332112175,0.046879356219394243,0.047152139560789876,0.047425619164175807,0.047699788762099897,0.047974642011816532,0.04825017249532939,0.048526373719441546,0.048803239115812941,0.049080762041025253,0.049358935776654192,0.049637753529349314,0.049917208430921317,0.050197293538436938,0.050478001834321273,0.050759326226467928,0.051041259548356581,0.051323794559178418,0.051606923943969096,0.051890640313749528,0.052174936205674337,0.052459804083188219,0.052745236336189986,0.053031225281204422,0.053317763161562108,0.053604842147586984,0.053892454336791927,0.054180591754082123,0.054469246351966476,0.054758410010776866,0.055048074538895479,0.055338231672990033,0.055628873078257084,0.055919990348673274,0.056211575007254655,0.056503618506324037,0.056796112227786404,0.057089047483412418,0.057382415515129889,0.057676207495323505,0.057970414527142473,0.058265027644816454,0.058560037813979345,0.058855435932001425,0.059151212828329497,0.05944735926483509,0.059743865936170946,0.060040723470135421,0.060337922428045178,0.060635453305115869,0.060933306530851016,0.061231472469439011,0.061529941420158031,0.061828703617789374,0.062127749233038584,0.062427068372964863,0.062726651081418394,0.063026487339485932,0.063326567065944195,0.06362688011772151,0.063927416290367384,0.064228165318530123,0.064529116876442333,0.064830260578414664,0.065131585979337117,0.065433082575188678,0.065734739803554709,0.0660365470441521,0.066338493619362587,0.066640568794773689,0.06694276177972748,0.067245061727877434,0.067547457737752614,0.067849938853329947,0.068152494064614072,0.068455112308224902,0.068757782467992801,0.06906049337556143,0.069363233810998182,0.06966599250341203,0.069968758131579156,0.070271519324575774,0.070574264662418562,0.070876982676712372,0.071179661851305462,0.071482290622951833,0.071784857381981024,0.072087350472974973,0.072389758195452181,0.072692068804558918,0.072994270511767545,0.073296351485581918,0.073598299852249707,0.073900103696481617,0.074201751062177621,0.074503229953159944,0.074804528333912712,0.075105634130328544,0.075406535230461591,0.075707219485287316,0.076007674709468717,0.076307888682129107,0.07660784914763126,0.07690754381636293,0.077206960365528723,0.077506086439948038,0.077804909652859383,0.078103417586730575,0.078401597794075184,0.07869943779827468,0.078996925094406784,0.079294047150079275,0.079590791406269901,0.079887145278171659,0.080183096156043923,0.080478631406068882,0.080773738371213544,0.081068404372097141,0.08136261670786378,0.081656362657060153,0.081949629478518707,0.082242404412245604,0.082534674680313697,0.082826427487760534,0.083117650023490891,0.0834083294611844,0.083698452960207392,0.083988007666529613,0.084276980713645269,0.084565359223498407,0.084853130307412622,0.085140281067024925,0.085426798595223785,0.085712669977091108,0.085997882290848121,0.086282422608805087,0.086566277998314789,0.086849435522729598,0.087131882242362096,0.087413605215449136,0.087694591499119193,0.087974828150363032,0.088254302227007503,0.088533000788692306,0.088810910897849815,0.089088019620687645,0.089364314028173922,0.089639781197025412,0.089914408210697905,0.090188182160379188,0.090461090145984302,0.090733119277153051,0.091004256674249551,0.091274489469363812,0.091543804807315318,0.091812189846658218,0.092079631760688424,0.092346117738451958,0.092611634985755212,0.092876170726176099,0.093139712202076813,0.093402246675617487,0.093663761429771022,0.093924243769338792,0.094183681021967017,0.094442060539164055,0.094699369697318111,0.094955595898715384,0.095210726572558774,0.095464749175986505,0.095717651195091069,0.095969420145938275,0.096220043575585876,0.096469509063102254,0.096717804220584611,0.096964916694176756,0.097210834165086329,0.097455544350601289,0.097699035005105642,0.097941293921094227,0.098182308930186479,0.098422067904138946,0.098660558755856706,0.098897769440403266,0.099133687956008923,0.099368302345077639,0.099601600695192,0.099833571140116525,0.10006420186079873,0.10029348108636833,0.1005213970951342,0.10074793821557881,0.10097309282735038,0.10119684936225253,0.101419196305231,0.10164012219535783,0.10185961562681248,0.10207766524985994,0.10229425977182564,0.10250938795806724,0.10272303863294287,0.10293520068077591,0.10314586304681628,0.10335501473819772,0.10356264482489157,0.10376874244065624,0.1039732967839829,0.10417629711903675,0.10437773277659407,0.10457759315497486,0.1047758677209709,0.1049725460107692,0.10516761763087067,0.10536107225900378,0.10555289964503362,0.10574308961186528,0.10593163205634254,0.10611851695014096,0.10630373434065557,0.1064872743518831,0.10666912718529842,0.10684928312072534,0.10702773251720157,0.10720446581383747,0.10737947353066904,0.10755274626950437,0.10772427471476416,0.10789404963431549,0.10806206188029936,0.10822830238995143,0.10839276218641615,0.10855543237955399,0.10871630416674193,0.10887536883366662,0.10903261775511075,0.10918804239573207,0.10934163431083495,0.10949338514713476,0.10964328664351466,0.10979133063177464,0.10993750903737315,0.11008181388016057,0.11022423727510516,0.11036477143301079,0.1105034086612266,0.11064014136434865,0.11077496204491315,0.11090786330408152,0.1110388378423168,0.11116787846005176,0.11129497805834832,0.11142012963954817,0.1115433263079149,0.11166456127026698,0.111783827836602,0.11190111942071176,0.11201642954078853,0.11212975182002166,0.11224107998718551,0.11235040787721762,0.1124577294317877,0.11256303869985707,0.11266632983822859,0.112767597112087,0.11286683489552941,0.11296403767208635,0.11305920003523268,0.11315231668888873,0.11324338244791163,0.1133323922385764,0.11341934109904708,0.1135042241798377,0.11358703674426303,0.11366777416887916,0.11374643194391362,0.11382300567368521,0.11389749107701347,0.1139698839876175,0.11404018035450436,0.11410837624234697,0.11417446783185119,0.11423845142011227,0.11430032342096075,0.11436008036529731,0.11441771890141705,0.11447323579532274,0.11452662793102732,0.11457789231084521,0.11462702605567307,0.11467402640525902,0.11471889071846131,0.11476161647349553,0.11480220126817089,0.11484064282011537,0.1148769389669896,0.1149110876666895,0.11494308699753798,0.11497293515846491,0.11500063046917627,0.11502617137031172,0.11504955642359097,0.11507078431194866,0.11508985383965817,0.11510676393244369,0.11512151363758126,0.11513410212398807,0.1151445286823006,0.11515279272494118,0.11515889378617331,0.1151628315221452,0.11516460571092225,0.11516421625250782,0.1151616631688526,0.1151569466038526,0.11515006682333558,0.11514102421503616,0.11512981928855931,0.11511645267533256,0.1151009251285466,0.11508323752308468,0.11506339085544033,0.11504138624362385,0.11501722492705738,0.1149909082664584,0.11496243774371223,0.11493181496173278,0.11489904164431222,0.11486411963595919,0.1148270509017259,0.11478783752702376,0.11474648171742784,0.11470298579847016,0.11465735221542168,0.11460958353306332,0.1145596824354455,0.11450765172563697,0.11445349432546233,0.11439721327522855,0.11433881173344052,0.11427829297650562,0.11421566039842745,0.11415091751048845,0.11408406794092196,0.11401511543457328,0.11394406385255006,0.11387091717186194,0.11379567948504957,0.11371835499980303,0.1136389480385695,0.1135574630381508,0.11347390454929,0.11338827723624799,0.11330058587636954,0.11321083535963906,0.11311903068822622,0.11302517697602125,0.11292927944816021,0.11283134344054023,0.11273137439932469,0.11262937788043846,0.11252535954905338,0.11241932517906389,0.11231128065255273,0.11220123195924751,0.11208918519596697,0.11197514656605839,0.11185912237882513,0.11174111904894492,0.11162114309587898,0.11149920114327165,0.11137529991834121,0.11124944625126128,0.11112164707453359,0.11099190942235156,0.11086024042995521,0.11072664733297725,0.11059113746678063,0.11045371826578744,0.11031439726279922,0.11017318208830909,0.11003008046980549,0.10988510023106754,0.10973824929145254,0.10958953566517517,0.10943896746057905,0.10928655287939995,0.10913230021602194,0.10897621785672509,0.10881831427892628,0.10865859805041209,0.10849707782856452,0.1083337623595793,0.10816866047767719,0.10800178110430807,0.10783313324734797,0.10766272600028946,0.10749056854142509,0.10731667013302409,0.10714104012050274,0.10696368793158802,0.10678462307547502,0.10660385514197808,0.10642139380067581,0.10623724880004992,0.10605142996661829,0.10586394720406207,0.10567481049234717,0.10548402988684003,0.10529161551741792,0.105097577587574,0.10490192637351671,0.10470467222326443,0.10450582555573483,0.1043053968598292,0.10410339669351226,0.10389983568288692,0.10369472452126452,0.10348807396823073,0.10327989484870681,0.10307019805200686,0.10285899453089066,0.1026462953006127,0.10243211143796715,0.10221645408032898,0.10199933442469161,0.1017807637267007,0.10156075329968466,0.10133931451368181,0.10111645879446418,0.10089219762255841,0.1006665425322634,0.10043950511066531,0.10021109699664973,0.09998132987991111,0.099750215499959785,0.099517765645126599,0.099283992151565068,0.099048906902251668,0.098812521825983768,0.098574848896375772,0.09833590013085354,0.098095687589646846,0.097854223374780488,0.09761151962906385,0.097367588535079055,0.097122442314168042,0.096876093225418305,0.096628553564647834,0.096379835663389174,0.096129951887872461,0.095878914638008142,0.095626736346369007,0.095373429477171728,0.095119006525258315,0.094863480015077134,0.09460686249966406,0.09434916655962361,0.094090404802110145,0.093830589859809507,0.093569734389920889,0.093307851073139367,0.093044952612638884,0.092781051733056119,0.092516161179475018,0.092250293716412454,0.091983462126804888,0.091715679210996076,0.091446957785726299,0.091177310683122834,0.090906750749691873,0.090635290845312286,0.090362943842230897,0.090089722624059634,0.08981564008477462,0.089540709127717416,0.089264942664598335,0.088988353614501886,0.088710954902894767,0.088432759460636307,0.088153780222991376,0.087874030128645989,0.087593522118725828,0.087312269135817369,0.08703028412299231,0.08674758002283478,0.086464169776471922,0.086180066322607773,0.085895282596560291,0.085609831529302016,0.085323726046504428,0.08503697906758563,0.084749603504762142,0.084461612262104344,0.084173018234595873,0.083883834307197119,0.083594073353912904,0.083303748236864178,0.083012871805364319,0.082721456894999573,0.082429516326714067,0.082137062905899491,0.081844109421489369,0.081550668645058014,0.081256753329924436,0.080962376210261103,0.080667550000207686,0.080372287392989919,0.08007660106004362,0.079780503650143914,0.079484007788539895,0.079187126076094433,0.078889871088429792,0.078592255375078524,0.078294291458640072,0.077995991833943151,0.077697368967213853,0.077398435295249493,0.077099203224598511,0.076799685130746323,0.076499893357307169,0.07619984021522215,0.075899537981963375,0.075598998900744424,0.075298235179737133,0.074997258991294724,0.074696082471181285,0.074394717717808076,0.074093176791475868,0.073791471713624504,0.073489614466088649,0.073187616990360499,0.072885491186859386,0.072583248914207893,0.072280901988515195,0.071978462182667222,0.07167594122562379,0.071373350801722787,0.071070702549991607,0.07076800806346549,0.070465278888513311,0.070162526524170335,0.069859762421478552,0.069556997982834073,0.06925424456134209,0.068951513460179165,0.068648815931962925,0.068346163178129318,0.068043566348317416,0.067741036539761643,0.06743858479669175,0.067136222109740407,0.066833959415358246,0.066531807595236983,0.066229777475739854,0.065927879827340094,0.065626125364067131,0.065324524742960494,0.065023088563531603,0.064721827367233573,0.064420751636938556,0.06411987179642345,0.063819198209863051,0.063518741181331509,0.063218510954311663,0.062918517711212221,0.062618771572893084,0.062319282598198682,0.062020060783499267,0.061721116062240296,0.061422458304499827,0.061124097316554153,0.060826042840451129,0.060528304553592108,0.060230892068321489,0.059933814931524686,0.059637082624234068,0.059340704561242991,0.059044690090727998,0.058749048493879186,0.058453788984538561,0.05815892070884654,0.057864452744896704,0.05757039410239851,0.057276753722348167,0.056983540476707645,0.056690763168091775,0.056398430529463389,0.056106551223836662,0.055815133843988403,0.055524186912177573,0.055233718879872634,0.05494373812748727,0.054654252964123823,0.054365271627324983,0.054076802282833347,0.053788853024359075,0.053501431873355453,0.053214546778802455,0.052928205616998257,0.052642416191358635,0.052357186232224268,0.052072523396676035,0.051788435268358031,0.051504929357308445,0.051222013099798409,0.050939693858178384,0.050657978920732545,0.050376875501540776,0.050096390740348419,0.049816531702443684,0.049537305378542743,0.049258718684682463,0.048980778462120698,0.048703491477244114,0.04842686442148366,0.048150903911237435,0.047875616487801059,0.047601008617305478,0.047327086690662101,0.047053857023515479,0.046781325856203052,0.046509499353722374,0.046238383605705514,0.045967984626400643,0.045698308354660877,0.045429360653940092,0.045161147312296021,0.04489367404240021,0.044626946481555109,0.04436097019171803,0.044095750659532133],"type":"scatter","mode":"lines","name":"Female","line":{"color":"#6CC24A"},"visible":false,"marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[0,0],"y":[0,0.044999999999999998],"type":"scatter","mode":"lines","line":{"color":"#6CC24A","dash":"solid"},"showlegend":false,"marker":{"color":"rgba(44,160,44,1)","line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1.5,1.5],"y":[0,0.044999999999999998],"type":"scatter","mode":"lines","line":{"color":"#6CC24A","dash":"solid"},"showlegend":false,"marker":{"color":"rgba(214,39,40,1)","line":{"color":"rgba(214,39,40,1)"}},"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[4,4],"y":[0,0.044999999999999998],"type":"scatter","mode":"lines","line":{"color":"#6CC24A","dash":"solid"},"showlegend":false,"marker":{"color":"rgba(148,103,189,1)","line":{"color":"rgba(148,103,189,1)"}},"error_y":{"color":"rgba(148,103,189,1)"},"error_x":{"color":"rgba(148,103,189,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="cumulative-probabilities" class="level2">
<h2 class="anchored" data-anchor-id="cumulative-probabilities">Cumulative Probabilities</h2>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>t1 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>t2 <span class="ot">&lt;-</span> <span class="fl">1.5</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>t3 <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>education <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">16</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>xb_RM <span class="ot">&lt;-</span> (<span class="dv">2</span> <span class="sc">-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="dv">4</span>) <span class="sc">+</span> <span class="fl">0.4</span> <span class="sc">*</span> education</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co"># probabilities</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>c0 <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(t1 <span class="sc">-</span> xb_RM)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>c1 <span class="ot">&lt;-</span> <span class="fu">pnorm</span>((t2 <span class="sc">-</span> xb_RM) <span class="sc">+</span> (t1 <span class="sc">-</span> xb_RM))</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>c2 <span class="ot">&lt;-</span> <span class="fu">pnorm</span>((t3 <span class="sc">-</span> xb_RM) <span class="sc">+</span> (t2 <span class="sc">-</span> xb_RM))</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>c3 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(t3 <span class="sc">-</span> xb_RM)</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data frame</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">education =</span> education, <span class="at">c0 =</span> c0, <span class="at">c1 =</span> c1, <span class="at">c2 =</span> c2, <span class="at">c3 =</span> c3)</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>binghamton_green <span class="ot">&lt;-</span> <span class="st">"#005A43"</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>binghamton_gray <span class="ot">&lt;-</span> <span class="st">"#6CC24A"</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>binghamton_black <span class="ot">&lt;-</span> <span class="st">"#000000"</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> education)) <span class="sc">+</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> c0, <span class="at">color =</span> <span class="st">"Not Secure"</span>), <span class="at">size =</span> .<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> c1, <span class="at">color =</span> <span class="st">"Somewhat Secure"</span>), <span class="at">size =</span> .<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> c2, <span class="at">color =</span> <span class="st">"Very Secure"</span>), <span class="at">size =</span> .<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_line(aes(y = c3, color = "Extremely Secure"), size = 1) +</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Not Secure"</span> <span class="ot">=</span> binghamton_green,</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Somewhat Secure"</span> <span class="ot">=</span> binghamton_gray,</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Very Secure"</span> <span class="ot">=</span> binghamton_black)) <span class="sc">+</span></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="fl">0.7</span>, <span class="at">label =</span> <span class="st">"Not Secure"</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">color =</span> binghamton_green) <span class="sc">+</span></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">5</span>, <span class="at">y =</span> <span class="fl">0.9</span>, <span class="at">label =</span> <span class="st">"Somewhat Secure"</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">color =</span> binghamton_gray) <span class="sc">+</span></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">10</span>, <span class="at">y =</span> <span class="fl">0.7</span>, <span class="at">label =</span> <span class="st">"Very Secure"</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">color =</span> binghamton_black) <span class="sc">+</span></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Years of Education"</span>, <span class="at">y =</span> <span class="st">"Pr(y=j)"</span>) <span class="sc">+</span></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="binaryextensions224_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="estimation" class="level2">
<h2 class="anchored" data-anchor-id="estimation">Estimation</h2>
<p>Because the ordered probit and logit models are straightforward extensions of the binary models, estimation is relatively simple. Let’s recall the probit likelihood function:</p>
<p><span class="math display">\[\begin{aligned}
L(\beta|Y,X) = \prod\limits_{i=1}^{n} [\Phi(X \beta)]^{y_{i}} [1-\Phi(X \beta)]^{1-y_{i}}  \nonumber
\end{aligned}\]</span> and the log likelihood as <span class="math display">\[\begin{aligned}
\ln L(\beta|Y,X) = \sum\limits_{i=1}^{n} y_{i} \ln(\Phi(X \beta)) + (1-y_{i}) \ln(1-\Phi(X \beta))  \nonumber
\end{aligned}\]</span></p>
<section id="probit" class="level3">
<h3 class="anchored" data-anchor-id="probit">Probit …</h3>
<p><span class="math display">\[\begin{aligned}
L(\beta, \tau |Y,X) = \prod\limits_{i=1}^{n} \prod\limits_{j=1}^{m} \left[ \Phi(\tau_{j} - \beta'X)- \Phi(\tau_{j-1}- \beta'X) \right]^{y_{ij}}  \nonumber
\end{aligned}\]</span> and the log likelihood is <span class="math display">\[\begin{aligned}
\ln L(\beta, \tau |Y,X) = \sum\limits_{i=1}^{n} \sum\limits_{j=1}^{m} y_{ij} \ln \left[ \Phi(\tau_{j}- \beta'X) - \Phi(\tau_{j-1} - \beta'X) \right]  \nonumber
\end{aligned}\]</span></p>
<p>Note the LLF will turn on for <span class="math inline">\(y=j\)</span> and off for <span class="math inline">\(y\neq j\)</span> just as in the binary case.</p>
<p>and as is the case in the binary probit model, we assume <span class="math inline">\(\sigma^{2}\)</span> to be one (and in the ordered logit model to be <span class="math inline">\(\frac{\pi^{2}}{3}\)</span>); put another way, we assume the model is homoskedastic. Relaxing this assumption is just as easy in the ordered probit model as it is in the binary model since:</p>
<p><span class="math display">\[\begin{aligned}
\ln L(\beta, \tau |Y,X) = \sum\limits_{i=1}^{n} \sum\limits_{j=1}^{m} y_{ij} \ln \left[ \Phi \left(\frac{\tau_{j}- \beta'X}{\sigma^{2}} \right) - \Phi \left( \frac{\tau_{j-1} - \beta'X)}{\sigma^{2}} \right) \right]  \nonumber
\end{aligned}\]</span></p>
<p>and we can parameterize <span class="math inline">\(\sigma^{2}\)</span> as <span class="math inline">\(\exp(z \gamma)\)</span> just as in the binary model.</p>
</section>
</section>
<section id="example-1" class="level2">
<h2 class="anchored" data-anchor-id="example-1">Example</h2>
<p>This example uses a dataset on beer quality and price. The dataset contains the following variables:</p>
<ul>
<li><code>quality</code>: quality of the beer (1 = fair, 2 = good, 3 = very good, 4 = excellent)</li>
<li><code>price</code>: price of the beer</li>
<li><code>calories</code>: calories per serving</li>
<li><code>craftbeer</code>: indicator for craft beer</li>
<li><code>bitter</code>: bitterness score</li>
<li><code>malty</code>: maltiness score</li>
</ul>
<p>The <span class="math inline">\(y\)</span> variable here is the four category quality score.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load required libraries</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(haven)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the beer dataset</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>beer <span class="ot">&lt;-</span> <span class="fu">read_dta</span>(<span class="st">"/Users/dave/Documents/teaching/606J-mle/2024/topics/ordered-variance/beer.dta"</span>)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create quality4 variable</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>beer <span class="ot">&lt;-</span> beer <span class="sc">%&gt;%</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">quality4 =</span> <span class="fu">ntile</span>(quality, <span class="dv">4</span>))</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ordered logistic regression model</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">polr</span>(<span class="fu">factor</span>(quality4) <span class="sc">~</span> price <span class="sc">+</span> calories <span class="sc">+</span> craftbeer <span class="sc">+</span> bitter <span class="sc">+</span> malty, <span class="at">data =</span> beer)</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>stargazer<span class="sc">::</span><span class="fu">stargazer</span>(model, <span class="at">type =</span> <span class="st">"html"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<table style="text-align:center">
<tbody><tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
<em>Dependent variable:</em>
</td>
</tr>
<tr>
<td>
</td>
<td colspan="1" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
quality4
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
price
</td>
<td>
-0.521<sup>*</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.297)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
calories
</td>
<td>
0.045<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.012)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
craftbeer
</td>
<td>
-1.738<sup>*</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.942)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
bitter
</td>
<td>
-0.027
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.042)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
malty
</td>
<td>
0.054<sup>**</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.025)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
69
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td style="text-align:right">
<sup><em></em></sup><em>p&lt;0.1; <sup><strong></strong></sup><strong>p&lt;0.05; <sup></sup></strong></em>p&lt;0.01
</td>
</tr>
</tbody></table>
</div>
<p>Let’s make predictions of quality over the values of price (at-means):</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># at means data</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>beersim <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">calories =</span> <span class="dv">60</span><span class="sc">:</span><span class="dv">200</span>,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">price =</span> <span class="fl">4.96</span>,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">craftbeer =</span> <span class="dv">0</span>,</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">bitter =</span> <span class="fl">35.44</span>,</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">malty =</span> <span class="fl">33.13</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict probabilities</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>probs <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, <span class="at">newdata =</span> beersim, <span class="at">type =</span> <span class="st">"probs"</span>)</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>beersim <span class="ot">&lt;-</span> <span class="fu">cbind</span>(beersim, probs)</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(beersim)[<span class="dv">6</span><span class="sc">:</span><span class="dv">9</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ProbFair"</span>, <span class="st">"ProbGood"</span>, <span class="st">"ProbVG"</span>, <span class="st">"ProbExc"</span>)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="co">#  plot</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(beersim, <span class="fu">aes</span>(<span class="at">x =</span> calories)) <span class="sc">+</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> ProbFair, <span class="at">color =</span> <span class="st">"Fair"</span>), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> ProbGood, <span class="at">color =</span> <span class="st">"Good"</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> ProbVG, <span class="at">color =</span> <span class="st">"Very Good"</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"longdash"</span>) <span class="sc">+</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> ProbExc, <span class="at">color =</span> <span class="st">"Excellent"</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dotdash"</span>) <span class="sc">+</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Fair"</span> <span class="ot">=</span> <span class="st">"black"</span>, <span class="st">"Good"</span> <span class="ot">=</span> <span class="st">"red"</span>, <span class="st">"Very Good"</span> <span class="ot">=</span> <span class="st">"navy"</span>, <span class="st">"Excellent"</span> <span class="ot">=</span> <span class="st">"darkgreen"</span>)) <span class="sc">+</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Predicted Probabilities"</span>, <span class="at">x =</span> <span class="st">"Calories per Serving"</span>, <span class="at">color =</span> <span class="st">"Quality"</span>) <span class="sc">+</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="binaryextensions224_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>And here, let’s plot the cumulative probabilities:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate cumulative probabilities</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>beersim <span class="ot">&lt;-</span> beersim <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">CDzero =</span> <span class="dv">0</span>,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">CDFair =</span> ProbFair,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">CDGood =</span> ProbFair <span class="sc">+</span> ProbGood,</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">CDVG =</span> ProbFair <span class="sc">+</span> ProbGood <span class="sc">+</span> ProbVG,</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">CDExcellent =</span> ProbFair <span class="sc">+</span> ProbGood <span class="sc">+</span> ProbVG <span class="sc">+</span> ProbExc</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(beersim, <span class="fu">aes</span>(<span class="at">x =</span> calories)) <span class="sc">+</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="fu">aes</span>(<span class="at">y =</span> CDExcellent), <span class="at">fill =</span> <span class="st">"gray20"</span>) <span class="sc">+</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="fu">aes</span>(<span class="at">y =</span> CDVG), <span class="at">fill =</span> <span class="st">"gray50"</span>) <span class="sc">+</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="fu">aes</span>(<span class="at">y =</span> CDGood), <span class="at">fill =</span> <span class="st">"gray80"</span>) <span class="sc">+</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="fu">aes</span>(<span class="at">y =</span> CDFair), <span class="at">fill =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> CDExcellent), <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> CDVG), <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> CDGood), <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> CDFair), <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Cumulative Probabilities"</span>, <span class="at">x =</span> <span class="st">"Calories per Serving"</span>) <span class="sc">+</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">60</span>, <span class="dv">200</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">60</span>, <span class="dv">200</span>, <span class="at">by =</span> <span class="dv">20</span>)) <span class="sc">+</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.2</span>)) <span class="sc">+</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="binaryextensions224_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="parallel-regression-assumption" class="level2">
<h2 class="anchored" data-anchor-id="parallel-regression-assumption">Parallel Regression Assumption</h2>
<p>Ordered models rest on the <strong>parallel regression assumption</strong> (in the ordered logit, this is sometimes called the <strong>proportional odds assumption</strong>). The parallel regression assumption requires that the effect of <span class="math inline">\(X_{i}\)</span> is <span class="math inline">\(\beta\)</span> for all categories of <span class="math inline">\(Y\)</span>. That is, the regression of <span class="math inline">\(y_i\)</span> on <span class="math inline">\(x\)</span> is parallel to the regression of <span class="math inline">\(y_j\)</span> on <span class="math inline">\(x\)</span> and so forth.</p>
<p>Suppose we have some reason to expect that <span class="math inline">\(X_{i}\)</span> increases the probability of <span class="math inline">\(Y=1\)</span>, but decreases the probability of <span class="math inline">\(Y=2\)</span>. First, it seems likely we should revisit whether or not <span class="math inline">\(Y\)</span> is ordinal. Second, since we’re only estimating one value of <span class="math inline">\(\beta\)</span>, it cannot simultaneously represent our expectations that <span class="math inline">\(X_{i}\)</span> increases one probability while decreasing another. So, if we run the ordered model, we will only get one value of <span class="math inline">\(\beta\)</span> and its effect will be the same on all categories of <span class="math inline">\(Y\)</span>.</p>
<p>Here’s what non-parallel regressions might look like:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load required libraries</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Define Binghamton University colors</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>binghamton_green <span class="ot">&lt;-</span> <span class="st">"#005A43"</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>binghamton_gray <span class="ot">&lt;-</span> <span class="st">"#8C8C8C"</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>binghamton_black <span class="ot">&lt;-</span> <span class="st">"#000000"</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>binghamton_light_green <span class="ot">&lt;-</span> <span class="st">"#4C7C6F"</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Define education data</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>education <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">20</span>, <span class="at">by =</span> <span class="fl">0.1</span>)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to calculate cumulative probabilities</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>calc_cum_probs <span class="ot">&lt;-</span> <span class="cf">function</span>(education, beta, thresholds) {</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>  xb <span class="ot">&lt;-</span> beta <span class="sc">*</span> education</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>  probs <span class="ot">&lt;-</span> <span class="fu">lapply</span>(thresholds, <span class="cf">function</span>(t) <span class="fu">pnorm</span>(t <span class="sc">-</span> xb))</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">do.call</span>(cbind, probs)</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameters for parallel case</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>beta_parallel <span class="ot">&lt;-</span> <span class="fl">0.2</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>thresholds_parallel <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameters for non-parallel case</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>beta_non_parallel <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span>)</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>thresholds_non_parallel <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate probabilities</span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>probs_parallel <span class="ot">&lt;-</span> <span class="fu">calc_cum_probs</span>(education, beta_parallel, thresholds_parallel)</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>probs_non_parallel <span class="ot">&lt;-</span> <span class="fu">cbind</span>(</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pnorm</span>(thresholds_non_parallel[<span class="dv">1</span>] <span class="sc">-</span> beta_non_parallel[<span class="dv">1</span>] <span class="sc">*</span> education),</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pnorm</span>(thresholds_non_parallel[<span class="dv">2</span>] <span class="sc">-</span> beta_non_parallel[<span class="dv">2</span>] <span class="sc">*</span> education),</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pnorm</span>(thresholds_non_parallel[<span class="dv">3</span>] <span class="sc">-</span> beta_non_parallel[<span class="dv">3</span>] <span class="sc">*</span> education)</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data frames</span></span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>df_parallel <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">education =</span> education, probs_parallel)</span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>df_non_parallel <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">education =</span> education, probs_non_parallel)</span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to create plot</span></span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>create_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(df, title) {</span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> education)) <span class="sc">+</span></span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> X1, <span class="at">color =</span> <span class="st">"Y ≤ 1"</span>), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> X2, <span class="at">color =</span> <span class="st">"Y ≤ 2"</span>), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> X3, <span class="at">color =</span> <span class="st">"Y ≤ 3"</span>), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Y ≤ 1"</span> <span class="ot">=</span> binghamton_green,</span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"Y ≤ 2"</span> <span class="ot">=</span> binghamton_gray,</span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"Y ≤ 3"</span> <span class="ot">=</span> binghamton_black)) <span class="sc">+</span></span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Years of Education"</span>, <span class="at">y =</span> <span class="st">"Cumulative Probability"</span>, <span class="at">title =</span> title, <span class="at">color =</span> <span class="st">"Category"</span>) <span class="sc">+</span></span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">color =</span> binghamton_black),</span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> binghamton_black),</span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.grid =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"#E0E0E0"</span>),</span>
<span id="cb8-56"><a href="#cb8-56" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb8-57"><a href="#cb8-57" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-58"><a href="#cb8-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-59"><a href="#cb8-59" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plots</span></span>
<span id="cb8-60"><a href="#cb8-60" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">create_plot</span>(df_parallel, <span class="st">"Parallel Regression (Assumption Satisfied)"</span>)</span>
<span id="cb8-61"><a href="#cb8-61" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">create_plot</span>(df_non_parallel, <span class="st">"Non-Parallel Regression (Assumption Violated)"</span>)</span>
<span id="cb8-62"><a href="#cb8-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-63"><a href="#cb8-63" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine plots</span></span>
<span id="cb8-64"><a href="#cb8-64" aria-hidden="true" tabindex="-1"></a>combined_plot <span class="ot">&lt;-</span> <span class="fu">grid.arrange</span>(p1, p2, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="binaryextensions224_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Evaluating the parallel regression assumption:</p>
<ul>
<li>Estimate the ordered logit model and a multinomial model and compare how well they fit the data (compare the log-likelihood <span class="math inline">\(\chi^{2}\)</span> values). Also examine the MNL estimates of <span class="math inline">\(\beta\)</span> for <span class="math inline">\(x_i\)</span> and see if they are the same across categories. MNL relaxes the parallel regression assumption. - A second informal way is to estimate <span class="math inline">\(j-1\)</span> individual probit or logit models, one for each additional value of <span class="math inline">\(Y\)</span>. Compare the estimates of <span class="math inline">\(\beta_{j}\)</span> with the ordered probit/logit estimate of <span class="math inline">\(\beta\)</span>. If the estimates are roughly the same, the parallel regression assumption is likely met. This is equivalent to the ordered logit/MNL comparison above.</li>
<li>formal tests exist as well comparing models where parallel regressions is relaxed and where it’s not.</li>
</ul>
<p>The parallel lines assumption is, in my experience, difficult to satisfy. Long &amp; Freese (p.&nbsp;168) seem to have the same experience. The assumption is extremely restrictive, and perhaps difficult to meet for two reasons:</p>
<ul>
<li><span class="math inline">\(y\)</span> may not actually be ordered.</li>
<li><span class="math inline">\(y | \mathbf{X}\)</span> is very likely not ordered.</li>
</ul>
</section>
<section id="relaxing-parallel-regression" class="level2">
<h2 class="anchored" data-anchor-id="relaxing-parallel-regression">Relaxing Parallel Regression</h2>
<p>The Generalized ordered logit/probit is one pathway to relaxing the parallel regression assumption. The generalized ordered logit/probit allows for the effects of <span class="math inline">\(X\)</span> to vary across categories of <span class="math inline">\(y\)</span>, such that the model estimates <span class="math inline">\(k-1\)</span> values of <span class="math inline">\(\beta\)</span>. The model can be unstable and produce predictions out of bounds. Here’s the same model predicting beer quality, but we’re relaxing the parallel regression assumption in the variables “price” and “calories” - you’ll note each of these has <span class="math inline">\(k-1\)</span> coefficients.</p>
<!-- ```{r results='asis'} -->
<!-- #| echo: true -->
<!-- #| code-fold: true -->
<!-- #| code-summary: "code" -->
<!-- # Load required libraries -->
<!-- library(readr) -->
<!-- library(dplyr) -->
<!-- library(VGAM) -->
<!-- # ANES 2016 data -->
<!-- anes <- read_csv("/Users/dave/Documents/teaching/606J-mle/2020/slides/L3_binaryextensions/code/anes_pilot_2016.csv") -->
<!-- # Select variables -->
<!-- vars_to_keep <- c("bo_muslim", "pid7", "disc_wo", "lazyb", "disc_b", "faminc", "birthyr", "race", "autism", "disc_selfsex", "gender", "vaccine") -->
<!-- anes <- anes[, vars_to_keep] -->
<!-- # Recode variables -->
<!-- anes <- anes %>% -->
<!--   mutate( -->
<!--     pid7 = as.numeric(pid7), -->
<!--     bo_muslim = case_when( -->
<!--       bo_muslim == 2 ~ 0, -->
<!--       bo_muslim == 1 ~ 1, -->
<!--       bo_muslim == 8 ~ NA_real_, -->
<!--       TRUE ~ bo_muslim -->
<!--     ), -->
<!--     pid7 = ifelse(pid7 > 7, NA, pid7), -->
<!--     disc_wo = ifelse(disc_wo > 7, NA, disc_wo), -->
<!--     lazyb = ifelse(lazyb > 7, NA, lazyb), -->
<!--     disc_b = ifelse(disc_b > 5, NA, disc_b), -->
<!--     faminc = ifelse(faminc > 16, NA, faminc), -->
<!--     age = 2016 - birthyr, -->
<!--     white = ifelse(race == 1, 1, 0), -->
<!--     # Reverse coding -->
<!--     disc_wo = -1 * disc_wo + 6, -->
<!--     disc_selfsex = -1 * disc_selfsex + 6, -->
<!--     autism = -1 * autism + 7, -->
<!--     disc_b = -1 * disc_b + 6 -->
<!--   ) -->
<!-- # Generalized ordered logit using VGAM -->
<!-- gologit_model <- vglm(factor(disc_wo) ~ disc_selfsex + age + faminc + factor(gender) + pid7 + white, -->
<!--                       family = cumulative(parallel = FALSE, reverse = TRUE), -->
<!--                       data = anes) -->
<!-- modelsummary::modelsummary(gologit_model) -->
<!-- ``` -->
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(VGAM)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>beer <span class="ot">&lt;-</span> <span class="fu">read_dta</span>(<span class="st">"/Users/dave/Documents/teaching/606J-mle/2024/topics/ordered-variance/beer.dta"</span>)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>beer <span class="ot">&lt;-</span> beer <span class="sc">%&gt;%</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">quality4 =</span> <span class="fu">ntile</span>(quality, <span class="dv">4</span>))</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the generalized ordered logit model</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>gologit_model <span class="ot">&lt;-</span> <span class="fu">vglm</span>(quality4 <span class="sc">~</span> price <span class="sc">+</span> calories <span class="sc">+</span> craftbeer <span class="sc">+</span> bitter <span class="sc">+</span> malty,</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> <span class="fu">cumulative</span>(<span class="at">parallel =</span> <span class="cn">FALSE</span><span class="sc">~</span>price<span class="sc">+</span>calories, <span class="at">reverse =</span> <span class="cn">TRUE</span>), <span class="at">data =</span> beer)</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>modelsummary<span class="sc">::</span><span class="fu">modelsummary</span>(gologit_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<!-- preamble start -->

    <script>
      function styleCell_hwqokepuft57llugx3c4(i, j, css_id) {
        var table = document.getElementById("tinytable_hwqokepuft57llugx3c4");
        table.rows[i].cells[j].classList.add(css_id);
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_hwqokepuft57llugx3c4');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_hwqokepuft57llugx3c4(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_hwqokepuft57llugx3c4");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
window.addEventListener('load', function () { styleCell_hwqokepuft57llugx3c4(0, 0, 'tinytable_css_idk6pj5tusgjyow139w4o7') })
window.addEventListener('load', function () { styleCell_hwqokepuft57llugx3c4(0, 1, 'tinytable_css_id8zxlrswibxkgbtyto2hv') })
window.addEventListener('load', function () { styleCell_hwqokepuft57llugx3c4(1, 0, 'tinytable_css_idokhu56gr6jhsgw11cn2h') })
window.addEventListener('load', function () { styleCell_hwqokepuft57llugx3c4(1, 1, 'tinytable_css_idgvpcjjsjt79gha1iccut') })
window.addEventListener('load', function () { styleCell_hwqokepuft57llugx3c4(2, 0, 'tinytable_css_idokhu56gr6jhsgw11cn2h') })
window.addEventListener('load', function () { styleCell_hwqokepuft57llugx3c4(2, 1, 'tinytable_css_idgvpcjjsjt79gha1iccut') })
window.addEventListener('load', function () { styleCell_hwqokepuft57llugx3c4(3, 0, 'tinytable_css_idokhu56gr6jhsgw11cn2h') })
window.addEventListener('load', function () { styleCell_hwqokepuft57llugx3c4(3, 1, 'tinytable_css_idgvpcjjsjt79gha1iccut') })
window.addEventListener('load', function () { styleCell_hwqokepuft57llugx3c4(4, 0, 'tinytable_css_idokhu56gr6jhsgw11cn2h') })
window.addEventListener('load', function () { styleCell_hwqokepuft57llugx3c4(4, 1, 'tinytable_css_idgvpcjjsjt79gha1iccut') })
window.addEventListener('load', function () { styleCell_hwqokepuft57llugx3c4(5, 0, 'tinytable_css_idokhu56gr6jhsgw11cn2h') })
window.addEventListener('load', function () { styleCell_hwqokepuft57llugx3c4(5, 1, 'tinytable_css_idgvpcjjsjt79gha1iccut') })
window.addEventListener('load', function () { styleCell_hwqokepuft57llugx3c4(6, 0, 'tinytable_css_idokhu56gr6jhsgw11cn2h') })
window.addEventListener('load', function () { styleCell_hwqokepuft57llugx3c4(6, 1, 'tinytable_css_idgvpcjjsjt79gha1iccut') })
window.addEventListener('load', function () { styleCell_hwqokepuft57llugx3c4(7, 0, 'tinytable_css_idokhu56gr6jhsgw11cn2h') })
window.addEventListener('load', function () { styleCell_hwqokepuft57llugx3c4(7, 1, 'tinytable_css_idgvpcjjsjt79gha1iccut') })
window.addEventListener('load', function () { styleCell_hwqokepuft57llugx3c4(8, 0, 'tinytable_css_idokhu56gr6jhsgw11cn2h') })
window.addEventListener('load', function () { styleCell_hwqokepuft57llugx3c4(8, 1, 'tinytable_css_idgvpcjjsjt79gha1iccut') })
window.addEventListener('load', function () { styleCell_hwqokepuft57llugx3c4(9, 0, 'tinytable_css_idokhu56gr6jhsgw11cn2h') })
window.addEventListener('load', function () { styleCell_hwqokepuft57llugx3c4(9, 1, 'tinytable_css_idgvpcjjsjt79gha1iccut') })
window.addEventListener('load', function () { styleCell_hwqokepuft57llugx3c4(10, 0, 'tinytable_css_idokhu56gr6jhsgw11cn2h') })
window.addEventListener('load', function () { styleCell_hwqokepuft57llugx3c4(10, 1, 'tinytable_css_idgvpcjjsjt79gha1iccut') })
window.addEventListener('load', function () { styleCell_hwqokepuft57llugx3c4(11, 0, 'tinytable_css_idokhu56gr6jhsgw11cn2h') })
window.addEventListener('load', function () { styleCell_hwqokepuft57llugx3c4(11, 1, 'tinytable_css_idgvpcjjsjt79gha1iccut') })
window.addEventListener('load', function () { styleCell_hwqokepuft57llugx3c4(12, 0, 'tinytable_css_idokhu56gr6jhsgw11cn2h') })
window.addEventListener('load', function () { styleCell_hwqokepuft57llugx3c4(12, 1, 'tinytable_css_idgvpcjjsjt79gha1iccut') })
window.addEventListener('load', function () { styleCell_hwqokepuft57llugx3c4(13, 0, 'tinytable_css_idokhu56gr6jhsgw11cn2h') })
window.addEventListener('load', function () { styleCell_hwqokepuft57llugx3c4(13, 1, 'tinytable_css_idgvpcjjsjt79gha1iccut') })
window.addEventListener('load', function () { styleCell_hwqokepuft57llugx3c4(14, 0, 'tinytable_css_idokhu56gr6jhsgw11cn2h') })
window.addEventListener('load', function () { styleCell_hwqokepuft57llugx3c4(14, 1, 'tinytable_css_idgvpcjjsjt79gha1iccut') })
window.addEventListener('load', function () { styleCell_hwqokepuft57llugx3c4(15, 0, 'tinytable_css_idokhu56gr6jhsgw11cn2h') })
window.addEventListener('load', function () { styleCell_hwqokepuft57llugx3c4(15, 1, 'tinytable_css_idgvpcjjsjt79gha1iccut') })
window.addEventListener('load', function () { styleCell_hwqokepuft57llugx3c4(16, 0, 'tinytable_css_idokhu56gr6jhsgw11cn2h') })
window.addEventListener('load', function () { styleCell_hwqokepuft57llugx3c4(16, 1, 'tinytable_css_idgvpcjjsjt79gha1iccut') })
window.addEventListener('load', function () { styleCell_hwqokepuft57llugx3c4(17, 0, 'tinytable_css_idokhu56gr6jhsgw11cn2h') })
window.addEventListener('load', function () { styleCell_hwqokepuft57llugx3c4(17, 1, 'tinytable_css_idgvpcjjsjt79gha1iccut') })
window.addEventListener('load', function () { styleCell_hwqokepuft57llugx3c4(18, 0, 'tinytable_css_idokhu56gr6jhsgw11cn2h') })
window.addEventListener('load', function () { styleCell_hwqokepuft57llugx3c4(18, 1, 'tinytable_css_idgvpcjjsjt79gha1iccut') })
window.addEventListener('load', function () { styleCell_hwqokepuft57llugx3c4(19, 0, 'tinytable_css_idokhu56gr6jhsgw11cn2h') })
window.addEventListener('load', function () { styleCell_hwqokepuft57llugx3c4(19, 1, 'tinytable_css_idgvpcjjsjt79gha1iccut') })
window.addEventListener('load', function () { styleCell_hwqokepuft57llugx3c4(20, 0, 'tinytable_css_idokhu56gr6jhsgw11cn2h') })
window.addEventListener('load', function () { styleCell_hwqokepuft57llugx3c4(20, 1, 'tinytable_css_idgvpcjjsjt79gha1iccut') })
window.addEventListener('load', function () { styleCell_hwqokepuft57llugx3c4(21, 0, 'tinytable_css_idokhu56gr6jhsgw11cn2h') })
window.addEventListener('load', function () { styleCell_hwqokepuft57llugx3c4(21, 1, 'tinytable_css_idgvpcjjsjt79gha1iccut') })
window.addEventListener('load', function () { styleCell_hwqokepuft57llugx3c4(22, 0, 'tinytable_css_idokhu56gr6jhsgw11cn2h') })
window.addEventListener('load', function () { styleCell_hwqokepuft57llugx3c4(22, 1, 'tinytable_css_idgvpcjjsjt79gha1iccut') })
window.addEventListener('load', function () { styleCell_hwqokepuft57llugx3c4(23, 0, 'tinytable_css_idokhu56gr6jhsgw11cn2h') })
window.addEventListener('load', function () { styleCell_hwqokepuft57llugx3c4(23, 1, 'tinytable_css_idgvpcjjsjt79gha1iccut') })
window.addEventListener('load', function () { styleCell_hwqokepuft57llugx3c4(24, 0, 'tinytable_css_id1bc5fyzqqym2u1m28tut') })
window.addEventListener('load', function () { styleCell_hwqokepuft57llugx3c4(24, 1, 'tinytable_css_idlt9f4zwfrbr1b5fei2ww') })
window.addEventListener('load', function () { styleCell_hwqokepuft57llugx3c4(25, 0, 'tinytable_css_idokhu56gr6jhsgw11cn2h') })
window.addEventListener('load', function () { styleCell_hwqokepuft57llugx3c4(25, 1, 'tinytable_css_idgvpcjjsjt79gha1iccut') })
window.addEventListener('load', function () { styleCell_hwqokepuft57llugx3c4(26, 0, 'tinytable_css_idokhu56gr6jhsgw11cn2h') })
window.addEventListener('load', function () { styleCell_hwqokepuft57llugx3c4(26, 1, 'tinytable_css_idgvpcjjsjt79gha1iccut') })
window.addEventListener('load', function () { styleCell_hwqokepuft57llugx3c4(27, 0, 'tinytable_css_idokhu56gr6jhsgw11cn2h') })
window.addEventListener('load', function () { styleCell_hwqokepuft57llugx3c4(27, 1, 'tinytable_css_idgvpcjjsjt79gha1iccut') })
window.addEventListener('load', function () { styleCell_hwqokepuft57llugx3c4(28, 0, 'tinytable_css_idokhu56gr6jhsgw11cn2h') })
window.addEventListener('load', function () { styleCell_hwqokepuft57llugx3c4(28, 1, 'tinytable_css_idgvpcjjsjt79gha1iccut') })
    </script>

    <style>
    .table td.tinytable_css_idk6pj5tusgjyow139w4o7, .table th.tinytable_css_idk6pj5tusgjyow139w4o7 {  text-align: left;  border-bottom: solid 0.1em #d3d8dc; }
    .table td.tinytable_css_id8zxlrswibxkgbtyto2hv, .table th.tinytable_css_id8zxlrswibxkgbtyto2hv {  text-align: center;  border-bottom: solid 0.1em #d3d8dc; }
    .table td.tinytable_css_idokhu56gr6jhsgw11cn2h, .table th.tinytable_css_idokhu56gr6jhsgw11cn2h {  text-align: left; }
    .table td.tinytable_css_idgvpcjjsjt79gha1iccut, .table th.tinytable_css_idgvpcjjsjt79gha1iccut {  text-align: center; }
    .table td.tinytable_css_id1bc5fyzqqym2u1m28tut, .table th.tinytable_css_id1bc5fyzqqym2u1m28tut {  border-bottom: solid 0.05em black;  text-align: left; }
    .table td.tinytable_css_idlt9f4zwfrbr1b5fei2ww, .table th.tinytable_css_idlt9f4zwfrbr1b5fei2ww {  border-bottom: solid 0.05em black;  text-align: center; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_hwqokepuft57llugx3c4" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col"> </th>
                <th scope="col">(1)</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>(Intercept) × 1</td>
                  <td>-1.586 </td>
                </tr>
                <tr>
                  <td>               </td>
                  <td>(1.703)</td>
                </tr>
                <tr>
                  <td>(Intercept) × 2</td>
                  <td>-5.784 </td>
                </tr>
                <tr>
                  <td>               </td>
                  <td>(2.474)</td>
                </tr>
                <tr>
                  <td>(Intercept) × 3</td>
                  <td>-12.013</td>
                </tr>
                <tr>
                  <td>               </td>
                  <td>(2.919)</td>
                </tr>
                <tr>
                  <td>price × 1      </td>
                  <td>-0.599 </td>
                </tr>
                <tr>
                  <td>               </td>
                  <td>(0.357)</td>
                </tr>
                <tr>
                  <td>price × 2      </td>
                  <td>-0.447 </td>
                </tr>
                <tr>
                  <td>               </td>
                  <td>(0.324)</td>
                </tr>
                <tr>
                  <td>price × 3      </td>
                  <td>-0.399 </td>
                </tr>
                <tr>
                  <td>               </td>
                  <td>(0.346)</td>
                </tr>
                <tr>
                  <td>calories × 1   </td>
                  <td>0.043  </td>
                </tr>
                <tr>
                  <td>               </td>
                  <td>(0.013)</td>
                </tr>
                <tr>
                  <td>calories × 2   </td>
                  <td>0.057  </td>
                </tr>
                <tr>
                  <td>               </td>
                  <td>(0.018)</td>
                </tr>
                <tr>
                  <td>calories × 3   </td>
                  <td>0.087  </td>
                </tr>
                <tr>
                  <td>               </td>
                  <td>(0.020)</td>
                </tr>
                <tr>
                  <td>craftbeer      </td>
                  <td>-1.668 </td>
                </tr>
                <tr>
                  <td>               </td>
                  <td>(0.956)</td>
                </tr>
                <tr>
                  <td>bitter         </td>
                  <td>-0.029 </td>
                </tr>
                <tr>
                  <td>               </td>
                  <td>(0.042)</td>
                </tr>
                <tr>
                  <td>malty          </td>
                  <td>0.046  </td>
                </tr>
                <tr>
                  <td>               </td>
                  <td>(0.024)</td>
                </tr>
                <tr>
                  <td>Num.Obs.       </td>
                  <td>69     </td>
                </tr>
                <tr>
                  <td>AIC            </td>
                  <td>182.3  </td>
                </tr>
                <tr>
                  <td>BIC            </td>
                  <td>209.1  </td>
                </tr>
                <tr>
                  <td>RMSE           </td>
                  <td>2.40   </td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
<p>Price and Calories can exert effects in different directions across categories of <span class="math inline">\(y\)</span>, hence relaxing the parallel regression assumption.</p>
</section>
<section id="use-ordered-models-with-caution" class="level2">
<h2 class="anchored" data-anchor-id="use-ordered-models-with-caution">Use Ordered Models with Caution …</h2>
<p>My own view is ordered models rarely fit the data - our outcome variables are rarely conditionally ordered, i.e, the expected value of <span class="math inline">\(y\)</span> ordered given the variables in the model. Other models (choice models in particular) are better suited for much of our data - and we are better able to satisfy their assumptions. As the wise man says, just because something can be ordered doesn’t mean it should be. Or, as the econometrician Amemyia (1985) says,</p>
<p>“A model is unordered if it is not ordered.” (Amemyia 1985, 292).</p>
</section>
</section>
<section id="constant-variance-in-binary-response-models" class="level1">
<h1>Constant Variance in Binary Response Models</h1>
<p>The assumption of constant variance is potentially a bigger problem than in the linear model. In the linear model, the estimates are unbiased, but the errors are inefficient. In the ML setting, the estimates are inconsistent (biased) and the errors are wrong. Consider the probit LLF:</p>
<p><span class="math display">\[\begin{aligned}
\ln \mathcal{L} = \sum\limits_{i=1}^{n} y_{i} \ln(\Phi(x_i \beta)) + (1-y_{i}) \ln(1-\Phi(x_i \beta))  \nonumber
\end{aligned}\]</span></p>
<p>rewrite with the variance, which in the standard normal is 1, so drops out if we assume constant variance:</p>
<p><span class="math display">\[\begin{aligned}
\ln \mathcal{L} = \sum\limits_{i=1}^{n} y_{i} \ln \Phi \left( \frac{x_i \beta}{\sigma^{2}} \right) + (1-y_{i}) \ln \left[1- \Phi \left (\frac{x_i \beta}{\sigma^{2}} \right) \right] \nonumber
\end{aligned}\]</span></p>
<section id="parameterizing-sigma2" class="level2">
<h2 class="anchored" data-anchor-id="parameterizing-sigma2">Parameterizing <span class="math inline">\(\sigma^2\)</span></h2>
<p>The notion here is that the variance is neither constant nor random - it potentially arises as a function of variables, so the goal is to write the variance as a systematic function of variables and coefficients. For the probit model, let</p>
<p><span class="math display">\[\begin{aligned}
Var[\epsilon] = \sigma^{2}=[e^{z\gamma}]^{2} \nonumber \\
\mbox{so} ~~~\sigma = e^{z\gamma} \nonumber
\end{aligned}\]</span></p>
<p>and</p>
<p><span class="math display">\[\begin{aligned}
\mathcal{L} = \prod\limits_{i=1}^{n} \left[\Phi \frac{(X \beta)}{e^{z\gamma}} \right ]^{y_{i}} \left[1-\Phi \frac{(X \beta)}{e^{z\gamma}} \right ]^{1-y_{i}}  \nonumber
\end{aligned}\]</span></p>
</section>
<section id="heteroskedastic-probit-llf" class="level2">
<h2 class="anchored" data-anchor-id="heteroskedastic-probit-llf">Heteroskedastic Probit LLF</h2>
<p><span class="math display">\[\begin{aligned}
\ln \mathcal{L} = \sum\limits_{i=1}^{n} y_{i} \ln \Phi \left( \frac{X \beta}{e^{z\gamma}} \right) + (1-y_{i}) \ln \left[1- \Phi \left (\frac{X \beta}{e^{z\gamma}} \right) \right] \nonumber
\end{aligned}\]</span></p>
<p>The LLF now has two unknowns, <span class="math inline">\(\widehat{\beta}\)</span> and <span class="math inline">\(\widehat{\gamma}\)</span>, where <span class="math inline">\(\widehat{\beta}\)</span> represents the effects of <span class="math inline">\(X\)</span> on the mean probability of <span class="math inline">\(y\)</span>, and <span class="math inline">\(\widehat{\gamma}\)</span> represents the effects of <span class="math inline">\(Z\)</span> on the variance of <span class="math inline">\(y\)</span>. <span class="math inline">\(X\)</span> and <span class="math inline">\(Z\)</span> can be the same - we can anticipate that the same variables (or some of the same variables) influence the mean of <span class="math inline">\(y\)</span> and the variance of <span class="math inline">\(y\)</span>.</p>
</section>
<section id="link-distribution-for-sigma2" class="level2">
<h2 class="anchored" data-anchor-id="link-distribution-for-sigma2">Link Distribution for <span class="math inline">\(\sigma^2\)</span></h2>
<p>Why is</p>
<p><span class="math display">\[\begin{aligned}
\sigma^{2}=[e^{z\gamma}]^{2} \nonumber
\end{aligned}\]</span></p>
<p>The variance must:</p>
<ul>
<li>must be non-negative.</li>
<li>if the effect of <span class="math inline">\(Z\)</span> on the variance is zero, then <span class="math inline">\(\sigma^{2}\)</span> must revert to one.</li>
</ul>
<p>Exponentiating $z $ accomplishes both of these goals: it will always be positive and if <span class="math inline">\(z\gamma\)</span> equals 0, then <span class="math inline">\(e^{z\gamma}\)</span> will equal one and the model is homoskedastic.</p>
</section>
<section id="what-if-variance-is-not-constant" class="level2">
<h2 class="anchored" data-anchor-id="what-if-variance-is-not-constant">What if variance is not constant?</h2>
<p>You notice that dividing the estimate by the variance presents a significant problem if the variance is larger for some groups in the data, smaller for others, but we restrict it to 1:</p>
<ul>
<li>for a group with larger variance, but restricted to 1, we over estimate <span class="math inline">\(\beta\)</span>. - for a group with smaller variance, but restricted to 1, we under estimate <span class="math inline">\(\beta\)</span>.</li>
</ul>
<p>So the estimates are inconsistent and the standard errors are incorrect. The bottom line is the heteroskedasticity is a bigger deal in binary response models than in the linear model.</p>
</section>
<section id="thinking-about-the-variance" class="level2">
<h2 class="anchored" data-anchor-id="thinking-about-the-variance">Thinking about the variance</h2>
<p>What does it mean for the variance to be different for different groups in the data? We are accustomed to thinking of groups in the data having different means - this is not so different.</p>
<ul>
<li>one group in the data, given by some <span class="math inline">\(x\)</span> variable, is more diffuse or variant in its behavior on <span class="math inline">\(y\)</span> than another group.</li>
<li>those groups may or may not share the same mean behavior.</li>
</ul>
<!-- ## Variances  -->
<!-- ```{r} -->
<!-- #| echo: true -->
<!-- #| code-fold: true -->
<!-- #| code-summary: "code" -->
<!-- # plot normal PDFs with mean 0, var 1; mean -1, var 2; mean 1, var 0.5 -->
<!-- z <- seq(-5, 5, length.out = 1000) -->
<!-- a <- dnorm(z, mean = 0, sd = 1) -->
<!-- b <- dnorm(z, mean = -1, sd = sqrt(2)) -->
<!-- c <- dnorm(z, mean = 1, sd = sqrt(0.5)) -->
<!-- df <- data.frame(z = z, a = a, b = b, c = c) -->
<!-- #plot using binghamton colors and annotate in the plot; exclude legend -->
<!-- ggplot(df, aes(x = z)) + -->
<!--   geom_line(aes(y = a, color = "Mean 0, Var 1"), size = 1) + -->
<!--   geom_line(aes(y = b, color = "Mean -1, Var 2"), size = 1) + -->
<!--   geom_line(aes(y = c, color = "Mean 1, Var 0.5"), size = 1) + -->
<!--   scale_color_manual(values = c("Mean 0, Var 1" = binghamton_green, -->
<!--                                 "Mean -1, Var 2" = binghamton_gray, -->
<!--                                 "Mean 1, Var 0.5" = binghamton_black)) + -->
<!--   labs(x = "z", y = "Density", color = "Group") + -->
<!--   theme_minimal() + -->
<!--   theme(legend.position = "none") -->
<!-- ``` -->
</section>
<section id="variance-of-epsilon" class="level2">
<h2 class="anchored" data-anchor-id="variance-of-epsilon">Variance of <span class="math inline">\(\epsilon\)</span></h2>
<p>The variance of <span class="math inline">\(\epsilon\)</span> in any model can be thought of like this:</p>
<p><span class="math display">\[\begin{aligned}
var(\epsilon_i)=var(\epsilon_j) \forall i,j \ldots n \nonumber
\end{aligned}\]</span></p>
<p>This is explicitly why we write the variance of the errors without a subscript - var(<span class="math inline">\(\epsilon\)</span>) - it is constant across all <span class="math inline">\(i\)</span>.</p>
<p>Put slightly differently, the distribution of <span class="math inline">\(\epsilon\)</span> is the same for all <span class="math inline">\(i\)</span>. If this does not hold, then the errors are not independent and identically distributed (i.i.d.) - their distributions are different. This is just another way to state the problem of nonconstant variance.</p>
<p>This figure illustrates what it means for the variance to be different for different groups in the data. In the top panel, the means differ, but variances are the same. This approximates the homoskedastic case. In the bottom panel, the means differ, as do the variances. This is the heteroskedastic case.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="at">length.out =</span> <span class="dv">1000</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(z, <span class="at">mean =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">sd =</span> .<span class="dv">5</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(z, <span class="at">mean =</span> <span class="dv">1</span>, <span class="at">sd =</span> .<span class="dv">5</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(z, <span class="at">mean =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">sd =</span> .<span class="dv">5</span>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(z, <span class="at">mean =</span> <span class="dv">1</span>, <span class="at">sd =</span> <span class="fu">sqrt</span>(<span class="dv">2</span>))</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">z =</span> z, <span class="at">a =</span> a, <span class="at">b =</span> b)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">z =</span> z, <span class="at">c =</span> c, <span class="at">d =</span> d)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co">#plot using binghamton colors and annotate in the plot; exclude legend</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df1, <span class="fu">aes</span>(<span class="at">x =</span> z)) <span class="sc">+</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> a, <span class="at">color =</span> <span class="st">"Mean -1, Var 1"</span>), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> b, <span class="at">color =</span> <span class="st">"Mean 1, Var 1"</span>), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Mean -1, Var 1"</span> <span class="ot">=</span> binghamton_green,</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Mean 1, Var 1"</span> <span class="ot">=</span> binghamton_gray)) <span class="sc">+</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"z"</span>, <span class="at">y =</span> <span class="st">"Density"</span>, <span class="at">color =</span> <span class="st">"Group"</span>) <span class="sc">+</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)<span class="sc">+</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Constant Variance"</span>)</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df2, <span class="fu">aes</span>(<span class="at">x =</span> z)) <span class="sc">+</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> c, <span class="at">color =</span> <span class="st">"Mean -1, Var 1"</span>), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> d, <span class="at">color =</span> <span class="st">"Mean 1, Var 2"</span>), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Mean -1, Var 1"</span> <span class="ot">=</span> binghamton_green,</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Mean 1, Var 2"</span> <span class="ot">=</span> binghamton_gray)) <span class="sc">+</span></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"z"</span>, <span class="at">y =</span> <span class="st">"Density"</span>, <span class="at">color =</span> <span class="st">"Group"</span>) <span class="sc">+</span></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)<span class="sc">+</span></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Non-Constant Variance"</span>)</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>p1<span class="sc">/</span>p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="binaryextensions224_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="a-framework-for-theory-about-variance" class="level2">
<h2 class="anchored" data-anchor-id="a-framework-for-theory-about-variance">A Framework for Theory about Variance</h2>
<p>We’ve spent a lot of time fretting about the information in our data w.r.t. maximizing the LLF. A good bit of that information is related to the variability in the data. It makes sense to think about the sources of that variability. In building arguments, quantitative social scientists tend to obsess over central tendency, but to neglect thinking about what the dispersion in the data means.</p>
<p>Here’s an attempt at a basic framework for thinking about variance:</p>
</section>
<section id="variance-framework" class="level2">
<h2 class="anchored" data-anchor-id="variance-framework">Variance Framework</h2>
<p>Substantively, what can variance represent?</p>
<ul>
<li>amount of information (certainty, uncertainty)</li>
<li>precision, accuracy</li>
<li>uniformity, diversity, heterogeneity</li>
<li>choice, constraint</li>
<li>ability, inability</li>
<li>ambivalence</li>
</ul>
<p>Imagine a data set of <span class="math inline">\(y\)</span> and <span class="math inline">\(x\)</span> – suppose <span class="math inline">\(x\)</span> is binary - it might relate to the mean of <span class="math inline">\(y\)</span> and to the variance of <span class="math inline">\(y\)</span>, such that:</p>
<ul>
<li>an increase in <span class="math inline">\(x\)</span> is related to an increase (decrease) in <span class="math inline">\(y\)</span>.</li>
<li>an increase in <span class="math inline">\(x\)</span> is related to an increase (decrease) in the variance of <span class="math inline">\(y\)</span>.</li>
</ul>
<p>This might be because:</p>
<ul>
<li>there are two groups of observations in the data w.r.t. <span class="math inline">\(x\)</span></li>
<li>one group has a higher/lower mean of <span class="math inline">\(y\)</span> than the other.</li>
<li>one group is more/less heterogeneous in <span class="math inline">\(y\)</span> than the other.</li>
</ul>
<p>Perhaps this is because:</p>
<ul>
<li>as individuals become more informed, they prefer more <span class="math inline">\(y\)</span>. This is an expectation about the mean of <span class="math inline">\(y\)</span> - as <span class="math inline">\(x\)</span> increases, the mean of <span class="math inline">\(y\)</span> increases.</li>
<li>as individuals become more informed, they behave more uniformly in preferring <span class="math inline">\(y\)</span>. This is an expectation about the variance of <span class="math inline">\(y\)</span> - as <span class="math inline">\(x\)</span> increases, the variance surrounding <span class="math inline">\(y\)</span> decreases.</li>
<li>less informed individuals prefer less <span class="math inline">\(y\)</span>, but choose more diffusely.
<ul>
<li><span class="math inline">\(x\)</span> has two effects - increasing the mean and decreasing the variance of <span class="math inline">\(y\)</span>.</li>
</ul></li>
</ul>
</section>
<section id="example-2" class="level2">
<h2 class="anchored" data-anchor-id="example-2">Example</h2>
<p>As an illustratio, let’s estimate a model predicting whether respondents believe Barack Obama is a secret Muslim. This analysis uses data from the ANES 2016 Pilot. We’ll specify two models. The probit model regresses responses to a question about whether Obama is a secret Muslim on a set of demographic and political variables; the heteroskedastic probit model posits age affects both the mean (as in the first model) and the variance. The expectation is that older voters are more likely to believe Obama is a secret Muslim, and that older voters believe this less uniformly or more diffusely than do younger voters. So we expect the effect of age on the mean to be positive, and the effect of age on the variance to be negative. Results are below - the first model is the standard probit model, the second is the heteroskedastic probit model.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Rchoice)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ANES 2016 data</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>anes <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"/Users/dave/Documents/teaching/606J-mle/2020/slides/L3_binaryextensions/code/anes_pilot_2016.csv"</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Select variables</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>vars_to_keep <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"bo_muslim"</span>, <span class="st">"pid7"</span>, <span class="st">"disc_wo"</span>, <span class="st">"lazyb"</span>, <span class="st">"disc_b"</span>, <span class="st">"faminc"</span>, <span class="st">"birthyr"</span>, <span class="st">"race"</span>, <span class="st">"autism"</span>, <span class="st">"disc_selfsex"</span>, <span class="st">"gender"</span>, <span class="st">"vaccine"</span>)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>anes <span class="ot">&lt;-</span> anes[, vars_to_keep]</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Recode variables</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>anes <span class="ot">&lt;-</span> anes <span class="sc">%&gt;%</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">pid7 =</span> <span class="fu">as.numeric</span>(pid7),</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">bo_muslim =</span> <span class="fu">case_when</span>(</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>      bo_muslim <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>      bo_muslim <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>      bo_muslim <span class="sc">==</span> <span class="dv">8</span> <span class="sc">~</span> <span class="cn">NA_real_</span>,</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> bo_muslim</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">pid7 =</span> <span class="fu">ifelse</span>(pid7 <span class="sc">&gt;</span> <span class="dv">7</span>, <span class="cn">NA</span>, pid7),</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">disc_wo =</span> <span class="fu">ifelse</span>(disc_wo <span class="sc">&gt;</span> <span class="dv">7</span>, <span class="cn">NA</span>, disc_wo),</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">lazyb =</span> <span class="fu">ifelse</span>(lazyb <span class="sc">&gt;</span> <span class="dv">7</span>, <span class="cn">NA</span>, lazyb),</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">disc_b =</span> <span class="fu">ifelse</span>(disc_b <span class="sc">&gt;</span> <span class="dv">5</span>, <span class="cn">NA</span>, disc_b),</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">faminc =</span> <span class="fu">ifelse</span>(faminc <span class="sc">&gt;</span> <span class="dv">16</span>, <span class="cn">NA</span>, faminc),</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">age =</span> <span class="dv">2016</span> <span class="sc">-</span> birthyr,</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">white =</span> <span class="fu">ifelse</span>(race <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Reverse coding</span></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">disc_wo =</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">*</span> disc_wo <span class="sc">+</span> <span class="dv">6</span>,</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">disc_selfsex =</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">*</span> disc_selfsex <span class="sc">+</span> <span class="dv">6</span>,</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">autism =</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">*</span> autism <span class="sc">+</span> <span class="dv">7</span>,</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">disc_b =</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">*</span> disc_b <span class="sc">+</span> <span class="dv">6</span></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure disc_wo is binary for probit model</span></span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>anes <span class="ot">&lt;-</span> anes <span class="sc">%&gt;%</span></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">disc_wo_binary =</span> <span class="fu">ifelse</span>(disc_wo <span class="sc">&gt;</span> <span class="fu">median</span>(disc_wo, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a><span class="co"># model </span></span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>hetprob_model <span class="ot">&lt;-</span> <span class="fu">hetprob</span>(bo_muslim <span class="sc">~</span> white<span class="sc">+</span>disc_b<span class="sc">+</span>pid7<span class="sc">+</span>age<span class="sc">+</span> faminc<span class="sc">+</span>autism <span class="sc">|</span> age, <span class="at">data =</span> anes, <span class="at">link=</span><span class="st">"probit"</span>)</span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare with standard probit model</span></span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>probit_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(bo_muslim <span class="sc">~</span> white <span class="sc">+</span> disc_b <span class="sc">+</span> pid7 <span class="sc">+</span> age <span class="sc">+</span> faminc <span class="sc">+</span> autism, <span class="at">data =</span> anes, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"probit"</span>))</span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Load required libraries</span></span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Rchoice)</span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to extract and format Rchoice model results</span></span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a>extract_rchoice_results <span class="ot">&lt;-</span> <span class="cf">function</span>(model) {</span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a>  coef <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>(<span class="fu">coef</span>(model), <span class="at">error =</span> <span class="cf">function</span>(e) <span class="cn">NULL</span>)</span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a>  vcov_matrix <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>(<span class="fu">vcov</span>(model), <span class="at">error =</span> <span class="cf">function</span>(e) <span class="cn">NULL</span>)</span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(coef) <span class="sc">||</span> <span class="fu">is.null</span>(vcov_matrix)) {</span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"Unable to extract coefficients or variance-covariance matrix from the model."</span>)</span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true" tabindex="-1"></a>  se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(vcov_matrix))</span>
<span id="cb11-59"><a href="#cb11-59" aria-hidden="true" tabindex="-1"></a>  p_value <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="fu">abs</span>(coef <span class="sc">/</span> se)))</span>
<span id="cb11-60"><a href="#cb11-60" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-61"><a href="#cb11-61" aria-hidden="true" tabindex="-1"></a>  results_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb11-62"><a href="#cb11-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">Estimate =</span> coef,</span>
<span id="cb11-63"><a href="#cb11-63" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Std. Error</span><span class="st">`</span> <span class="ot">=</span> se,</span>
<span id="cb11-64"><a href="#cb11-64" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Pr(&gt;|z|)</span><span class="st">`</span> <span class="ot">=</span> p_value</span>
<span id="cb11-65"><a href="#cb11-65" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb11-66"><a href="#cb11-66" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-67"><a href="#cb11-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(results_df)</span>
<span id="cb11-68"><a href="#cb11-68" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-69"><a href="#cb11-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-70"><a href="#cb11-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to create a formatted HTML table for two models</span></span>
<span id="cb11-71"><a href="#cb11-71" aria-hidden="true" tabindex="-1"></a>create_two_model_table <span class="ot">&lt;-</span> <span class="cf">function</span>(model1, model2, <span class="at">model1_name =</span> <span class="st">"Model 1"</span>, <span class="at">model2_name =</span> <span class="st">"Model 2"</span>) {</span>
<span id="cb11-72"><a href="#cb11-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tryCatch</span>({</span>
<span id="cb11-73"><a href="#cb11-73" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract results for both models</span></span>
<span id="cb11-74"><a href="#cb11-74" aria-hidden="true" tabindex="-1"></a>    results1 <span class="ot">&lt;-</span> <span class="fu">extract_rchoice_results</span>(model1)</span>
<span id="cb11-75"><a href="#cb11-75" aria-hidden="true" tabindex="-1"></a>    results2 <span class="ot">&lt;-</span> <span class="fu">extract_rchoice_results</span>(model2)</span>
<span id="cb11-76"><a href="#cb11-76" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-77"><a href="#cb11-77" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Combine results</span></span>
<span id="cb11-78"><a href="#cb11-78" aria-hidden="true" tabindex="-1"></a>    combined_results <span class="ot">&lt;-</span> <span class="fu">full_join</span>(</span>
<span id="cb11-79"><a href="#cb11-79" aria-hidden="true" tabindex="-1"></a>      results1 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Variable =</span> <span class="fu">rownames</span>(results1)),</span>
<span id="cb11-80"><a href="#cb11-80" aria-hidden="true" tabindex="-1"></a>      results2 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Variable =</span> <span class="fu">rownames</span>(results2)),</span>
<span id="cb11-81"><a href="#cb11-81" aria-hidden="true" tabindex="-1"></a>      <span class="at">by =</span> <span class="st">"Variable"</span>,</span>
<span id="cb11-82"><a href="#cb11-82" aria-hidden="true" tabindex="-1"></a>      <span class="at">suffix =</span> <span class="fu">c</span>(<span class="st">".1"</span>, <span class="st">".2"</span>)</span>
<span id="cb11-83"><a href="#cb11-83" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb11-84"><a href="#cb11-84" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(Variable, <span class="fu">everything</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb11-85"><a href="#cb11-85" aria-hidden="true" tabindex="-1"></a>      <span class="fu">arrange</span>(Variable)</span>
<span id="cb11-86"><a href="#cb11-86" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-87"><a href="#cb11-87" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Rename columns</span></span>
<span id="cb11-88"><a href="#cb11-88" aria-hidden="true" tabindex="-1"></a>    <span class="fu">names</span>(combined_results) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Variable"</span>,</span>
<span id="cb11-89"><a href="#cb11-89" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"Estimate.1"</span>, <span class="st">"Std. Error.1"</span>, <span class="st">"Pr(&gt;|z|).1"</span>,</span>
<span id="cb11-90"><a href="#cb11-90" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"Estimate.2"</span>, <span class="st">"Std. Error.2"</span>, <span class="st">"Pr(&gt;|z|).2"</span>)</span>
<span id="cb11-91"><a href="#cb11-91" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-92"><a href="#cb11-92" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create HTML table</span></span>
<span id="cb11-93"><a href="#cb11-93" aria-hidden="true" tabindex="-1"></a>    html_table <span class="ot">&lt;-</span> <span class="fu">kable</span>(combined_results, </span>
<span id="cb11-94"><a href="#cb11-94" aria-hidden="true" tabindex="-1"></a>                        <span class="at">format =</span> <span class="st">"html"</span>,</span>
<span id="cb11-95"><a href="#cb11-95" aria-hidden="true" tabindex="-1"></a>                        <span class="at">digits =</span> <span class="dv">3</span>,</span>
<span id="cb11-96"><a href="#cb11-96" aria-hidden="true" tabindex="-1"></a>                        <span class="at">caption =</span> <span class="st">"Comparison of  Probit Models"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-97"><a href="#cb11-97" aria-hidden="true" tabindex="-1"></a>      <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>, <span class="st">"responsive"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb11-98"><a href="#cb11-98" aria-hidden="true" tabindex="-1"></a>      <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">" "</span> <span class="ot">=</span> <span class="dv">1</span>, </span>
<span id="cb11-99"><a href="#cb11-99" aria-hidden="true" tabindex="-1"></a>                         <span class="at">model1_name =</span> <span class="dv">3</span>, </span>
<span id="cb11-100"><a href="#cb11-100" aria-hidden="true" tabindex="-1"></a>                         <span class="at">model2_name =</span> <span class="dv">3</span>)) </span>
<span id="cb11-101"><a href="#cb11-101" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-102"><a href="#cb11-102" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Save the HTML table to a file</span></span>
<span id="cb11-103"><a href="#cb11-103" aria-hidden="true" tabindex="-1"></a>    <span class="co">#writeLines(as.character(html_table), "two_model_results.html")</span></span>
<span id="cb11-104"><a href="#cb11-104" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-105"><a href="#cb11-105" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Print the HTML code</span></span>
<span id="cb11-106"><a href="#cb11-106" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(html_table)</span>
<span id="cb11-107"><a href="#cb11-107" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb11-108"><a href="#cb11-108" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"An error occurred:"</span>, <span class="fu">conditionMessage</span>(e), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb11-109"><a href="#cb11-109" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb11-110"><a href="#cb11-110" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-111"><a href="#cb11-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-112"><a href="#cb11-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-113"><a href="#cb11-113" aria-hidden="true" tabindex="-1"></a><span class="co"># Usage example (replace with your actual models):</span></span>
<span id="cb11-114"><a href="#cb11-114" aria-hidden="true" tabindex="-1"></a><span class="fu">create_two_model_table</span>(probit_model, hetprob_model, <span class="at">model1_name =</span><span class="st">"Base Model"</span>, <span class="at">model2_name=</span><span class="st">"Extended Model"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<table class="table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<caption>
Comparison of Probit Models
</caption>
<thead>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="1">
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
model1_name
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
model2_name
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Variable
</th>
<th style="text-align:right;">
Estimate.1
</th>
<th style="text-align:right;">
Std. Error.1
</th>
<th style="text-align:right;">
Pr(&gt;|z|).1
</th>
<th style="text-align:right;">
Estimate.2
</th>
<th style="text-align:right;">
Std. Error.2
</th>
<th style="text-align:right;">
Pr(&gt;|z|).2
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:right;">
-1.808
</td>
<td style="text-align:right;">
0.278
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
-1.253
</td>
<td style="text-align:right;">
0.284
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
age
</td>
<td style="text-align:right;">
0.013
</td>
<td style="text-align:right;">
0.003
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.010
</td>
<td style="text-align:right;">
0.002
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
autism
</td>
<td style="text-align:right;">
0.199
</td>
<td style="text-align:right;">
0.030
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.128
</td>
<td style="text-align:right;">
0.033
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
disc_b
</td>
<td style="text-align:right;">
-0.145
</td>
<td style="text-align:right;">
0.043
</td>
<td style="text-align:right;">
0.001
</td>
<td style="text-align:right;">
-0.101
</td>
<td style="text-align:right;">
0.033
</td>
<td style="text-align:right;">
0.002
</td>
</tr>
<tr>
<td style="text-align:left;">
faminc
</td>
<td style="text-align:right;">
-0.055
</td>
<td style="text-align:right;">
0.015
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
-0.035
</td>
<td style="text-align:right;">
0.012
</td>
<td style="text-align:right;">
0.004
</td>
</tr>
<tr>
<td style="text-align:left;">
het.age
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
-0.009
</td>
<td style="text-align:right;">
0.004
</td>
<td style="text-align:right;">
0.028
</td>
</tr>
<tr>
<td style="text-align:left;">
pid7
</td>
<td style="text-align:right;">
0.231
</td>
<td style="text-align:right;">
0.024
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.148
</td>
<td style="text-align:right;">
0.035
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
white
</td>
<td style="text-align:right;">
0.128
</td>
<td style="text-align:right;">
0.116
</td>
<td style="text-align:right;">
0.271
</td>
<td style="text-align:right;">
0.074
</td>
<td style="text-align:right;">
0.078
</td>
<td style="text-align:right;">
0.341
</td>
</tr>
</tbody>
</table>
</div>
<p>Here are predictions from the two models. The main takeaway is that if you change things, things change - so there’s not much substantively to take away from the differences between the predictions. Strong theory expectations would potentially drive expectations about these differences.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>pred_data <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">disc_b =</span> <span class="fu">median</span>(anes<span class="sc">$</span>disc_selfsex, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">age =</span> <span class="fu">seq</span>(<span class="fu">min</span>(anes<span class="sc">$</span>age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="fu">max</span>(anes<span class="sc">$</span>age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">length.out =</span> <span class="dv">100</span>),</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">faminc =</span> <span class="fu">median</span>(anes<span class="sc">$</span>faminc, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">pid7 =</span> <span class="fu">median</span>(anes<span class="sc">$</span>pid7, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">autism =</span> <span class="fu">median</span>(anes<span class="sc">$</span>autism, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">white =</span> <span class="dv">1</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict probabilities</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>pred_probs_het <span class="ot">&lt;-</span> <span class="fu">predict</span>(hetprob_model, <span class="at">newdata =</span> pred_data, <span class="at">type =</span> <span class="st">"pr"</span>)</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>pred_probs_std <span class="ot">&lt;-</span> <span class="fu">predict</span>(probit_model, <span class="at">newdata =</span> pred_data, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine predictions</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> <span class="fu">cbind</span>(pred_data, </span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Het_Prob =</span> pred_probs_het,</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Std_Prob =</span> pred_probs_std)</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plot_data, <span class="fu">aes</span>(<span class="at">x =</span> age)) <span class="sc">+</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Het_Prob, <span class="at">color =</span> <span class="st">"Heteroskedastic Probit"</span>)) <span class="sc">+</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Std_Prob, <span class="at">color =</span> <span class="st">"Standard Probit"</span>)) <span class="sc">+</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Age"</span>, <span class="at">y =</span> <span class="st">"Pr(Secret Muslim)"</span>, <span class="at">color =</span> <span class="st">"Model"</span>) <span class="sc">+</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Comparison of Heteroskedastic and Standard Probit Models"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="binaryextensions224_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>


</section>
</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>